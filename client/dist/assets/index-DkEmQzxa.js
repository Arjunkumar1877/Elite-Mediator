const __vite__fileDeps=["assets/AdminAllCallListSection--k4NoG62.js","assets/vendor-ZQ85wmCP.js","assets/vendor-kbKtIrwV.css"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{j as e,R as Zs,F as Xs,C as et,a as st,b as tt,i as at,g as lt,c as fe,d as rt,o as nt,e as ot,r as a,l as ct,u as J,f as W,_ as P,L as Y,H as _e,I as it,h as ze,k as me,m as ae,n as dt,G as xt,s as mt,B as L,p as Ee,q as Be,t as We,P as cs,v as $e,w as Ve,x as is,y as ds,z as xs,A as ms,D as Ne,E as we,J as be,K as ve,M as us,N as ut,O as de,Q as hs,T as ht,S as pt,U as ft,V as gt,W as ps,X as jt,Y as fs,Z as Oe,$ as yt,a0 as gs,a1 as js,a2 as Re,a3 as pe,a4 as qe,a5 as Ye,a6 as Ge,a7 as He,a8 as Qe,a9 as ys,aa as Ns,ab as Je,ac as Ke,ad as Ze,ae as ws,af as as,ag as ls,ah as Xe,ai as Nt,aj as wt,ak as bs,al as bt,am as vt,an as vs,ao as kt,ap as ks,aq as Ss,ar as St,as as Ct,at as je,au as Cs,av as _t,aw as Et,ax as Fe,ay as _s,az as Es,aA as Is,aB as It,aC as As,aD as Ps,aE as Ts,aF as ce,aG as Le,aH as At,aI as Us,aJ as Os,aK as Rs,aL as $s,aM as Vs,aN as Pt,aO as Tt,aP as ie,aQ as Ut,aR as Ot,aS as ye,aT as Rt,aU as $t,aV as Vt,aW as Lt,aX as Dt,aY as Mt,aZ as Ft,a_ as Ls,a$ as Ds,b0 as zt,b1 as Bt,b2 as Wt,b3 as q,b4 as qt,b5 as Yt,b6 as es,b7 as Gt,b8 as Ht,b9 as Qt,ba as Jt,bb as Kt}from"./vendor-ZQ85wmCP.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const x of document.querySelectorAll('link[rel="modulepreload"]'))n(x);new MutationObserver(x=>{for(const h of x)if(h.type==="childList")for(const c of h.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function o(x){const h={};return x.integrity&&(h.integrity=x.integrity),x.referrerPolicy&&(h.referrerPolicy=x.referrerPolicy),x.crossOrigin==="use-credentials"?h.credentials="include":x.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function n(x){if(x.ep)return;x.ep=!0;const h=o(x);fetch(x.href,h)}})();const Ms=()=>e.jsxs("div",{className:"grid grid-cols-1  pt-16 pb-20 md:grid-cols-3 mt-10 md:pb-40 bg-slate-800 md:h-72  text-white lg:gap-10",children:[e.jsxs("div",{className:"flex flex-col justify-center items-center px-11 gap-5",children:[e.jsx("h2",{className:"self-start md:text-sm lg:text-2xl",children:"Company"}),e.jsx("span",{className:"self-start md:text-xs ",children:"About Us"}),e.jsx("span",{className:"self-start md:text-xs ",children:"Blog"}),e.jsx("span",{className:"self-start md:text-xs ",children:"Contact Us"}),e.jsx("span",{className:"self-start md:text-xs ",children:"Testamonials"})]}),e.jsxs("div",{className:"flex flex-col justify-center items-center px-11 gap-5",children:[e.jsx("h2",{className:"self-start md:text-sm lg:text-2xl",children:"Support"}),e.jsx("span",{className:"self-start md:text-xs ",children:"Help Center"}),e.jsx("span",{className:"self-start md:text-xs ",children:"Terms and Services"}),e.jsx("span",{className:"self-start md:text-xs ",children:"Legal"}),e.jsx("span",{className:"self-start md:text-xs ",children:"Privacy Policy"})]}),e.jsxs("div",{className:"flex flex-col justify-center items-center px-11 gap-5",children:[e.jsx("h2",{className:"self-start text-sm lg:text-2xl",children:"Stay up to date"}),e.jsxs("div",{className:"self-start flex gap-1",children:[e.jsx("input",{type:"email",placeholder:"Your email address",className:"rounded-md w-28 h-8 px-1 py-1 border border-gray-700 focus:outline-none focus:ring-1 focus:ring-inset focus:ring-blue-500 lg:w-40"}),e.jsx("button",{className:"bg-sky-500 w-16 text-xs text-white px-1 py-1 rounded-md hover:bg-blue-700",children:"Subscribe"})]}),e.jsxs("span",{className:"self-start flex gap-5 text-lg ",children:[e.jsx(Zs,{}),e.jsx(Xs,{}),e.jsx(et,{}),e.jsx(st,{}),e.jsx(tt,{})]}),e.jsx("span",{className:"self-start text-slate-400 text-sm lg:text-lg ",children:"copyright @ 2024"}),e.jsx("span",{className:"self-start text-slate-400 text-sm lg:text-lg",children:"Powered by Elite Mediator pvt ltd"})]})]}),Zt={apiKey:"AIzaSyDiKMgXAyxHTNe37A9mq7CbflZCV_G080E",authDomain:"elite-mediator.firebaseapp.com",projectId:"elite-mediator",storageBucket:"elite-mediator.appspot.com",messagingSenderId:"144513732823",appId:"1:144513732823:web:33a6a583a38005f582e092",measurementId:"G-K8GD4K1D70"},ge=at(Zt),oe=lt(ge);fe(ge);const Fs=rt(ge),De=async()=>{console.log("Requesting User Permission");try{if(await Notification.requestPermission()==="granted"){console.log("Notification user Permission granted");const t=await ot(Fs,{vapidKey:"BMdWK8g4O2jKMUfZYX9Fy4l1-UER7qO0j57o6usOpcmHyux1QiJ61PiIbek-T93ES5nDid_3uPebdBPPq45gMco"});if(t)return console.log("Client Token:   ",t),t;console.log("Failed to generate the app registration token.")}else console.log("User Permission Denied.")}catch(s){console.log("An error occurred when requesting to receive token. ",s)}},zs=()=>new Promise(s=>{nt(Fs,t=>{console.log(t),s(t)})});zs();const Bs=a.createContext(void 0),Xt=({children:s})=>{const t=ct("https://elitemediator.shop"),[o,n]=a.useState(),[x,h]=a.useState(),[c,f]=a.useState(!1),[u,j]=a.useState(""),{currentAdmin:y}=J(N=>N.admin);return a.useEffect(()=>{y&&t.emit("notify",y._id)},[]),e.jsx(Bs.Provider,{value:{socket:t,callConnected:c,setCallConnected:f,setIsVideoCall:n,isVideoCall:o,notificationCount:x,setNotificationCount:h,token:u,setToken:j},children:s})},xe=()=>{const s=a.useContext(Bs);if(s===void 0)throw new Error("useSocket must be used within a SocketProvider");return s},ea=()=>{var h,c,f,u,j,y,N,C,b,E,p,i;const{setToken:s}=xe(),[t,o]=a.useState([]),n=async()=>{const v=await De();s(v)};a.useEffect(()=>{n(),x()},[]);const x=async()=>{try{const v=await W.get("/superAdmin/get_posters");o(v.data)}catch(v){console.log(v),P("Failed to fetch posters.")}};return console.log(t),e.jsxs("div",{className:"relative bg-white  overflow-hidden p-8 md:p-10 lg:p-0",children:[e.jsx("div",{className:"absolute rounded-2xl top-0 left-1/4 transform -translate-x-1/2 -translate-y-1/2 bg-blue-100 w-40 h-40 lg:w-72 lg:h-72 rotate-45"}),e.jsx("div",{className:"absolute rounded-2xl -top-14  sm:ml-30 md:ml-28 lg:left-64 transform translate-x-1/2 -translate-y-1/2 bg-neutral-500 w-40 h-40 lg:w-72 lg:h-72 rotate-45"}),e.jsxs("div",{className:"relative flex flex-col lg:flex-row items-center justify-between space-y-8 lg:space-y-0 mt-40",children:[e.jsxs("div",{className:"lg:w-1/2 flex flex-col space-y-4 lg:p-16",children:[e.jsx("h1",{className:"text-3xl lg:text-5xl font-bold text-zinc-600",children:"DON'T MISS ANYONE.."}),e.jsx("h2",{className:"text-xl lg:text-2xl font-semibold text-sky-500",children:"WHO TRY TO REACH YOU"}),e.jsx("p",{className:"text-gray-600 text-sm lg:text-base",children:"At Elite Mediator, we offer a revolutionary platform designed to facilitate secure and seamless communication with strangers while safeguarding your personal information."}),e.jsx(Y,{to:"/signup",children:e.jsx("button",{className:"bg-sky-500 hover:bg-sky-600 text-white px-4 py-2 rounded self-start",children:"REGISTER"})})]}),e.jsx("div",{className:"lg:w-1/2 flex justify-center lg:justify-end",children:e.jsx("img",{src:t.length>0&&((h=t[0])!=null&&h.imageUrl)?(c=t[0])==null?void 0:c.imageUrl:"https://firebasestorage.googleapis.com/v0/b/elite-mediator.appspot.com/o/1721058856452_Capture.PNG?alt=media&token=8e4ddf1c-00a3-4077-b2be-36bea2bbdb04",alt:"Illustration",className:"max-w-full h-auto"})})]}),e.jsxs("div",{className:"flex flex-col items-center justify-center p-6 bg-white md:p-12 ",children:[e.jsxs("div",{className:"relative w-full",children:[e.jsx("div",{className:"bg-sky-500 h-14 w-16 absolute -left-24 -top-3 rounded-xl md:h-18 md:-left-28 md:h-20  md:-top-5 lg:-left-20"}),e.jsx("h2",{className:"text-2xl font-bold text-zinc-600 text-center md:text-4xl",children:"BE ALWAYS AVAILABLE FOR EVERYONE"})]}),e.jsx("p",{className:"mt-2 text-center text-gray-600",children:"Manage your property from anywhere in this world"}),e.jsxs("div",{className:"",children:[e.jsxs("div",{className:"flex flex-col justify-between mt-6 space-y-6 md:flex-row md:space-y-0 md:space-x-12 md:text-sm  lg:text-lg",children:[e.jsxs("div",{className:"flex flex-col items-center p-10 space-y-4 text-center bg-gray-100  rounded-lg md:w-1/3",children:[e.jsx("div",{className:"flex items-center justify-center w-12 h-12 bg-sky-500 rounded-2xl relative",children:e.jsx(_e,{className:"text-4xl absolute -left-2 bottom-0"})}),e.jsx("h3",{className:"text-xl font-semibold",children:"Domestic"}),e.jsx("p",{className:"text-gray-600",children:"Domestic users can create their own unique property QR codes to facilitate communication with strangers while they are away from home. This feature allows users to interact with others through video calls, audio calls, or text messages without having to share personal information. Itâ€™s a secure way to stay connected and manage communications from a distance, ensuring your privacy is always maintained."})]}),e.jsxs("div",{className:"flex flex-col items-center p-10 space-y-4 text-center bg-gray-100 rounded-lg md:w-1/3",children:[e.jsx("div",{className:"flex items-center justify-center w-12 h-12 bg-sky-500 rounded-2xl relative",children:e.jsx(it,{className:"text-4xl absolute -left-2 bottom-0"})}),e.jsx("h3",{className:"text-xl font-semibold",children:"Business"}),e.jsx("p",{className:"text-gray-600",children:"You can generate unique property QR codes for your business, whether for selling, renting, or offering services. These QR codes let users contact you directly through video calls, audio calls, or text messages without sharing personal phone numbers, helping you manage and grow your business while maintaining privac"})]})]}),e.jsx("div",{className:"flex justify-center p-2 md:p-0 lg:p-0",children:e.jsx(Y,{to:"/service",children:e.jsx("button",{className:"mt-auto px-4 h-11 font-semibold text-white bg-sky-500 rounded  hover:bg-sky-600 ",children:"SERVICES"})})})]})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row lg:justify-between",children:[e.jsx("div",{className:"",children:e.jsx("img",{src:t.length>0&&((f=t[0])!=null&&f.imageUrl)?(u=t[1])==null?void 0:u.imageUrl:"https://firebasestorage.googleapis.com/v0/b/elite-mediator.appspot.com/o/1721057073374_landingpage2.png?alt=media&token=ad06005d-e2de-4981-8c44-dc3016d7caa9",alt:"",className:"h-auto w-90 md:h-72 md:60"})}),e.jsxs("div",{className:"flex flex-col justify-center gap-5",children:[e.jsxs("div",{className:"relative w-full mt-7",children:[e.jsx("div",{className:"bg-sky-500 h-14 w-16 absolute -right-24 -top-3 rounded-xl md:h-18 md:-right-16 md:h-20  md:top-0 lg:-right-7"}),e.jsx("h2",{className:"text-xl font-bold text-zinc-600 md:text-4xl text-start",children:"CONNECT WITH ANYONE SEAMLESSLY"}),e.jsx("h2",{className:"text-xl font-semibold text-sky-500 md:text-4xl text-start",children:"KEEPING YOUR DATA'S PRIVATE"})]}),e.jsx("div",{className:"h-40 w-[900px] pr-40",children:e.jsx("p",{className:"",children:"Elite Mediator offers flexible communication settings to suit your preferences. You can decide whether or not to enable video calls for users scanning your QR code. If you choose to disable video calls, users will only be able to communicate via text or audio. This level of control ensures that your communication preferences are respected while still providing various ways to interact with others."})}),e.jsx("div",{className:"text-start",children:e.jsx("button",{className:"bg-sky-500 text-white px-4 py-2 rounded-md self-start",children:"Leran more.."})})]})]}),e.jsxs("div",{className:"flex flex-col rounded-xl items-center justify-center gap-8  lg:justify-between mt-9 lg:flex-row bg-zinc-300 h-[400px]",children:[e.jsxs("div",{className:"relative w-1/2",children:[e.jsx("div",{className:"bg-sky-500 h-14 w-16 absolute -left-44 top-9 rounded-xl sm:-left-80 md:h-18 md:-left-60 md:h-20  md:-top-2 lg:-left-8"}),e.jsxs("div",{className:"flex flex-col lg:w-[700px] justify-center mt-12 text-center md:text-start md:mt-0",children:[e.jsx("h2",{className:"text-xl mt-70 font-bold text-zinc-600 text-center lg:text-4xl ",children:"YOUR VIRITUAL DOORMAN"}),e.jsx("h2",{className:"text-center w-full text-sm font-bold text-sky-500 ml-5  lg:text-2xl lg:ml-8 self-start ",children:"CONNECT WTH VISITORS FROM ANYWHERE"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-16 w-1/2 p-6 ",children:[e.jsx(_e,{className:"text-3xl lg:text-5xl text-slate-500"}),e.jsx(_e,{className:"text-3xl lg:text-5xl text-slate-500"}),e.jsx(_e,{className:"text-3xl lg:text-5xl text-slate-500"}),e.jsx(_e,{className:"text-3xl lg:text-5xl text-slate-500"})]})]}),e.jsxs("div",{className:"mt-8 mb-32 flex flex-col lg:flex-row lg:justify-between",children:[e.jsx("div",{className:"",children:e.jsx("img",{src:t.length>0&&((j=t[0])!=null&&j.imageUrl)?(y=t[2])==null?void 0:y.imageUrl:"https://firebasestorage.googleapis.com/v0/b/elite-mediator.appspot.com/o/1721057084411_landingpage3.png?alt=media&token=91cb7b6e-3c32-4f9f-b07b-7094f1fb4869",alt:"",className:"h-auto w-90 md:h-72 md:60"})}),e.jsxs("div",{className:"flex flex-col justify-center gap-5",children:[e.jsxs("div",{className:"relative w-full mt-7",children:[e.jsx("div",{className:"bg-sky-500 h-14 w-16 absolute -right-24 -top-3 rounded-xl md:h-18 md:-right-16 md:h-20  md:top-0 lg:-right-7"}),e.jsx("h2",{className:"text-xl font-bold text-zinc-600 md:text-4xl text-start",children:"WE MAKE YOUR DATA SAFE AND SECURE"}),e.jsx("h2",{className:"text-xl font-semibold text-sky-500 md:text-4xl text-start",children:"YOUR PRIVACY IS OUT TOP CONCER"})]}),e.jsx("div",{className:"h-40 w-[900px] pr-40",children:e.jsx("p",{className:"",children:"Security is our top priority at Elite Mediator. We ensure that all your private data is protected with state-of-the-art security measures. Our platform provides a safe environment for all communications, so you can confidently interact with strangers without worrying about your personal information being compromised."})})]})]}),e.jsxs("div",{className:"flex flex-col mt-11 items-center justify-center p-6 bg-white md:p-12 ",children:[e.jsxs("div",{className:"relative w-full mb-9",children:[e.jsx("div",{className:"bg-sky-500 h-14 w-16 absolute -left-24 -top-3 rounded-xl md:h-18 md:-left-20 md:h-20  md:-top-5"}),e.jsx("h2",{className:"text-2xl font-bold text-zinc-600 text-center md:text-4xl",children:"STAY IN THE LOOP: VISITOR COMMUNICATION MADE EASY"})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-3",children:[e.jsx("div",{className:" bg-blue-100 rounded-xl md:w-90 md:h-72 overflow-hidden",children:e.jsx("img",{src:t.length>0&&((N=t[0])!=null&&N.imageUrl)?(C=t[3])==null?void 0:C.imageUrl:"https://firebasestorage.googleapis.com/v0/b/elite-mediator.appspot.com/o/1721057095865_landingPageImg1.avif?alt=media&token=ded48002-ad32-4146-ac94-7390cbb472d2",alt:"",className:"object-cover w-full h-full"})}),e.jsx("div",{className:" bg-blue-100 rounded-xl  md:w-90 md:h-72 ",children:e.jsx("h2",{className:"py-24 px-7 text-2xl font-bold text-slate-600 uppercase",children:"Welcome All the Guests, No matter where you are"})}),e.jsx("div",{className:" bg-blue-100 rounded-xl md:w-90 md:h-72 overflow-hidden",children:e.jsx("img",{src:t.length>0&&((b=t[0])!=null&&b.imageUrl)?(E=t[4])==null?void 0:E.imageUrl:"https://firebasestorage.googleapis.com/v0/b/elite-mediator.appspot.com/o/1721057116338_landingPageImg2.avif?alt=media&token=315fa014-7816-4406-85a3-d1c46e1ad53a",alt:"",className:"object-cover w-full h-full"})}),e.jsx("div",{className:" bg-blue-100 rounded-xl  md:w-90 md:h-72 ",children:e.jsx("h2",{className:"py-24 px-7 text-2xl font-bold text-slate-600 uppercase",children:"Peace of Mind: Chat with Visitors Even When You're Out"})}),e.jsx("div",{className:" bg-blue-100 rounded-xl md:w-90 md:h-72 overflow-hidden",children:e.jsx("img",{src:t.length>0&&((p=t[0])!=null&&p.imageUrl)?(i=t[5])==null?void 0:i.imageUrl:"https://firebasestorage.googleapis.com/v0/b/elite-mediator.appspot.com/o/1721057130775_landingPageImg3.avif?alt=media&token=e6b97baa-1d3b-4b6d-b961-d93f66388d25",alt:"",className:"object-cover w-full h-full"})}),e.jsx("div",{className:" bg-blue-100 rounded-xl  md:w-90 md:h-72 ",children:e.jsx("h2",{className:"py-24 px-7 text-2xl font-bold text-slate-600 uppercase",children:"Have a live interaction with the visitors keeping your privacy ahead"})})]})]}),e.jsxs("div",{className:"flex flex-col justify-center items-center mt-10 mb-10",children:[e.jsx("h1",{className:"mt-2 text-sm md:mt-8  md:text-5xl font-bold text-slate-600",children:"SMART VISITORS MANAGMENT CONNECT FROM"}),e.jsx("h1",{className:"mt-2 text-sm md:mt-8  md:text-5xl font-semibold text-sky-500",children:"ANYWHERE"}),e.jsx("button",{className:"mt-8 bg-sky-500  text-white px-4 py-2  rounded self-center",children:e.jsx(Y,{to:"/signup",children:"REGISTER"})})]}),e.jsx(Ms,{})]})},sa={currentAdmin:null,error:null,loading:!1,conversation:[]},Ws=ze({name:"admin",initialState:sa,reducers:{signInStart:s=>{s.loading=!0,s.error=null},signInSuccess:(s,t)=>{s.currentAdmin=t.payload,s.loading=!1,s.error=null},signInFailure:(s,t)=>{s.loading=!1,s.error=t.payload},setConversation:(s,t)=>{s.conversation=Array.isArray(t.payload)?t.payload:[]},signoutSuccess:s=>{s.currentAdmin=null,s.error=null,s.loading=!1}}}),{signInSuccess:Ie,signInStart:ta,signInFailure:cl,setConversation:il,signoutSuccess:rs}=Ws.actions,aa=Ws.reducer,qs=()=>{const s=me(),t=ae(),o=async()=>{try{const n=new xt;n.setCustomParameters({prompt:"select_account"});const x=await mt(oe,n);console.log(x);const h=await fetch("/api/google_oauth",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:x.user.displayName,email:x.user.email,image:x.user.photoURL,phone:91e10,password:"12345678"})}),c=await h.json();h.ok&&(c!=null&&c.address?(console.log(c),s(Ie(c)),t("/profile"),P("Succesfully logged In")):(console.log(c),s(Ie(c)),t("/admin-data"),P("Succesfully logged In")))}catch(n){console.log(n)}};return e.jsx("div",{className:"flex justify-center",children:e.jsxs("button",{onClick:o,className:"relative flex items-center justify-center bg-white w-full max-w-sm rounded-full py-2 px-4 text-gray-600 hover:bg-gray-100 hover:shadow-md transition duration-300 ease-in-out border border-gray-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500",children:[e.jsx(dt,{className:"w-6 h-6 mr-3"}),e.jsx("span",{className:"font-medium",children:"Sign in with Google"})]})})},la=()=>{const[s,t]=a.useState(""),[o,n]=a.useState(""),[x,h]=a.useState(!0),[c,f]=a.useState(!0),[u,j]=a.useState(""),[y,N]=a.useState(!1),{currentAdmin:C}=J(w=>w.admin),b=me(),E=ae(),[p,i]=a.useState([]),v=async()=>{try{const w=await W.get("/superAdmin/get_posters");i(w.data)}catch(w){console.log(w),P("Failed to fetch posters.")}};a.useEffect(()=>{v(),C&&C.address?E("/profile"):C&&!C.address&&E("/admin-data")},[]);const r=w=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(w),A=w=>w.length>=6,d=async()=>{const w=r(s),l=A(o);if(h(w),f(l),!(!w||!l)){b(ta());try{const _=await fetch("/api/admin_login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:s,password:o})});if(_.ok){const m=await _.json();console.log(m),console.log("Login successful:",m),m==="Invalid credentials"&&P(m),m!=="Invalid credentials"&&(m&&!(m!=null&&m.address)?(E("/admin-data"),b(Ie(m))):m&&(m!=null&&m.address)&&(b(Ie(m)),E("/profile")))}else{const m=await _.json();j(m.message||"Login failed. Please try again.")}}catch(_){j("An error occurred. Please try again."),console.log("Error logging in:",_)}}};return e.jsxs("div",{className:"flex justify-center h-screen w-full",children:[e.jsx("div",{className:"hidden sm:flex sm:flex-1 sm:h-full",children:e.jsx("img",{src:p.length>0?p[9].imageUrl:"https://firebasestorage.googleapis.com/v0/b/elite-mediator.appspot.com/o/login.jpg?alt=media&token=23fd7400-7426-40c8-87c3-dc4c1eabc8c9",alt:"Dummy",className:"h-full object-cover w-full"})}),e.jsx("div",{className:"w-full lg:flex-1 h-full bg-sky-100 p-5",children:e.jsxs("div",{className:"bg-white h-full flex flex-col justify-center items-center",children:[e.jsx("h1",{className:"text-2xl lg:text-3xl",children:"Login"}),e.jsxs("div",{className:"flex flex-col pt-5",children:[e.jsxs("div",{className:"flex justify-between px-5 py-1",children:[e.jsx("span",{className:"text-xs text-zinc-500",children:"Email"}),e.jsxs("div",{className:"flex justify-between gap-1",children:[s&&(x?e.jsx(L,{className:"text-green-600 text-xs"}):e.jsx(Ee,{className:"text-red-600 text-xs"})),e.jsx("span",{className:`text-xs text-center ${x?"text-green-500":"text-red-500"}`,children:s.length>0&&(x?"Valid":"Invalid")})]})]}),e.jsx("input",{type:"text",className:`w-[300px] border rounded py-1 px-5 ${x?"":"border-red-500"}`,placeholder:"Enter your email",value:s,onChange:w=>t(w.target.value)})]}),e.jsxs("div",{className:"flex flex-col pt-5",children:[e.jsxs("div",{className:"flex justify-between px-5 py-1",children:[e.jsx("span",{className:"text-xs text-zinc-500",children:"Password"}),e.jsxs("div",{className:"flex justify-between gap-1",children:[o&&(c?e.jsx(L,{className:"text-green-600 text-xs"}):e.jsx(Ee,{className:"text-red-600 text-xs"})),e.jsx("span",{className:`text-xs text-center ${c?"text-green-500":"text-red-500"}`,children:o.length>0&&(c?"Valid":"Invalid")})]})]}),e.jsxs("div",{className:" relative ",children:[e.jsx("input",{type:`${y?"text":"password"}`,className:`w-[300px] border rounded py-1 px-5${c?"":"border-red-500"}`,placeholder:"Enter your password",value:o,onChange:w=>n(w.target.value)}),y?e.jsx(Be,{className:"absolute top-2 right-3",onClick:()=>N(!1)}):e.jsx(We,{className:"absolute top-2 right-3",onClick:()=>N(!0)})]})]}),u&&e.jsx("div",{className:"text-red-500 text-sm mt-2",children:u}),e.jsx("div",{className:"w-[300px] mt-6",children:e.jsx("button",{onClick:d,className:"bg-sky-500 w-full rounded py-1 px-5 text-white hover:bg-sky-600",children:"Login"})}),e.jsx("div",{className:"mt-5 mb-5 text-sm"}),e.jsx("div",{className:"mt-5 mb-5 text-blue-700 text-sm",children:e.jsx(Y,{to:"/signup",children:"Click here to sign up"})}),e.jsxs("div",{className:"flex items-center mt-5",children:[e.jsx("span",{className:"border-t border-gray-300 flex-grow mr-3"}),e.jsx("span",{className:"text-gray-400",children:"or continue with"}),e.jsx("span",{className:"border-t border-gray-300 flex-grow ml-3"})]}),e.jsx("div",{className:"w-[300px] mt-6",children:e.jsx(qs,{})})]})})]})},ra=()=>{const[s,t]=a.useState([]);a.useEffect(()=>{o()},[]);const o=async()=>{try{const n=await W.get("/superAdmin/get_posters");t(n.data)}catch(n){console.log(n),P("Failed to fetch posters.")}};return e.jsxs("div",{className:"relative bg-white  overflow-hidden p-8 md:p-10 lg:p-0",children:[e.jsx("div",{className:"absolute rounded-2xl top-0 left-1/4 transform -translate-x-1/2 -translate-y-1/2 bg-blue-100 w-40 h-40 lg:w-72 lg:h-72 rotate-45"}),e.jsx("div",{className:"absolute rounded-2xl -top-14  sm:ml-30 md:ml-28 lg:left-64 transform translate-x-1/2 -translate-y-1/2 bg-neutral-500 w-40 h-40 lg:w-72 lg:h-72 rotate-45"}),e.jsxs("div",{className:"relative mb-10 flex flex-col lg:flex-row items-center justify-between space-y-8 lg:space-y-0 mt-40",children:[e.jsx("div",{className:"lg:w-1/2 flex justify-center lg:justify-end",children:e.jsx("img",{src:s.length>0?s[6].imageUrl:"https://firebasestorage.googleapis.com/v0/b/elite-mediator.appspot.com/o/1721057219908_Domestic.jpg?alt=media&token=8ba48abf-8c4e-432b-a892-f42d86190fa2",alt:"Illustration",className:"max-w-full mt-10 h-auto"})}),e.jsxs("div",{className:"lg:w-1/2 flex flex-col space-y-4 lg:p-16",children:[e.jsx(Y,{to:"/signup",children:e.jsx("button",{className:"bg-sky-500 text-white px-4 py-2 rounded self-end",children:"Register now"})}),e.jsx("h1",{className:"text-3xl lg:text-5xl font-bold text-zinc-600",children:"DOMESTIC"}),e.jsx("p",{className:" text-zinc-700 text-sm  lg:text-lg z-20",children:"For domestic users, Elite Mediator offers a convenient way to stay connected without sharing private information. By creating unique QR codes, users can communicate with strangers safely, whether they're away from home or managing personal interactions. The app allows for real-time communication via video calls, audio calls, or text messages, providing a secure and private channel for interaction."}),e.jsx("p",{className:"text-slate-300 text-sm lg:text-lg z-20",children:"The flexibility to choose between verified, unverified, or unknown user statuses ensures that you can control the level of access and verification required for each interaction. With push notifications, PWA compatibility, and comprehensive visitor management features, Elite Mediator seamlessly integrates into your daily life, offering a reliable and secure means of communication while safeguarding your personal data."}),e.jsx("div",{className:"absolute rounded-2xl -right-20 -bottom-32  sm:ml-30 md:ml-28  transform translate-x-1/2 -translate-y-1/2 bg-sky-500 w-40 h-40 md:-right-20 md:-bottom-20 lg:w-72 lg:h-60 rotate-45 lg:-bottom-40 lg:-right-6"})]})]}),e.jsxs("div",{className:"flex flex-col gap-8 justify-between lg:flex-row lg:p-10",children:[e.jsx("div",{className:"w-1/2",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"bg-sky-500 h-14 w-16 absolute -left-16 -top-3 rounded-xl md:h-18 md:-left-16 md:h-20  md:-top-4"}),e.jsxs("div",{className:"pl-5",children:[e.jsx("h1",{className:"text-3xl lg:text-5xl font-bold text-zinc-600 uppercase",children:"Business"}),e.jsx("p",{className:"w-[800px] text-sm mt-5  text-zinc-700 lg:text-lg",children:"Elite Mediator is a cutting-edge communication platform designed to connect users with strangers securely and efficiently. Whether you're in business or managing personal interactions, our app provides an innovative solution to maintain privacy while facilitating communication. Businesses can generate unique property QR codes for various purposes, such as selling, renting, or offering services. These QR codes enable potential clients to reach out through video calls, audio calls, or text messages without disclosing personal phone numbers. The app supports the inclusion of property names, addresses, and customizable verification options, ensuring that your business interactions remain professional and secure. With options to control video call permissions and filter chat interactions based on user verification status, Elite Mediator enhances your ability to manage and grow your business while preserving your privacy."})]})]})}),e.jsx("div",{className:"w-1/2 flex justify-center items-center ml-14",children:e.jsx("img",{src:s.length>0?s[7].imageUrl:"https://firebasestorage.googleapis.com/v0/b/elite-mediator.appspot.com/o/1721057233070_Bussiness.jpg?alt=media&token=e378a80b-11bc-473d-888e-9c91419e74c2",alt:"",className:""})})]}),e.jsxs("div",{className:"mt-16  mb-32 flex flex-col gap-5 lg:flex-row lg:justify-between",children:[e.jsx("div",{className:"",children:e.jsx("img",{src:s.length>0?s[8].imageUrl:"https://firebasestorage.googleapis.com/v0/b/elite-mediator.appspot.com/o/1721057243593_visitors.webp?alt=media&token=7bd7a863-f40f-4c4e-9272-8172284648fc",alt:""})}),e.jsxs("div",{className:"flex flex-col justify-center gap-5",children:[e.jsxs("div",{className:"relative w-full mt-7",children:[e.jsx("div",{className:"bg-sky-500 h-14 w-16 absolute -right-16 -top-3 rounded-xl md:h-18 lg:-right-7 md:h-20  md:-top-7 "}),e.jsx("h2",{className:"text-xl font-bold text-zinc-600 md:text-4xl text-start uppercase",children:"Ensure your visitor leave happy"})]}),e.jsx("div",{className:"h-40 w-[600px] lg:w-[900px] pr-40 mr-10",children:e.jsx("p",{className:"pr-10 text-sm text-zinc-700 lg:text-lg",children:"Our platform features robust visitor management tools that allow property owners to filter and manage interactions effectively. You can sort visitors by date, property, or time to streamline communication and follow up with leads efficiently. Additionally, the app provides direct contact options, including mobile numbers and WhatsApp integration, so you can easily reach out to verified or unverified visitors based on the information they provided."})})]})]}),e.jsx(Ms,{})]})},na=()=>{const[s,t]=a.useState(""),[o,n]=a.useState(""),[x,h]=a.useState(""),[c,f]=a.useState(""),[u,j]=a.useState({}),[y,N]=a.useState(null),[C,b]=a.useState(!1),[E,p]=a.useState([]),{currentAdmin:i}=J(l=>l.admin),v=ae();a.useEffect(()=>{w(),i&&i.address?v("/profile"):i&&!i.address&&v("/admin-data")},[]);const r=()=>{let l={},_=!0;return s||(_=!1,l.username="Username is required"),o?/\S+@\S+\.\S+/.test(o)||(_=!1,l.email="Email is invalid"):(_=!1,l.email="Email is required"),x||(_=!1,l.phone="Phone number is required"),c||(_=!1,l.password="Password is required"),j(l),_},A=async l=>{try{const _=await fetch("/api/signup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:s,email:o,password:c,phone:x,firebaseConfirm:l.verificationId})});if(_.ok){const m=await _.json();if(m==="Credantials already exisit")return P(m);P("Verification message sucessfully send to your mobile"),v(`/verify_otp_page/${x}`)}}catch(_){console.log(_)}},d=async()=>{if(r())try{const l=new $e(oe,"recaptcha",{}),_=await Ve(oe,x,l);_?(N(_),A(_)):console.log("Error confirming the captcha.")}catch(l){console.log(l)}else return},w=async()=>{try{const l=await W.get("/superAdmin/get_posters");p(l.data)}catch(l){console.log(l),P("Failed to fetch posters.")}};return a.useEffect(()=>{w()},[]),console.log(y),e.jsxs("div",{className:"flex justify-center h-screen w-full",children:[e.jsx("div",{className:"hidden sm:flex sm:flex-1 sm:h-full",children:e.jsx("img",{src:E.length>0?E[9].imageUrl:"https://firebasestorage.googleapis.com/v0/b/elite-mediator.appspot.com/o/login.jpg?alt=media&token=23fd7400-7426-40c8-87c3-dc4c1eabc8c9",alt:"Dummy",className:"h-full object-cover w-full"})}),e.jsx("div",{className:"w-full lg:flex-1 h-full bg-sky-100 p-5",children:e.jsxs("div",{className:"bg-white h-full flex flex-col justify-center items-center",children:[e.jsx("h1",{className:"text-2xl lg:text-3xl",children:"Create an account"}),e.jsx("p",{className:"text-xs",children:"Enter your email to sign up for this app"}),e.jsxs("div",{className:"flex flex-col pt-5",children:[e.jsxs("div",{className:"flex justify-between px-5 py-1",children:[e.jsx("span",{className:"text-xs text-zinc-500",children:"Username"}),e.jsx("div",{className:"flex justify-between gap-1",children:s&&e.jsxs(e.Fragment,{children:[e.jsx(L,{className:"text-green-600 text-xs"}),e.jsx("span",{className:"text-xs text-green-500 text-center",children:"Valid"})]})})]}),e.jsx("input",{type:"text",className:"w-[300px] border rounded py-1 px-5",placeholder:"Enter your username",value:s,onChange:l=>t(l.target.value)}),u.username&&e.jsx("span",{className:"text-red-500 text-xs",children:u.username})]}),e.jsxs("div",{className:"flex flex-col pt-5",children:[e.jsxs("div",{className:"flex justify-between px-5 py-1",children:[e.jsx("span",{className:"text-xs text-zinc-500",children:"Email"}),e.jsx("div",{className:"flex justify-between gap-1",children:o&&e.jsxs(e.Fragment,{children:[e.jsx(L,{className:"text-green-600 text-xs"}),e.jsx("span",{className:"text-xs text-green-500 text-center",children:"Valid"})]})})]}),e.jsx("input",{type:"text",className:"w-[300px] border rounded py-1 px-5",placeholder:"Enter your email",value:o,onChange:l=>n(l.target.value)}),u.email&&e.jsx("span",{className:"text-red-500 text-xs",children:u.email})]}),e.jsxs("div",{className:"flex flex-col pt-5",children:[e.jsxs("div",{className:"flex justify-between px-5 py-1",children:[e.jsx("span",{className:"text-xs text-zinc-500",children:"Phone"}),e.jsx("div",{className:"flex justify-between gap-1",children:x&&e.jsxs(e.Fragment,{children:[e.jsx(L,{className:"text-green-600 text-xs"}),e.jsx("span",{className:"text-xs text-green-500 text-center",children:"Valid"})]})})]}),e.jsx(cs,{country:"in",value:x,onChange:l=>h("+"+l)}),u.phone&&e.jsx("span",{className:"text-red-500 text-xs",children:u.phone})]}),e.jsxs("div",{className:"flex flex-col pt-5",children:[e.jsxs("div",{className:"flex justify-between px-5 py-1",children:[e.jsx("span",{className:"text-xs text-zinc-500",children:"Password"}),e.jsx("div",{className:"flex justify-between gap-1 relative",children:c&&e.jsxs(e.Fragment,{children:[e.jsx(L,{className:"text-green-600 text-xs"}),e.jsx("span",{className:"text-xs text-green-500 text-center",children:"Valid"})]})})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:`${C?"text":"password"}`,className:"w-[300px] border rounded py-1 px-5",placeholder:"Enter your password",value:c,onChange:l=>f(l.target.value)}),C?e.jsx(Be,{className:"absolute top-2 right-3",onClick:()=>b(!1)}):e.jsx(We,{className:"absolute top-2 right-3",onClick:()=>b(!0)})]}),u.password&&e.jsx("span",{className:"text-red-500 text-xs",children:u.password})]}),e.jsx("div",{className:"w-[300px] mt-6",children:e.jsx("button",{className:"bg-sky-500 w-full rounded py-1 px-5 text-white hover:bg-sky-600",onClick:d,children:"Signup"})}),e.jsx("div",{className:"w-[300px] mt-6",id:"recaptcha"}),e.jsx("div",{className:"mt-5 mb-5 text-sm",children:e.jsx(Y,{to:"/login",children:"Already have an account"})}),e.jsxs("div",{className:"flex",children:[e.jsx("span",{className:"text-slate-200",children:"_____________"}),e.jsx("span",{className:"text-slate-300",children:"or continue with"}),e.jsx("span",{className:"text-slate-200",children:"_____________"})]}),e.jsx("div",{className:"w-[300px] mt-6",children:e.jsx(qs,{})})]})})]})},oa=()=>{const[s,t]=a.useState(new Array(6).fill("")),[o,n]=a.useState(30),[x,h]=a.useState({}),c=is(),f=ae();a.useEffect(()=>{if(o>0){const N=setTimeout(()=>n(o-1),1e3);return()=>clearTimeout(N)}},[o]),a.useEffect(()=>{(async()=>{try{const C=await fetch(`/api/unverified_admin/${c.ph}`);if(C.ok){const b=await C.json();h(b)}else console.log("Error fetching user data:",C.status)}catch(C){console.log("Error fetching user data:",C)}})()},[c.ph]);const u=(N,C)=>{if(isNaN(Number(N.value)))return;const b=[...s];b[C]=N.value,t(b),N.nextSibling&&N.value!==""&&N.nextSibling.focus()},j=async()=>{n(60);try{const N=new $e(oe,"recaptcha",{}),C=await Ve(oe,"+"+(x==null?void 0:x.phone),N);if(console.log(C),C){const b=await fetch("/api/update_firebase_verify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({firebaseConfirm:C.verificationId,phone:x.phone})});if(b.ok){const E=await b.json();h(E),P("otp resended sucessfully")}else console.log("Error updating firebase verification:",b.status)}else console.log("Error confirming the captcha.")}catch(N){console.log("Error resending OTP:",N)}},y=async()=>{const N=s.join(""),C=x.firebaseConfirm;if(!C){console.log("Verification ID is missing.");return}try{const b=ds.credential(C,N),E=await xs(oe,b);console.log("Verification result:",E),P("OTP verification successful!"),f("/login")}catch(b){b.code==="auth/code-expired"?P("The OTP has expired. Please request a new one."):b.code==="auth/invalid-verification-code"?P("The OTP entered is invalid. Please try again."):alert("Error verifying OTP. Please try again."),console.log("Error verifying OTP:",b)}};return e.jsx("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gray-100 p-4",children:e.jsxs("div",{className:"bg-white shadow-lg rounded-lg p-8 max-w-sm w-full",children:[e.jsx("div",{className:"flex justify-center mb-6",children:e.jsx("img",{src:"https://firebasestorage.googleapis.com/v0/b/elite-mediator.appspot.com/o/360_F_523692923_hxuZgDZr6uzJx6yVvNjOGfgVnQVXrKad.jpg?alt=media&token=f218a4b5-325b-45bb-9ff6-b66d056c74b6",alt:"OTP Icon",className:"w-50 h-60 object-cover"})}),e.jsx("h2",{className:"text-center text-lg font-semibold mb-4",children:"Enter the OTP sent to your mobile"}),e.jsx("div",{className:"flex justify-center mb-4 space-x-2",children:s.map((N,C)=>e.jsx("input",{type:"text",name:"otp",maxLength:1,className:"w-12 h-12 text-center text-lg border border-gray-300 rounded-md focus:ring-2 focus:ring-sky-500 focus:border-transparent",value:N,onChange:b=>u(b.target,C),onFocus:b=>b.target.select()},C))}),e.jsx("button",{onClick:y,className:"w-full py-2 bg-sky-500 text-white font-semibold rounded-md hover:bg-sky-600 transition duration-300",children:"Verify"}),e.jsx("div",{className:"mt-4 flex justify-center",children:e.jsx("button",{disabled:o!==0,onClick:j,className:"text-sky-500 underline",children:o===0?"Resend OTP":`Resend OTP in ${o} seconds`})}),e.jsx("div",{className:"",id:"recaptcha"})]})})},ca=()=>{const s=ae(),{currentAdmin:t}=J(p=>p.admin),[o,n]=a.useState(null),[x,h]=a.useState(null),[c,f]=a.useState({address:"",state:"",city:"",pincode:"",landmark:"",image:(t==null?void 0:t.image)||""});console.log(c),console.log(t._id);const[u,j]=a.useState({address:!1,state:!1,city:!1,pincode:!1,landmark:!1,image:!1}),y=(p,i)=>p==="pincode"?/^\d{6}$/.test(i):i.trim()!=="",N=p=>{p.target.files&&p.target.files[0]&&C(p.target.files[0])},C=async p=>{if(!p){h("Please select an image");return}try{h(null);const i=fe(ge),v=new Date().getTime()+"_"+p.name,r=Ne(i,v),A=we(r,p);A.on("state_changed",d=>{const w=d.bytesTransferred/d.totalBytes*100;n(w)},d=>{h("Image upload failed: "+d.message),n(null)},()=>{be(A.snapshot.ref).then(d=>{n(null),h(null),f(w=>({...w,image:d}))})})}catch{h("Image upload failed"),n(null)}},b=p=>i=>{const v=i.target.value;f(r=>({...r,[p]:v})),j(r=>({...r,[p]:!y(p,v)}))},E=async()=>{if(!Object.entries(c).every(([i,v])=>y(i,v))){j({address:!y("address",c.address),state:!y("state",c.state),city:!y("city",c.city),pincode:!y("pincode",c.pincode),landmark:!y("landmark",c.landmark),image:!y("image",c.image)});return}try{const i=await fetch(`/api/update_admin/${t._id}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)}),v=await i.json();i.ok&&v.updated?s("/profile"):console.log("Error updating the profile")}catch(i){console.error("Error updating admin:",i)}};return e.jsxs("div",{children:[e.jsx("div",{className:"absolute z-0 rounded-2xl -top-14 sm:ml-30 md:ml-28 lg:left-64 transform translate-x-1/2 -translate-y-1/2 bg-zinc-300 w-40 h-40 lg:w-72 lg:h-72 rotate-45"}),e.jsx("h1",{className:"relative font-semibold text-2xl z-10 flex justify-center items-center mt-8 text-center md:text-5xl",children:"WE KEEP YOUR DATA SAFE IN OUR HANDS"}),e.jsx("div",{className:"p-10 z-10",children:e.jsxs("div",{className:"flex flex-col justify-center items-center border-2 relative rounded-md z-10 px-8",children:[e.jsxs("div",{className:"mb-6 md:mb-0 relative mt-9 P-3",children:[e.jsx("label",{htmlFor:"profile-image",className:"cursor-pointer",children:e.jsxs("div",{className:"relative h-24 w-24 md:h-32 md:w-32 lg:h-48 lg:w-48",children:[o!==null&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx(ms,{value:o,text:`${Math.round(o)}%`,strokeWidth:5,styles:{root:{width:"100%",height:"100%"},path:{stroke:`rgba(62, 152, 199, ${o/100})`}}})}),e.jsx("img",{src:c.image,alt:"user",className:`h-full w-full rounded-full border-2 object-cover ${o!==null&&o<100&&"opacity-60"}`})]})}),e.jsx("input",{type:"file",accept:"image/*",id:"profile-image",className:"hidden",onChange:N}),e.jsx("h1",{className:"text-center p-3 text-zinc-500",children:"Upload Profile Image"})]}),x&&e.jsx("div",{className:"text-red-500 mt-2",children:x}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-10 mb-20",children:Object.keys(c).map(p=>{if(p!=="image"){const i=u[p];return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between px-2",children:[e.jsx("span",{className:"text-zinc-500 md:text-xl",children:p.charAt(0).toUpperCase()+p.slice(1)}),e.jsxs("div",{className:"flex justify-between gap-1",children:[c[p]&&(i?e.jsx(Ee,{className:"text-red-600 text-xs"}):e.jsx(L,{className:"text-green-600 text-xs"})),e.jsx("span",{className:`text-xs text-center ${i?"text-red-500":"text-green-500"}`,children:c[p].length>0&&(i?"Invalid":"Valid")})]})]}),e.jsx("input",{type:"text",className:`w-[300px] border-2 px-4 py-3 rounded-lg lg:w-[400px] ${i?"border-red-500":""}`,placeholder:`Enter your ${p.charAt(0).toUpperCase()+p.slice(1)}`,value:c[p],onChange:b(p)})]},p)}return null})}),e.jsx("button",{onClick:E,className:"px-10 py-3 bg-sky-500 text-white font-semibold rounded-md hover:bg-sky-600 transition duration-300 mb-10",children:"PROCEED"})]})})]})},ue=({navShowSet:s})=>{const[t,o]=a.useState(!0),{currentAdmin:n}=J(p=>p.admin),[x,h]=a.useState(!1),c=me(),f=ae(),{socket:u}=xe(),j=ve(),{notificationCount:y,setNotificationCount:N}=xe();console.log("side navbar rendering ðŸ’•ðŸ’•ðŸ’•ðŸ’•ðŸ’•ðŸ’•"),a.useEffect(()=>{s(t)},[s,t]);const C=async()=>{try{(await W.get(`/api/get_admin/${n._id}`)).data.blocked&&(c(rs()),P("You are blocked by the super Admin"))}catch(p){console.log(p)}},b=p=>{console.log(p),N(p),P(`You have ${p} unread messages`,{duration:900})};a.useEffect(()=>(C(),n&&n._id&&(u.emit("join room",n._id),u.on("join room",p=>{console.log(p),console.log("socket connected ðŸ“€ðŸ”¥ðŸ’•ðŸ’•ðŸ’•ðŸ’•")}),j.pathname!=="/chat_list"&&j.pathname!=="/admin_chat"&&u.on("notify",b)),u.on("incoming-call",p=>{j.pathname!==`/admin_chat?conId=${p.conId}`&&(console.log("emitted on side nave bar....ðŸ¤·â€â™‚ï¸ðŸ¤·â€â™‚ï¸ðŸ¤·â€â™‚ï¸ðŸ’•ðŸ’•ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥"),f(`/call_admin_page?conId=${p.conId}&incommingId=${p.incommingId}&callerId=${p.callerId}&videoCall=${p.videoCall}`))}),()=>{u.off("notify",b)}),[n]),a.useEffect(()=>{const p=()=>{o(window.innerWidth>=768)};return p(),window.addEventListener("resize",p),()=>{window.removeEventListener("resize",p)}},[]);const E=async()=>{const i=await(await fetch("/api/admin_logout")).json();console.log(i),i.message==="success"?c(rs()):P("sigout failed token not cleared")};return e.jsxs("div",{className:"fixed z-20 bg-sky-50 h-full",children:[e.jsxs("div",{className:`flex p-1 gap-1 transition-all duration-300 ${t?"bg-sky-50 w-[250px]":"w-[60px]"}`,children:[e.jsx("img",{className:" rounded bg-sky-500 font-sans w-14 text-center",src:"https://firebasestorage.googleapis.com/v0/b/elite-mediator.appspot.com/o/logo.png?alt=media&token=d632f87d-5330-4f8d-bf5c-67780c74798d",alt:""}),e.jsx("span",{className:`flex justify-center items-center text-2xl transition-all duration-300 whitespace-nowrap ${t?"opacity-100":"opacity-0"}`,children:"ELITE MEDIATOR"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"hidden md:flex justify-center items-center bg-sky-500 rounded-full w-7 h-7 absolute -right-2 cursor-pointer",onClick:()=>o(!t),children:t?e.jsx(us,{className:"text-3xl"}):e.jsx(ut,{className:"text-xs"})}),e.jsx("br",{}),e.jsx("br",{}),e.jsxs("div",{className:"flex flex-col gap-10 items-center justify-center",children:[e.jsxs(Y,{to:"/profile",className:`flex gap-5 ${j.pathname==="/profile"||j.pathname==="/editprofile"?"text-black":"text-sky-500"} self-start px-5 hover:text-black cursor-pointer items-center text-xl`,children:[e.jsx("span",{children:e.jsx(de,{})}),e.jsx("span",{className:`text-sm transition-opacity duration-300 ${t?"opacity-100":"opacity-0 hidden"}`,children:"PROFILE"})]}),e.jsxs(Y,{to:"/dashboard",className:`flex gap-5 self-start ${j.pathname==="/dashboard"?"text-black":"text-sky-500"} px-5 hover:text-black cursor-pointer items-center text-xl`,children:[e.jsx("span",{children:e.jsx(hs,{})}),e.jsx("span",{className:`text-sm transition-opacity duration-300 ${t?"opacity-100":"opacity-0 hidden"}`,children:"DASHBOARD"})]}),e.jsxs(Y,{to:"/visitors",className:`flex gap-5 self-start px-5 hover:text-black cursor-pointer  items-center text-xl ${j.pathname==="/visitors"?"text-black":"text-sky-500"}`,children:[e.jsx("span",{children:e.jsx(ht,{})}),e.jsx("span",{className:`text-sm transition-opacity duration-300 ${t?"opacity-100":"opacity-0 hidden"}`,children:"ALL USERS"})]}),e.jsxs(Y,{to:"/chat_list",onMouseEnter:()=>h(!0),onMouseLeave:()=>h(!1),className:`relative flex gap-5 self-start px-5 hover:text-black cursor-pointer ${j.pathname==="/chat_list"?"text-black":"text-sky-500"} items-center text-xl`,children:[e.jsxs("span",{className:"flex relative",children:[e.jsx(pt,{}),y>0&&e.jsx("span",{className:"absolute -top-2 -right-2 text-white bg-sky-500 rounded-full w-5 h-5 text-sm flex justify-center items-center",children:y})]}),e.jsx("span",{className:`text-sm transition-opacity duration-300 ${t?"opacity-100":"opacity-0 hidden"}`,children:"CHATS"}),y>0&&x&&e.jsxs("span",{className:"absolute w-40 left-12 bottom-12 bg-slate-800 text-white text-xs md:text-sm   rounded-lg py-3 px-5 z-10",children:["You have ",y," unread messages"]})]}),e.jsxs(Y,{to:"/qrCodes",className:`flex gap-5 self-start px-5 hover:text-black cursor-pointer ${j.pathname==="/qrCodes"||j.pathname==="/generate_qr"?"text-black":"text-sky-500"} items-center text-xl`,children:[e.jsx("span",{children:e.jsx(ft,{})}),e.jsx("span",{className:`text-sm transition-opacity duration-300 ${t?"opacity-100":"opacity-0 hidden"}`,children:"QR CODE'S"})]}),e.jsxs("div",{className:"flex gap-5 self-start px-5 hover:text-black cursor-pointer text-sky-500 items-center text-xl",onClick:E,children:[e.jsx("span",{children:e.jsx(gt,{})}),e.jsx("span",{className:`text-sm transition-opacity duration-300 ${t?"opacity-100":"opacity-0 hidden"}`,children:"LOGOUT"})]})]})]})]})},ia=()=>{const{currentAdmin:s}=J(h=>h.admin),[t,o]=a.useState(),n=me(),x=async()=>{const h=await De(),f=await(await fetch("/api/admin_add_or_get_fcmtoken",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:h,adminId:s._id})})).json();console.log(f),console.log("fcm updated succesfully â¤ï¸â¤ï¸â¤ï¸â¤ï¸â¤ï¸â¤ï¸â¤ï¸â¤ï¸â¤ï¸â¤ï¸â¤ï¸"),f&&n(Ie(f))};return a.useEffect(()=>{x(),(async()=>{const c=await fetch(`/api/get_admin/${s._id}`);if(c.ok){const f=await c.json();console.log(f),o(f)}else console.log("Error fetching admin data")})()},[]),console.log(t),e.jsxs("div",{className:"w-full h-screen flex flex-col relative z-10 overflow-x-hidden",children:[e.jsx("div",{className:"p-6 bg-white shadow-sm",children:e.jsx("h1",{className:"text-3xl font-bold",children:"Account Information"})}),e.jsxs("div",{className:"flex flex-col items-center p-6 overflow-y-auto bg-gray-100 relative z-20",children:[e.jsx("div",{className:"absolute z-0 rounded-2xl -top-14 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-zinc-300 w-40 h-40 lg:w-72 lg:h-72 rotate-45"}),e.jsx("div",{className:"absolute z-0 rounded-2xl left-1/2 lg:-right-10 lg:top-96 transform -translate-x-1/2 -translate-y-1/2 bg-sky-500 w-40 h-40 lg:w-72 lg:h-72 rotate-45"}),e.jsxs("div",{className:"flex flex-col justify-center relative z-20 items-center w-full bg-white rounded-md shadow-md p-6 md:p-8 lg:p-10",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center w-full mb-10 px-10",children:[e.jsx("div",{className:"mb-6 md:mb-0",children:e.jsx("img",{src:t==null?void 0:t.image,alt:"User Icon",className:"h-24 w-24 rounded-full  border-2 md:h-32 md:w-32 lg:h-48 lg:w-48  object-cover"})}),e.jsx(Y,{to:"/editprofile",children:e.jsx("div",{className:"flex flex-col md:flex-row text-zinc-400 items-center md:items-end justify-end w-full text-center md:text-right cursor-pointer hover:text-zinc-800",children:e.jsxs("button",{className:"bg-sky-500 text-white px-4 flex py-1 gap-1 rounded lg:py-2 lg:px-4 lg:gap-2",children:[e.jsx("span",{className:"",children:"Edit"}),e.jsx(ps,{className:"self-center"})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-3 xl:grid-cols-2 w-full",children:[e.jsxs("div",{className:"flex flex-col w-full px-2 py-3 md:px-3 md:py-4 lg:px-5 lg:py-5 rounded-md shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 px-2",children:[e.jsx("span",{className:"text-gray-500 text-lg md:text-xl",children:"Name"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{className:"text-green-600 text-sm"}),e.jsx("span",{className:"text-xs text-green-500",children:"Valid"})]})]}),e.jsxs("div",{className:"flex relative",children:[e.jsx(jt,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-lg md:text-xl"}),e.jsx("input",{type:"text",className:"border-2 w-full rounded-md placeholder:text-black placeholder-gray-400 py-2 px-4 md:py-3 md:px-5",placeholder:t&&(t==null?void 0:t.username),disabled:!0})]})]}),e.jsxs("div",{className:"flex flex-col w-full px-2 py-3 md:px-3 md:py-4 lg:px-5 lg:py-5 rounded-md shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 px-2",children:[e.jsx("span",{className:"text-gray-500 text-lg md:text-xl",children:"Email"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{className:"text-green-600 text-sm"}),e.jsx("span",{className:"text-xs text-green-500",children:"Valid"})]})]}),e.jsxs("div",{className:"flex relative",children:[e.jsx(fs,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-lg md:text-xl"}),e.jsx("input",{type:"text",className:"border-2 w-full rounded-md placeholder:text-black placeholder-gray-400 py-2 px-4 md:py-3 md:px-5",placeholder:t&&(t==null?void 0:t.email),disabled:!0})]})]}),e.jsxs("div",{className:"flex flex-col w-full px-2 py-3 md:px-3 md:py-4 lg:px-5 lg:py-5 rounded-md shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 px-2",children:[e.jsx("span",{className:"text-gray-500 text-lg md:text-xl",children:"Address"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{className:"text-green-600 text-sm"}),e.jsx("span",{className:"text-xs text-green-500",children:"Valid"})]})]}),e.jsxs("div",{className:"flex relative",children:[e.jsx(Oe,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-lg md:text-xl"}),e.jsx("input",{type:"text",className:"border-2 w-full rounded-md placeholder:text-black placeholder-gray-400 py-2 px-4 md:py-3 md:px-5",placeholder:t&&(t==null?void 0:t.address),disabled:!0})]})]}),e.jsxs("div",{className:"flex flex-col w-full px-2 py-3 md:px-3 md:py-4 lg:px-5 lg:py-5 rounded-md shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 px-2",children:[e.jsx("span",{className:"text-gray-500 text-lg md:text-xl",children:"Phone"}),e.jsx("div",{className:"flex items-center gap-2",children:t&&(t==null?void 0:t.phone)===91e10?e.jsxs(e.Fragment,{children:[e.jsx(yt,{className:"text-red-600 text-sm"}),e.jsx("span",{className:"text-xs text-red-500",children:"Invalid"})]}):e.jsxs(e.Fragment,{children:[e.jsx(L,{className:"text-green-600 text-sm"}),e.jsx("span",{className:"text-xs text-green-500",children:"Valid"})]})})]}),e.jsxs("div",{className:"flex relative",children:[e.jsx(gs,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-lg md:text-xl"}),e.jsx("input",{type:"text",className:"border-2 w-full rounded-md placeholder:text-black placeholder-gray-400 py-2 px-4 md:py-3 md:px-5",placeholder:t&&(t==null?void 0:t.phone),disabled:!0})]})]}),e.jsxs("div",{className:"flex flex-col w-full px-2 py-3 md:px-3 md:py-4 lg:px-5 lg:py-5 rounded-md shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 px-2",children:[e.jsx("span",{className:"text-gray-500 text-lg md:text-xl",children:"State"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{className:"text-green-600 text-sm"}),e.jsx("span",{className:"text-xs text-green-500",children:"Valid"})]})]}),e.jsxs("div",{className:"flex relative",children:[e.jsx(js,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-lg md:text-xl"}),e.jsx("input",{type:"text",className:"border-2 w-full rounded-md placeholder:text-black placeholder-gray-400 py-2 px-4 md:py-3 md:px-5",placeholder:t&&(t==null?void 0:t.state),disabled:!0})]})]}),e.jsxs("div",{className:"flex flex-col w-full px-2 py-3 md:px-3 md:py-4 lg:px-5 lg:py-5 rounded-md shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 px-2",children:[e.jsx("span",{className:"text-gray-500 text-lg md:text-xl",children:"City"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{className:"text-green-600 text-sm"}),e.jsx("span",{className:"text-xs text-green-500",children:"Valid"})]})]}),e.jsxs("div",{className:"flex relative",children:[e.jsx(Re,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-lg md:text-xl"}),e.jsx("input",{type:"text",className:"border-2 w-full rounded-md placeholder:text-black placeholder-gray-400 py-2 px-4 md:py-3 md:px-5",placeholder:t&&(t==null?void 0:t.city),disabled:!0})]})]}),e.jsxs("div",{className:"flex flex-col w-full px-2 py-3 md:px-3 md:py-4 lg:px-5 lg:py-5 rounded-md shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 px-2",children:[e.jsx("span",{className:"text-gray-500 text-lg md:text-xl",children:"Landmark"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{className:"text-green-600 text-sm"}),e.jsx("span",{className:"text-xs text-green-500",children:"Valid"})]})]}),e.jsxs("div",{className:"flex relative",children:[e.jsx(Re,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-lg md:text-xl"}),e.jsx("input",{type:"text",className:"border-2 w-full rounded-md placeholder:text-black placeholder-gray-400 py-2 px-4 md:py-3 md:px-5",placeholder:t&&(t==null?void 0:t.landmark),disabled:!0})]})]}),e.jsxs("div",{className:"flex flex-col w-full px-2 py-3 md:px-3 md:py-4 lg:px-5 lg:py-5 rounded-md shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 px-2",children:[e.jsx("span",{className:"text-gray-500 text-lg md:text-xl",children:"Pincode"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{className:"text-green-600 text-sm"}),e.jsx("span",{className:"text-xs text-green-500",children:"Valid"})]})]}),e.jsxs("div",{className:"flex relative",children:[e.jsx(Re,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-lg md:text-xl"}),e.jsx("input",{type:"text",className:"border-2 w-full rounded-md placeholder:text-black placeholder-gray-400 py-2 px-4 md:py-3 md:px-5",placeholder:t&&(t==null?void 0:t.pincode),disabled:!0})]})]})]})]})]})]})},da=()=>{const[s,t]=a.useState(!0);return e.jsxs("div",{className:"flex w-screen",children:[e.jsx(ue,{navShowSet:t}),e.jsx("div",{className:`transition-all duration-300 ${s?"w-[250px]":"w-[60px]"}`}),e.jsx("div",{className:"flex-1",children:e.jsx(ia,{})})]})},xa=()=>{const[s,t]=a.useState({username:"",email:"",address:"",phone:"",state:"",city:"",image:"",landmark:"",pincode:""}),[o,n]=a.useState(null),{currentAdmin:x}=J(d=>d.admin),h=ae(),c=d=>{d.target.files&&d.target.files[0]&&f(d.target.files[0])},f=async d=>{if(!d){P("No file available to upload.");return}try{const w=fe(ge),l=new Date().getTime()+"_"+d.name,_=Ne(w,l),m=we(_,d);m.on("state_changed",O=>{const H=O.bytesTransferred/O.totalBytes*100;n(H)},O=>{console.log(O),n(null)},()=>{be(m.snapshot.ref).then(O=>{n(null),t(H=>({...H,image:O}))})})}catch{n(null)}};a.useEffect(()=>{(async()=>{const w=await fetch(`/api/get_admin/${x._id}`);if(w.ok){const l=await w.json();t({username:l.username,email:l.email,address:l.address,phone:l.phone,state:l.state,city:l.city,image:l.image,landmark:l.landmark,pincode:l.pincode})}else console.log("Error fetching admin data")})()},[x._id]);const[u,j]=a.useState({username:!0,email:!0,address:!0,phone:!0,state:!0,city:!0,image:!0,landmark:!0,pincode:!0}),y=d=>/\S+@\S+\.\S+/.test(d),N=d=>d.trim()!=="",C=d=>d.trim()!=="",b=d=>/^[0-9]{10}$/.test(d),E=d=>d.trim()!=="",p=d=>d.trim()!=="",i=d=>d.trim()!=="",v=d=>d.length===6,r=(d,w)=>{const l=d.target.value;t({...s,[w]:l});let _=!1;switch(w){case"email":_=y(l);break;case"username":_=N(l);break;case"address":_=C(l);break;case"phone":_=b(l);break;case"state":_=p(l);break;case"city":_=E(l);break;case"landmark":_=i(l);break;case"pincode":_=v(l);break;default:_=l.trim()!==""}j({...u,[w]:_})};console.log(s);const A=async()=>{try{const d=await fetch(`/api/update_admin/${x._id}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}),w=await d.json();d.ok&&w.updated?(h("/profile"),P("Profile data's updated successfully..")):console.log("error updating the profile")}catch(d){console.error("Error updating admin:",d)}};return e.jsxs("div",{className:"w-full h-screen flex flex-col relative z-10",children:[e.jsx("div",{className:"p-6 bg-white shadow-sm",children:e.jsx("h1",{className:"text-xl",children:"Edit Profile"})}),e.jsxs("div",{className:"flex-1 flex flex-col items-center p-6 overflow-y-auto bg-gray-100 relative z-20",children:[e.jsx("div",{className:"absolute z-0 rounded-2xl -top-14 sm:ml-30 md:ml-28 lg:left-20 transform translate-x-1/2 -translate-y-1/2 bg-sky-500 w-40 h-40 lg:w-72 lg:h-72 rotate-45"}),e.jsxs("div",{className:"flex flex-col justify-center items-center w-full bg-white rounded-md shadow-md p-6 md:p-8 lg:p-10 relative z-20",children:[e.jsx("div",{className:"flex flex-col  md:flex-row justify-between items-center w-full mb-10 px-10",children:e.jsxs("div",{className:"mb-6 md:mb-0 relative",children:[e.jsx("label",{htmlFor:"profile-image",className:"cursor-pointer",children:e.jsxs("div",{className:"relative h-24 w-24 md:h-32 md:w-32 lg:h-48 lg:w-48",children:[e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:o&&e.jsx(ms,{value:o,text:`${o}%`,strokeWidth:5,styles:{root:{width:"100%",height:"100%"},path:{stroke:`rgba(62, 152, 199, ${o/100})`}}})}),e.jsx("img",{src:s.image&&s.image,alt:"admin",className:`h-full w-full rounded-full  border-2 object-cover ${o&&o<100&&"opacity-60"}`})]})}),e.jsx("input",{type:"file",accept:"image/*",id:"profile-image",className:"hidden",onChange:c})]})}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 xl:grid-cols-2 w-full",children:[e.jsxs("div",{className:"flex flex-col w-full px-2 py-3 md:px-3 md:py-4 lg:px-5 lg:py-5 rounded-md shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 px-2",children:[e.jsx("span",{className:"text-gray-500 text-lg md:text-xl",children:" Name "}),e.jsxs("div",{className:"flex items-center gap-2",children:[u.username?e.jsx(L,{className:"text-green-600 text-sm"}):e.jsx(pe,{className:"text-red-600 text-sm"}),e.jsxs("span",{className:`text-xs ${u.username?"text-green-500":"text-red-600"}`,children:[" ",u.username?"Valid":"Required"]})]})]}),e.jsxs("div",{className:"flex relative",children:[e.jsx(de,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-lg md:text-xl"}),e.jsx("input",{type:"text",className:"border-2 w-full rounded-md   placeholder-text-black placeholder-gray-400 py-2 px-4 md:py-3 md:px-5",placeholder:"Enter your username",value:s.username,onChange:d=>r(d,"username")})]})]}),e.jsxs("div",{className:"flex flex-col w-full px-2 py-3 md:px-3 md:py-4 lg:px-5 lg:py-5 rounded-md shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 px-2",children:[e.jsxs("span",{className:"text-gray-500 text-lg md:text-xl",children:[" ","Email"," "]}),e.jsxs("div",{className:"flex items-center gap-2",children:[u.email?e.jsx(L,{className:"text-green-600 text-sm"}):e.jsx(pe,{className:"text-red-600 text-sm"}),e.jsxs("span",{className:`text-xs ${u.email?"text-green-500":"text-red-600"}`,children:[" ",u.email?"Valid":"Required"]})]})]}),e.jsxs("div",{className:"flex relative",children:[e.jsx(fs,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-lg md:text-xl"}),e.jsx("input",{type:"email",className:"border-2 w-full rounded-md placeholder-text-black placeholder-gray-400 py-2 px-4 md:py-3 md:px-5",placeholder:"Enter your email",value:s.email,onChange:d=>r(d,"email")})]})]}),e.jsxs("div",{className:"flex flex-col w-full px-2 py-3 md:px-3 md:py-4 lg:px-5 lg:py-5 rounded-md shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 px-2",children:[e.jsxs("span",{className:"text-gray-500 text-lg md:text-xl",children:[" ","Address"," "]}),e.jsxs("div",{className:"flex items-center gap-2",children:[u.address?e.jsx(L,{className:"text-green-600 text-sm"}):e.jsx(pe,{className:"text-red-600 text-sm"}),e.jsxs("span",{className:`text-xs ${u.address?"text-green-500":"text-red-600"}`,children:[" ",u.address?"Valid":"Required"]})]})]}),e.jsxs("div",{className:"flex relative",children:[e.jsx(js,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-lg md:text-xl"}),e.jsx("input",{type:"text",className:"border-2 w-full rounded-md placeholder-text-black placeholder-gray-400 py-2 px-4 md:py-3 md:px-5",placeholder:"Enter your address",value:s.address,onChange:d=>r(d,"address")})]})]}),e.jsxs("div",{className:"flex flex-col w-full px-2 py-3 md:px-3 md:py-4 lg:px-5 lg:py-5 rounded-md shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 px-2",children:[e.jsxs("span",{className:"text-gray-500 text-lg md:text-xl",children:[" ","Phone"," "]}),e.jsxs("div",{className:"flex items-center gap-2",children:[u.phone?e.jsx(L,{className:"text-green-600 text-sm"}):e.jsx(pe,{className:"text-red-600 text-sm"}),e.jsxs("span",{className:`text-xs ${u.phone?"text-green-500":"text-red-600"}`,children:[" ",u.phone?"Valid":"Required"]})]})]}),e.jsxs("div",{className:"flex relative",children:[e.jsx(gs,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-lg md:text-xl"}),e.jsx("input",{type:"tel",className:"border-2 w-full rounded-md placeholder-text-black placeholder-gray-400 py-2 px-4 md:py-3 md:px-5",placeholder:"Enter your phone number",value:s.phone,onChange:d=>r(d,"phone")})]})]}),e.jsxs("div",{className:"flex flex-col w-full px-2 py-3 md:px-3 md:py-4 lg:px-5 lg:py-5 rounded-md shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 px-2",children:[e.jsxs("span",{className:"text-gray-500 text-lg md:text-xl",children:[" ","State"," "]}),e.jsxs("div",{className:"flex items-center gap-2",children:[u.state?e.jsx(L,{className:"text-green-600 text-sm"}):e.jsx(pe,{className:"text-red-600 text-sm"}),e.jsxs("span",{className:`text-xs ${u.state?"text-green-500":"text-red-600"}`,children:[" ",u.state?"Valid":"Required"]})]})]}),e.jsxs("div",{className:"flex relative",children:[e.jsx(Re,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-lg md:text-xl"}),e.jsx("input",{type:"text",className:"border-2 w-full rounded-md placeholder-text-black placeholder-gray-400 py-2 px-4 md:py-3 md:px-5",placeholder:"Enter your state",value:s.state,onChange:d=>r(d,"state")})]})]}),e.jsxs("div",{className:"flex flex-col w-full px-2 py-3 md:px-3 md:py-4 lg:px-5 lg:py-5 rounded-md shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 px-2",children:[e.jsx("span",{className:"text-gray-500 text-lg md:text-xl",children:" City "}),e.jsxs("div",{className:"flex items-center gap-2",children:[u.city?e.jsx(L,{className:"text-green-600 text-sm"}):e.jsx(pe,{className:"text-red-600 text-sm"}),e.jsxs("span",{className:`text-xs ${u.city?"text-green-500":"text-red-600"}`,children:[" ",u.city?"Valid":"Required"]})]})]}),e.jsxs("div",{className:"flex relative",children:[e.jsx(Oe,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-lg md:text-xl"}),e.jsx("input",{type:"text",className:"border-2 w-full rounded-md placeholder-text-black placeholder-gray-400 py-2 px-4 md:py-3 md:px-5",placeholder:"Enter your city",value:s.city,onChange:d=>r(d,"city")})]})]}),e.jsxs("div",{className:"flex flex-col w-full px-2 py-3 md:px-3 md:py-4 lg:px-5 lg:py-5 rounded-md shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 px-2",children:[e.jsxs("span",{className:"text-gray-500 text-lg md:text-xl",children:[" ","Pincode"," "]}),e.jsxs("div",{className:"flex items-center gap-2",children:[u.city?e.jsx(L,{className:"text-green-600 text-sm"}):e.jsx(pe,{className:"text-red-600 text-sm"}),e.jsxs("span",{className:`text-xs ${u.pincode?"text-green-500":"text-red-600"}`,children:[" ",u.pincode?"Valid":"Required"]})]})]}),e.jsxs("div",{className:"flex relative",children:[e.jsx(Oe,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-lg md:text-xl"}),e.jsx("input",{type:"text",className:"border-2 w-full rounded-md placeholder-text-black placeholder-gray-400 py-2 px-4 md:py-3 md:px-5",placeholder:"Enter your pincode",value:s.pincode,onChange:d=>r(d,"pincode")})]})]}),e.jsxs("div",{className:"flex flex-col w-full px-2 py-3 md:px-3 md:py-4 lg:px-5 lg:py-5 rounded-md shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 px-2",children:[e.jsxs("span",{className:"text-gray-500 text-lg md:text-xl",children:[" ","Landmark"," "]}),e.jsxs("div",{className:"flex items-center gap-2",children:[u.landmark?e.jsx(L,{className:"text-green-600 text-sm"}):e.jsx(pe,{className:"text-red-600 text-sm"}),e.jsxs("span",{className:`text-xs ${u.landmark?"text-green-500":"text-red-600"}`,children:[" ",u.landmark?"Valid":"Required"]})]})]}),e.jsxs("div",{className:"flex relative",children:[e.jsx(Oe,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-lg md:text-xl"}),e.jsx("input",{type:"text",className:"border-2 w-full rounded-md placeholder-text-black placeholder-gray-400 py-2 px-4 md:py-3 md:px-5",placeholder:"Enter your landmark",value:s.landmark,onChange:d=>r(d,"landmark")})]})]})]}),e.jsx("div",{className:"w-full flex justify-center mt-10",children:e.jsx("button",{onClick:A,className:"bg-sky-500 text-white py-2 px-9 rounded-md",children:"Save"})})]})]})]})},ma=()=>{const[s,t]=a.useState(!0);return e.jsxs("div",{className:"flex w-screen",children:[e.jsx(ue,{navShowSet:t}),e.jsx("div",{className:`transition-all duration-300 ${s?"w-[250px]":"w-[60px]"}`}),e.jsx("div",{className:"flex-1",children:e.jsx(xa,{})})]})},ua=()=>{const{currentAdmin:s}=J(t=>t.admin);return console.log("ðŸ’•ðŸ’•ðŸ’•ðŸ’•ðŸ’•ðŸ’•ðŸ’• private route admin "),s?e.jsx(qe,{}):e.jsx(Ye,{to:"/login"})};Ge.register(He,Qe,ys,Ns,Je,Ke,Ze);const ha=({data:s})=>{const t={labels:["All Users","Verified Users","Unverified Users","Unknown Users"],datasets:[{label:"User Statistics",data:[s.All,s.verified,s.unVerified,s.unknown],borderColor:"rgb(14 165 233)",backgroundColor:"rgba(75, 192, 192, 0.2)",fill:!1,tension:.1}]},o={responsive:!0,scales:{x:{beginAtZero:!0}},plugins:{legend:{display:!0,position:"top"},title:{display:!0,text:"User Statistics Chart"}}};return e.jsx("div",{children:e.jsx(ws,{data:t,options:o})})};function pa(){const[s,t]=a.useState({}),{currentAdmin:o}=J(r=>r.admin),[n,x]=a.useState(),[h,c]=a.useState(),{socket:f,setIsVideoCall:u}=xe(),[j,y]=a.useState(),[N,C]=a.useState(),b=async()=>{try{const A=await(await fetch(`/api/get_calls/${o._id}/1`)).json();console.log(A),A&&(x(A.calls),y(A.totalCalls))}catch(r){console.log(r)}},E=async()=>{try{const r=await W.get("/api/get_users_list",{params:{adminId:o._id}});r.data!=="Empty list"&&c(r.data)}catch(r){r instanceof Error?console.error(`Fetch error: ${r.message}`):console.error("An unknown error occurred")}},p=async()=>{try{const r=await W.get(`/api/admin_dash_graph/${o._id}`);C(r.data)}catch(r){console.log(r)}},i=async(r=!1,A,d,w)=>{try{u(r),f.emit("join room",A);const _=await(await fetch("/api/start_call",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({callData:{conversationId:A,callerId:o._id,adminId:o._id,userId:d,caller:"Admin",callType:r?"video":"audio",receiver:"User"},username:o.username,token:w})})).json();_._id&&(console.log("emitted for calling ðŸ’•ðŸ’•ðŸ’•ðŸ’•ðŸ’•ðŸ’•ðŸ’•ðŸ’•ðŸ’•ðŸ’•ðŸ’•ðŸ’•ðŸ’•ðŸ’•ðŸ’•ðŸ’•ðŸ’•ðŸ’•ðŸ’•ðŸ’•"),f.emit("incoming-call",{conId:A,incommingId:o._id,adminId:o._id,callerId:_._id,videoCall:!!r,admin:!0}))}catch(l){console.error("Error starting call:",l)}};console.log(n);function v(r){const A=Math.floor(r/1e3%60),d=Math.floor(r/(1e3*60)%60),w=Math.floor(r/(1e3*60*60)%24),l=A<10?`0${A}`:A.toString(),_=d<10?`0${d}`:d.toString(),m=w<10?`0${w}`:w.toString();return w===0?`${_}:${l}`:`${m}:${_}:${l}`}return a.useEffect(()=>{p(),E(),b(),(async()=>{const A=await fetch(`/api/get_admin/${o._id}`);if(A.ok){const d=await A.json();console.log(d),t(d)}else console.log("Error fetching admin data")})()},[]),e.jsxs("div",{className:"container mx-auto p-4",children:[e.jsx("div",{className:"mb-5",children:e.jsx("h1",{className:"text-3xl font-bold",children:"Dashboard"})}),e.jsxs("div",{className:"flex flex-col gap-5 xl:flex-row",children:[e.jsxs("div",{className:"p-4 w-full lg:w-1/3 border-2 rounded-lg",children:[e.jsx("div",{className:"flex justify-end p-2 cursor-pointer",children:e.jsx(Y,{to:"/editprofile",children:e.jsx(ps,{className:"text-xl text-sky-500 hover:text-sky-700"})})}),e.jsx("div",{className:"flex justify-center",children:e.jsx("img",{src:`${s!=null&&s.image?s==null?void 0:s.image:"public/userIcon.webp"}`,alt:"User Icon",className:"rounded-full w-36 h-36 object-cover"})}),e.jsxs("div",{className:"flex flex-col items-center mt-3",children:[e.jsx("h1",{className:"text-xl",children:s==null?void 0:s.username}),e.jsx("p",{className:"text-xs text-zinc-400",children:s==null?void 0:s.email})]}),e.jsx("hr",{className:"w-full mt-4"}),e.jsx("div",{className:"flex justify-start items-center py-3",children:e.jsxs("p",{children:["Address: ",e.jsx("span",{className:"text-xs text-zinc-400",children:s==null?void 0:s.address})]})}),e.jsx("div",{className:"flex justify-start items-center py-3",children:e.jsxs("p",{children:["City: ",e.jsx("span",{className:"text-xs text-zinc-400",children:s==null?void 0:s.city})]})}),e.jsx("div",{className:"flex justify-start items-center py-3",children:e.jsxs("p",{children:["Phone: ",e.jsx("span",{className:"text-xs text-zinc-400",children:s==null?void 0:s.phone})]})})]}),e.jsxs("div",{className:"flex-1 w-full p-4 border-2 rounded-lg lg:w-2/3",children:[e.jsx("div",{className:"mb-3",children:e.jsx("h2",{className:"text-xl font-bold",children:"Your Activity"})}),N&&e.jsx(ha,{data:N})]})]}),e.jsxs("div",{className:"flex flex-col gap-5 mt-5 lg:flex-row",children:[e.jsxs("div",{className:"p-4 w-full lg:w-1/3 border-2 rounded-lg shadow-lg bg-white",children:[e.jsxs("div",{className:"flex justify-between items-center px-5 py-2 border-b cursor-pointer",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Recent Calls"}),e.jsx(Y,{to:"/admin_call_List",children:e.jsxs("h3",{className:"text-sky-500 font-bold",children:["(",j&&j,") All"]})})]}),e.jsx("div",{className:"overflow-y-scroll max-h-96",children:n&&n.map(r=>{var A;return e.jsxs("div",{className:"flex items-center h-[70px] rounded-lg justify-between border-b mt-2 p-2 hover:bg-gray-100",children:[e.jsxs("div",{className:"flex flex-col w-2/3",children:[e.jsx("span",{className:"text-xs md:text-sm text-gray-500",children:new Date(r.createdAt).toLocaleString()}),e.jsx("span",{className:"text-sm md:text-lg font-semibold",children:(A=r==null?void 0:r.userId)==null?void 0:A.username}),e.jsxs("div",{className:"flex items-center gap-3 text-xs md:text-sm text-gray-500",children:[r.caller==="Admin"?e.jsx(as,{className:"text-blue-500"}):e.jsx(ls,{className:"text-green-500"}),e.jsx("span",{children:r.caller==="Admin"?"Outgoing":"Incoming"}),e.jsx("span",{children:(r==null?void 0:r.callDuration)&&e.jsxs(e.Fragment,{children:[" Call Duration: ",v(r==null?void 0:r.callDuration)," "]})})]})]}),e.jsxs("div",{className:"flex flex-col items-center gap-1 w-1/3",children:[e.jsx("div",{className:"flex items-center gap-2",children:r.callType==="video"?e.jsx(Xe,{onClick:()=>i(!0,r.conversationId,r.userId._id,r.userId.fcmToken),className:"cursor-pointer text-red-500"}):e.jsx(as,{onClick:()=>i(!1,r.conversationId,r.userId._id,r.userId.fcmToken),className:"cursor-pointer text-green-500"})}),e.jsxs("div",{className:"flex items-center gap-2",children:[r.callStatus==="answered"&&e.jsx(Nt,{className:"text-green-500"}),r.callStatus==="declined"&&e.jsx(wt,{className:"text-red-500"}),r.callStatus!=="answered"&&r.callStatus!=="declined"&&e.jsx(ls,{className:"text-yellow-500"}),e.jsx("span",{className:"text-xs md:text-sm",children:r.callStatus==="answered"?"Answered":r.callStatus==="declined"?"Declined":"Missed"})]})]})]},r._id)})})]}),e.jsxs("div",{className:"flex-1 p-4 border-2 rounded-lg bg-white shadow-lg",children:[e.jsxs("div",{className:"flex justify-between items-center px-5 py-2",children:[e.jsx("h2",{className:"text-lg font-bold lg:text-2xl",children:"Recent Visitors"}),e.jsx(Y,{to:"/visitors",children:e.jsxs("p",{className:"text-sky-500 text-sm font-bold hover:bg-sky-500 hover:rounded-full hover:p-2 hover:text-white",children:["(",(h==null?void 0:h.length)||0,") All"]})})]}),e.jsx("hr",{className:"w-full mt-4"}),e.jsx("div",{className:"overflow-y-scroll max-h-96 mt-4",children:h&&h.map(r=>e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 border p-3 rounded-lg gap-4 mb-4 bg-gray-50 shadow-sm",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold",children:"Date"}),e.jsx("p",{children:new Date(r==null?void 0:r.createdAt).toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold",children:"Time"}),e.jsx("p",{children:new Date(r==null?void 0:r.createdAt).toLocaleTimeString()})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold",children:"Name"}),e.jsx("p",{children:r==null?void 0:r.username}),e.jsx("h3",{className:"font-bold mt-2",children:"Purpose"}),e.jsx("p",{children:r==null?void 0:r.purpose}),e.jsx("h3",{className:"font-bold mt-2",children:"Phone"}),e.jsx("p",{children:(r==null?void 0:r.phone)===0?"unknown":r==null?void 0:r.phone})]}),e.jsxs("div",{className:"flex justify-end items-center text-xl p-1 cursor-pointer hover:text-slate-500",children:[e.jsx(bs,{className:"mr-2"}),e.jsx("span",{children:"Delete"})]})]},r._id))})]})]})]})}const fa=()=>{const[s,t]=a.useState(!0);return e.jsxs("div",{className:"flex w-screen",children:[e.jsx(ue,{navShowSet:t}),e.jsx("div",{className:`transition-all duration-300 ${s?"w-[250px]":"w-[60px]"}`}),e.jsx("div",{className:"flex-1",children:e.jsx(pa,{})})]})},ga=()=>{const{currentAdmin:s}=J(i=>i.admin),[t,o]=a.useState(!1),n=ae(),x=s._id+Date.now(),[h,c]=a.useState(),f=window.location.protocol,u=window.location.host,j=`${f}//${u}/new_user?adminId=${s._id}&propId=${x}`,[y,N]=a.useState({adminId:s._id,propId:"",propertyName:"",propertyAddress:"",allowVedioCalls:!1,userType:"Verified",url:"",code:""}),C=async()=>{try{N({...y,url:j,propId:x});const i=await fetch(`/api/generate_code/${s._id}/${x}`);if(i.ok){const v=await i.json();c(v.qrCodeUrl),N(r=>({...r,code:v.qrCodeUrl}))}}catch(i){console.log(i)}},b=i=>{const{name:v,value:r,type:A,checked:d}=i.target;N(w=>({...w,[v]:A==="checkbox"?d:r}))},E=async i=>{if(i.preventDefault(),y.allowVedioCalls===!1||y.code===""||(y==null?void 0:y.propertyAddress)===""||y.propertyName===""||y.url==="")return P("Give the necessary details and generate a code before saving");try{(await fetch("/api/save_property_data",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(y)})).ok&&(console.log("Data saved successfully"),p(),P.success("Property data saved successfully."),n("/qrCodes"))}catch(v){console.log(v)}};console.log(y);const p=()=>{const i=document.createElement("a");i.href=h||"",i.download="qr_code.png",i.click()};return e.jsxs("div",{className:"flex flex-col p-5 bg-gray-50 min-h-screen",children:[e.jsx("div",{className:"flex mt-10 ml-5",children:e.jsx("h1",{className:"text-lg font-bold lg:text-3xl",children:"Generate New Code"})}),e.jsx("div",{className:"flex flex-col border-2 rounded p-5 bg-white shadow-lg mt-5",children:e.jsxs("form",{onSubmit:E,children:[e.jsxs("div",{className:"flex flex-col px-7 pt-10",children:[e.jsx("label",{className:"font-medium",children:"Property Name"}),e.jsx("input",{type:"text",className:"w-full border-2 py-2 px-4 rounded-lg lg:py-3 lg:px-5 focus:outline-none focus:ring-2 focus:ring-sky-500",placeholder:"Enter your property name",name:"propertyName",value:y==null?void 0:y.propertyName,onChange:b,required:!0})]}),e.jsxs("div",{className:"flex flex-col px-7 pt-5",children:[e.jsx("label",{className:"font-medium",children:"Property Address"}),e.jsx("input",{type:"text",className:"w-full border-2 py-2 px-4 rounded-lg lg:py-3 lg:px-5 focus:outline-none focus:ring-2 focus:ring-sky-500",placeholder:"Enter your property address",name:"propertyAddress",value:y==null?void 0:y.propertyAddress,onChange:b,required:!0})]}),e.jsxs("div",{className:"flex justify-between px-7 pt-5 gap-8 flex-col lg:flex-row",children:[e.jsxs("div",{className:"flex flex-col w-full lg:w-1/2 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"font-semibold text-lg",children:"User Type"}),e.jsx(bt,{onClick:()=>o(!t),className:"text-slate-500 cursor-pointer hover:text-slate-800 transition-colors duration-300"})]}),t&&e.jsxs("div",{className:"flex flex-col bg-zinc-500 text-white  shadow-2xl p-4 rounded-lg border border-slate-200 space-y-2",children:[e.jsx("div",{className:"flex justify-end",children:e.jsx("span",{onClick:()=>o(!1),className:"flex justify-center items-center hover:bg-red-400 bg-red-500 opacity-100 text-white rounded-full w-5 h-5 cursor-pointer transition-colors duration-300",children:"Ã—"})}),e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"font-bold text-lg",children:"Verified:"})," The user scanning the code can only contact you after verifying themselves using an OTP."]}),e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"font-bold text-lg",children:"Unverified:"})," The user scanning the code can contact you after entering their phone, purpose, and name without verification."]}),e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"font-bold text-lg",children:"Unknown:"})," The user scanning the code can directly contact you."]})]}),e.jsxs("select",{name:"userType",value:y.userType,onChange:b,className:"border-2 rounded-lg py-3 px-4 focus:outline-none focus:ring-2 focus:ring-sky-500 transition duration-300",children:[e.jsx("option",{value:"Verified",children:"Verified"}),e.jsx("option",{value:"Unverified",children:"Unverified"}),e.jsx("option",{value:"Unknown",children:"Unknown"})]})]}),e.jsxs("div",{className:"flex flex-col w-full lg:w-1/2 space-y-4",children:[e.jsx("label",{className:"font-semibold text-lg",children:"Allow Video Calls"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"allowVedioCalls",value:"true",checked:y.allowVedioCalls===!0,onChange:()=>N({...y,allowVedioCalls:!0}),className:"mr-2 accent-sky-500"}),"Yes"]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"allowVedioCalls",value:"false",checked:y.allowVedioCalls===!1,onChange:()=>N({...y,allowVedioCalls:!1}),className:"mr-2 accent-sky-500"}),"No"]})]})]})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row justify-evenly items-center px-7 py-7 gap-4",children:[e.jsxs("div",{className:"relative p-3 border-2 rounded-lg",children:[h&&e.jsx("img",{src:h,alt:"QR Code",className:"w-36 h-36"}),e.jsx("label",{htmlFor:"fileInput",className:"absolute inset-0 bg-gray-200 opacity-0 hover:opacity-50 cursor-pointer flex items-center justify-center text-gray-700",children:"Upload QR"})]}),e.jsxs("div",{className:"flex flex-col gap-8 mt-10 lg:mt-0",children:[e.jsx("button",{type:"button",onClick:C,className:"bg-sky-500 text-white text-xs px-2 py-1 gap-1 rounded-lg hover:bg-sky-600 lg:text-lg lg:py-2 lg:px-4 lg:gap-2 flex items-center",children:"GENERATE QR CODE"}),e.jsxs("div",{className:"flex gap-4 lg:gap-8",children:[e.jsx(Y,{to:"/qrCodes",type:"button",className:"bg-sky-500 text-white text-xs px-2 py-1 gap-1 rounded-lg hover:bg-sky-600 lg:text-lg lg:py-2 lg:px-8 lg:gap-2 flex items-center",children:"CANCEL"}),e.jsxs("button",{type:"submit",className:"bg-sky-500 text-white text-xs px-2 py-1 gap-1 rounded-lg hover:bg-sky-600 lg:text-lg lg:py-2 lg:px-8 lg:gap-2 flex items-center",children:["SAVE & DOWNLOAD ",e.jsx(vt,{className:"ml-2"})]})]})]})]})]})})]})},ja=()=>{const[s,t]=a.useState(!0);return e.jsxs("div",{className:"flex w-screen",children:[e.jsx(ue,{navShowSet:t}),e.jsx("div",{className:`transition-all duration-300 ${s?"w-[250px]":"w-[60px]"}`}),e.jsx("div",{className:"flex-1",children:e.jsx(ga,{})})]})},ya=()=>{const[s,t]=a.useState([]),[o,n]=a.useState(1),[x,h]=a.useState(1),[c,f]=a.useState(""),{currentAdmin:u}=J(g=>g.admin),{setNotificationCount:j,socket:y}=xe(),[N,C]=a.useState([]),[b,E]=a.useState(""),[p,i]=a.useState(""),[v,r]=a.useState(""),A=async()=>{try{const g=await W.get("/api/get_conversations_list",{params:{adminId:u._id,page:o,propertyFilter:b,startDate:p,endDate:v}}),I=g.data.conversations;t(I),console.log(s),h(g.data.totalPages);let T=0;I.forEach(M=>{T+=M.lastMessage.unread}),j(T)}catch(g){console.error("Error fetching conversations:",g)}},d=async()=>{try{const I=await(await fetch(`/api/get_admin_property_data_filtering/${u._id}`)).json();console.log(I),C(I)}catch(g){console.log("Error fetching admin properties:",g)}};a.useEffect(()=>{A(),d()},[o,b]),a.useEffect(()=>(y.on("connect",()=>{console.log("Connected to socket server with ID:",y.id)}),y.on("chat message",async(g,I,T)=>{console.log(`Message received in room ${I}: ${g}`);try{await W.put(`/api/conversations/${g.conversationId}`,{lastMessage:{text:g.text,time:g.createdAt}}),y.emit("chat message",g,I,u._id),y.emit("update conversation",T)}catch(M){console.error("Error updating conversation:",M)}}),y.on("update conversation",()=>{A(),console.log("updated the conversation ðŸ’•ðŸ’•ðŸ’•ðŸ’•ðŸ’•ðŸ’•ðŸ’•ðŸ¤·â€â™‚ï¸ðŸ¤·â€â™‚ï¸ðŸ¤·â€â™‚ï¸ðŸ“€ðŸ“€ðŸ“€ðŸ“€ðŸ“€ðŸ“€ðŸ“€ðŸ“€")}),()=>{y.off("connect"),y.off("chat message"),y.off("update conversation")}),[o,b,p,v]);const w=()=>{n(g=>Math.max(g-1,1))},l=()=>{n(g=>Math.min(g+1,x))},_=g=>{f(g.target.value)},m=s.filter(g=>{var I;return(I=g==null?void 0:g.userId)==null?void 0:I.username.toLowerCase().includes(c.toLowerCase())}),O=g=>{f(""),r(""),i(""),E(g)},H=g=>{let I="",T="";switch(g){case"Unknown":I="bg-gray-600",T="Unknown";break;case"Unverified":I="bg-yellow-500",T="Unverified";break;default:I="bg-green-600",T="Verified";break}return e.jsx("span",{className:`absolute top-0 left-0  ${I} text-white   text-xs font-semibold p-0.5 rounded`,children:T})},D=g=>{const I=g.target.value;new Date(I)>new Date(v)?P.error("Start date cannot be later than end date."):i(I)},$=g=>{const I=g.target.value;new Date(p)>new Date(I)?P.error("End date cannot be earlier than start date."):r(I)},F=()=>{p&&v?(A(),d()):P.error("please select the dates..")};return e.jsxs("div",{className:"bg-gray-50 max-h-screen p-1",children:[e.jsx("div",{className:"absolute z-0 rounded-2xl -top-64 left-1/2 transform -translate-x-1/2 bg-zinc-300 w-60 h-40 lg:h-96 rotate-45"}),e.jsx("div",{className:"relative z-10 flex justify-between items-center p-3",children:e.jsx("h1",{className:"text-2xl font-bold",children:"Chats"})}),e.jsx("div",{className:"relative z-10 p-2 flex flex-col justify-between border-2 rounded bg-white shadow-lg h-full overflow-hidden",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row justify-between px-6 lg:16 bg-sky-500 p-4 rounded",children:[e.jsxs("div",{className:"flex-col  justify-center items-center ",children:[e.jsx("button",{onClick:()=>O("All"),className:"py-2 w-full bg-white  text-xs rounded-full hover:bg-sky-300",children:"All chats"}),e.jsxs("select",{onChange:g=>O(g.target.value),className:"py-2 w-full bg-white mt-4 text-xs rounded-full cursor-pointer",children:[e.jsx("option",{className:"font-bold",value:"",children:"All Properties"}),N&&N.map(g=>e.jsxs("option",{className:`${g.deleted?"text-red-500":"font-bold text-green-500"}`,value:g._id,children:[g.propertyName," ",g.deleted?" -  (Removed)":" -  (Active)"]},g._id))]})]}),e.jsx("div",{className:"flex flex-col lg:flex-row gap-2 mt-4 lg:mt-0 bg-sky-300 rounded p-2",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center space-y-2 sm:space-y-0 sm:space-x-4",children:[e.jsxs("div",{className:"flex mr-12  items-center space-x-2",children:[e.jsx("label",{htmlFor:"start-date",className:"text-xs",children:"Start Date:"}),e.jsx("input",{type:"date",id:"start-date",name:"start-date",value:p,onChange:D,className:"py-2 px-2 rounded-full border border-gray-300 cursor-pointer"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("label",{htmlFor:"end-date",className:"text-xs",children:"End Date:"}),e.jsx("input",{type:"date",id:"end-date",name:"end-date",value:v,onChange:$,className:"py-2 px-2 rounded-full border border-gray-300 cursor-pointer"}),e.jsx("button",{className:"bg-white text-xs p-3 rounded-full font-semibold hover:bg-sky-200 ",onClick:F,children:"Apply"})]})]})})]}),e.jsxs("div",{className:"flex relative",children:[e.jsx("input",{type:"text",className:"p-4 border-2 w-full rounded focus:outline-none focus:ring-2 focus:ring-sky-500",placeholder:"Search...",value:c,onChange:_}),e.jsx(vs,{className:"absolute top-1/2 transform -translate-y-1/2 text-xl right-8"})]}),e.jsx("div",{className:"flex flex-col gap-4 overflow-y-auto h-[380px]",children:m&&m.map(g=>{var I,T,M,Q,V,z,B,G,Z;return e.jsx(Y,{to:`/admin_chat?conId=${g._id}`,children:e.jsxs("div",{className:"flex items-center justify-between border-2 p-4 rounded hover:bg-gray-100 transition relative",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-full flex justify-center items-center",children:H((I=g==null?void 0:g.propertyId)==null?void 0:I.userType)}),e.jsxs("div",{className:"flex items-center gap-3 relative z-10 mt-3",children:[e.jsx("img",{src:"https://cdn-icons-png.flaticon.com/512/9385/9385289.png",alt:"User",className:"h-14 w-14 rounded-full"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("p",{className:"text-xs text-sky-500 md:text-sm",children:["(",(T=g==null?void 0:g.propertyId)==null?void 0:T.propertyName,")"]}),e.jsx("p",{className:"text-md text-gray-600 font-semibold md:text-xl",children:(M=g==null?void 0:g.userId)==null?void 0:M.username}),e.jsx("p",{className:"text-xs text-gray-400 md:text-sm",children:(V=(Q=g==null?void 0:g.lastMessage)==null?void 0:Q.text)!=null&&V.startsWith("https://")?e.jsxs("div",{className:"flex gap-1 justify-center items-center",children:[e.jsx(kt,{}),"Media"," "]}):(z=g==null?void 0:g.lastMessage)==null?void 0:z.text})]})]}),e.jsxs("div",{className:"flex flex-col justify-center items-center gap-1",children:[e.jsx("span",{className:"text-xs md:text-md",children:new Date((B=g==null?void 0:g.lastMessage)==null?void 0:B.time).toLocaleTimeString()}),((G=g==null?void 0:g.lastMessage)==null?void 0:G.unread)>0&&e.jsx("span",{className:"bg-sky-500 text-white w-6 h-6 rounded-full flex justify-center items-center",children:(Z=g==null?void 0:g.lastMessage)==null?void 0:Z.unread})]})]})},g._id)})}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("button",{className:"p-2 bg-sky-500 text-white rounded",onClick:w,disabled:o===1,children:e.jsx(ks,{})}),e.jsxs("span",{children:["Page ",o," of ",x]}),e.jsx("button",{className:"p-2 bg-sky-500 text-white rounded",onClick:l,disabled:o===x,children:e.jsx(Ss,{})})]})]})})]})},Na=()=>{const[s,t]=a.useState(!0);return e.jsxs("div",{className:"flex w-screen",children:[e.jsx(ue,{navShowSet:t}),e.jsx("div",{className:`transition-all duration-300 ${s?"w-[250px]":"w-[60px]"}`}),e.jsx("div",{className:"flex-1",children:e.jsx(ya,{})})]})},Ys=({onRecordingComplete:s})=>{const[t,o]=a.useState(!1),n=a.useRef(null),x=a.useRef([]),h=()=>{n.current||navigator.mediaDevices.getUserMedia({audio:!0}).then(f=>{n.current=new MediaRecorder(f),n.current.ondataavailable=u=>{u.data.size>0&&(console.log(u.data),s(u.data),x.current.push(u.data))},n.current.start(),o(!0),console.log("Recording started")}).catch(f=>{console.error("Error accessing microphone:",f)})},c=()=>{if(n.current&&n.current.state==="recording"){n.current.stop(),n.current.stream.getTracks().forEach(u=>u.stop()),o(!1);const f=new Blob(x.current,{type:"audio/webm"});console.log("Blob size:",f.size),console.log("Blob:",f),x.current=[],n.current=null}};return e.jsx("div",{children:t?e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:c,children:e.jsx(Ct,{className:"text-2xl text-red-500"})}),e.jsx(je,{type:"bars",className:"text-sky-500",height:30,width:30})]}):e.jsx("button",{onClick:h,children:e.jsx(St,{className:"text-2xl text-sky-500"})})})},wa=()=>{var le,K,Pe,ts;const[s,t]=a.useState(null),[o,n]=a.useState([]),[x,h]=a.useState(!0),c=a.useRef(null),{currentAdmin:f}=J(S=>S==null?void 0:S.admin),u=ae(),{socket:j}=xe(),[y,N]=a.useState(!1),[C,b]=a.useState(!1),[E,p]=a.useState(""),i=ve(),r=new URLSearchParams(i.search).get("conId"),[A,d]=a.useState(),[w,l]=a.useState("text"),[_,m]=a.useState(null),[O,H]=a.useState(!1),[D,$]=a.useState(!1),[F,g]=a.useState({conversationId:r,senderId:f._id,senderModel:"Admin",type:"text",text:""}),I=a.useRef(null),T=S=>{g({...F,text:S.target.value})};a.useEffect(()=>{j.emit("join room",r);const S=R=>{console.log(R),R&&u(`/call_admin_page?conId=${R.conId}&incommingId=${R.incommingId}&callerId=${R.callerId}&videoCall=${R.videoCall}`)};return j.on("incoming-call",S),()=>{j.off("incoming-call",S)}},[r,u,j]);const M=async(S=!1)=>{try{const ee=await(await fetch("/api/start_call",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({callData:{conversationId:r,callerId:f._id,adminId:f._id,userId:s==null?void 0:s.userId._id,caller:"Admin",callType:S?"video":"audio",receiver:"User"},token:s==null?void 0:s.userId.fcmToken,username:f.username})})).json();ee._id&&(console.log("emitted for calling ðŸ’•ðŸ’•ðŸ’•ðŸ’•ðŸ’•ðŸ’•ðŸ’•ðŸ’•ðŸ’•ðŸ’•ðŸ’•ðŸ’•ðŸ’•ðŸ’•ðŸ’•ðŸ’•ðŸ’•ðŸ’•ðŸ’•ðŸ’•"),console.log(ee),j.emit("incoming-call",{conId:r,incommingId:f._id,adminId:f._id,callerId:ee._id,videoCall:S,admin:!0}))}catch(R){console.error("Error starting call:",R)}},Q=async()=>{try{const S=await W.get(`/api/get_admin_messages/${r}`);n(S.data),h(!1),B()}catch(S){console.error("Error fetching messages:",S),h(!1)}},V=async()=>{try{const R=await(await fetch(`/api/selected_conversation/${r}`)).json();t(R),p(R.userId.username)}catch(S){console.error("Error fetching selected conversation:",S)}};a.useEffect(()=>{(async()=>{try{await fetch(`/api/update_conversation_unread_count/${r}`)}catch(ee){console.error("Error updating unread count:",ee)}})(),Q(),V();const R=ee=>{ee.conversationId===r&&n(Ce=>[...Ce,ee])};return j.emit("update conversation",f._id),j.on("recieve_message",R),()=>{j.off("recieve_message",R)}},[r,f._id,j]);const z=async()=>{var S;console.log(F);try{const R=await W.post("/api/admin_send_message",{messageData:F,token:(S=s==null?void 0:s.userId)==null?void 0:S.fcmToken,username:f.username});j.emit("chat message",R.data,r,f._id),l("text"),d(null),g({...F,type:"text",text:""}),B(),H(!1)}catch(R){console.error("Error sending message:",R)}},B=()=>{var S;(S=c.current)==null||S.scrollIntoView({behavior:"smooth"})},G=S=>{if(S.target.files&&S.target.files[0]){const R=S.target.files[0];if(console.log(S.target.files),R.type.startsWith("image/")||R.type.startsWith("video/")){console.log(R.type),l(R.type),d(R),Z(R);return}return ce("Please select an Image or a Video..")}},Z=async S=>{if(!S){ce("Please select a file");return}if(S.size>20971520){ce("Maximum limit of the file size you can share is 20MB"),ce("file size is too large select another file.."),l("text"),d(null);return}try{const ee=fe(ge),Ce=new Date().getTime()+"_"+S.name,Te=Ne(ee,Ce),Ue=we(Te,S);H(!0),Ue.on("state_changed",ne=>{const te=ne.bytesTransferred/ne.totalBytes*100;m(te)},ne=>{console.log(ne),m(null)},()=>{be(Ue.snapshot.ref).then(ne=>{m(null),console.log(ne),d(ne),g(te=>({...te,type:S.type,text:ne}))})})}catch{m(null)}};a.useEffect(()=>{B()},[o]);const se=async(S,R)=>{try{await(await fetch("/api/edit_unknown_username",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:S,username:R})})).json()&&(N(!1),V())}catch(ee){console.log(ee)}},re=S=>{const R={hour:"2-digit",minute:"2-digit",hour12:!0};return new Date(S).toLocaleTimeString([],R)},k=async()=>{Le({title:"Clear chat",message:"Do you want to delete all these conversations?",buttons:[{label:"Yes",onClick:async()=>{console.log("Clearing chat clicked"),(await(await fetch(`/api/clear_admin_chat/${r}`)).json()).success&&(Q(),b(!1),ce("All messages deleted successfully...",{autoClose:1e3}))}},{label:"No",onClick:()=>{b(!1)}}]})};console.log(s);const U=20*1024*1024,X=async S=>{if(!S||S.size===0)return ce.error("Please select an audio file"),null;if(S instanceof File&&S.size>U)return ce.error("Maximum audio file size limit is 20MB"),null;try{$(!0);const R=fe(),ee=new Date().getTime()+"_"+(S instanceof File?S.name:"audio.webm"),Ce=Ne(R,ee),Te=we(Ce,S);return H(!0),new Promise((Ue,ne)=>{Te.on("state_changed",te=>{const Ks=te.bytesTransferred/te.totalBytes*100;console.log(`Upload is ${Ks}% done`)},te=>{console.error("Error uploading audio:",te),ce.error("Failed to upload audio"),ne(te)},async()=>{try{const te=await be(Te.snapshot.ref);console.log("File available at",te),Ue(te)}catch(te){console.error("Error getting download URL:",te),ce.error("Failed to get audio download URL"),ne(te)}})})}catch(R){return console.error("Error uploading audio:",R),ce.error("Failed to upload audio"),null}},he=async S=>{try{const R=await X(S);R&&(g({...F,text:R,type:S.type}),console.log("Audio URL:",R),l(S),console.log(S.type),d(R),$(!1))}catch(R){console.error("Error handling recording:",R)}},ke=async()=>{d(""),l("text"),g({...F,text:"",type:"text"}),H(!1)},Se=S=>{const R=document.createElement("a");R.href=S||"",R.download="image.jpg",R.target="_blank",R.click()};return console.log(s),x?e.jsx("div",{className:"flex justify-center items-center h-full",children:e.jsx(je,{type:"spin",color:"#000"})}):e.jsxs("div",{className:"h-screen bg-gray-50 flex flex-col",children:[e.jsx(Cs,{}),e.jsxs("div",{className:"border-2 flex flex-col h-full p-4 bg-white shadow-lg relative",children:[e.jsxs("div",{className:"flex justify-between items-center px-5 py-2 border-b-2",children:[e.jsxs("div",{className:"flex gap-5 items-center",children:[e.jsx(Y,{to:"/chat_list",children:e.jsx(_t,{className:"text-xl cursor-pointer"})}),e.jsx("img",{src:"https://cdn-icons-png.flaticon.com/512/9385/9385289.png",className:"w-10 h-10 rounded-full",alt:"User"}),e.jsx("span",{className:"text-xl font-bold flex",children:y?e.jsxs("div",{className:"flex justify-center items-center gap-1 md:gap-2",children:[e.jsx("input",{type:"text",value:E,className:"w-[150px] border-2 rounded md:w-[300px] md:p-1",onChange:S=>p(S.target.value)}),e.jsx("button",{className:"text-xs bg-sky-500 text-white px-1 py-1.5 rounded md:p-2 md:text-sm hover:bg-sky-600",onClick:()=>{var S;return se((S=s==null?void 0:s.userId)==null?void 0:S._id,E)},children:"Save"})]}):e.jsxs("div",{className:"flex justify-center gap-2 items-center text-lg md:text-2xl",children:[(le=s==null?void 0:s.userId)==null?void 0:le.username,((K=s==null?void 0:s.propertyId)==null?void 0:K.userType)==="Unknown"&&e.jsx(Et,{className:"cursor-pointer text-sky-500 hover:text-sky-800",onClick:()=>N(!0)})]})})]}),e.jsxs("div",{className:"flex gap-5 items-center text-lg md:text-2xl text-sky-500",children:[e.jsx(Fe,{className:"cursor-pointer hover:text-sky-800",onClick:()=>M(!1)}),s&&s.propertyId.allowVedioCalls&&e.jsx(Xe,{className:"cursor-pointer hover:text-sky-800",onClick:()=>M(!0)}),e.jsx(_s,{className:"cursor-pointer hover:text-sky-800 hover:bg-slate-200 rounded-full hover:text-2xl hover:p-1 md:hover:text-3xl",onClick:()=>b(!C)})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto py-4",children:e.jsxs("div",{className:"flex flex-col gap-4 px-5",children:[o.map(S=>e.jsxs("div",{className:`flex ${S.senderModel==="Admin"?"justify-end":"justify-start"} gap-3`,children:[S.senderModel!=="Admin"&&e.jsx("img",{src:S.senderModel!=="User"?f==null?void 0:f.image:"https://cdn-icons-png.flaticon.com/512/9385/9385289.png",alt:"User",className:"w-10 h-10 rounded-full"}),e.jsxs("div",{className:"flex flex-col max-w-[300px] md:max-w-[350px] lg:max-w-[650px]",children:[e.jsxs("div",{className:"flex justify-between text-xs text-slate-400",children:[e.jsx("span",{children:re(S==null?void 0:S.createdAt)}),e.jsx("span",{children:S.senderModel==="Admin"?e.jsx("span",{className:"text-sky-500 font-bold",children:"You"}):e.jsx("span",{className:"text-sky-500 font-bold",children:s==null?void 0:s.userId.username})})]}),S.type==="text"?e.jsx("div",{className:"p-3 rounded-xl bg-sky-100 text-sm break-words",children:S.text}):e.jsx("div",{className:"p-3 rounded-xl bg-sky-100 text-sm break-words",children:S.type.startsWith("image/")?e.jsxs("div",{className:"relative",children:[e.jsx(Es,{onClick:()=>Se(S.text),className:"text-sky-500 hover:text-sky-800 absolute top-0 left-0 text-3xl md:text-5xl cursor-pointer"}),e.jsx("img",{src:S.text,alt:"Shared file",className:"w-[200px] md:w-[500px]"})]}):S.type.startsWith("video/")?e.jsx("video",{className:"w-[200px] md:w-[500px]",controls:!0,children:e.jsx("source",{src:S.text,type:S.type})}):e.jsxs("audio",{className:"w-[200px] h-[60px] md:w-[500px] ",controls:!0,children:[e.jsx("source",{src:S.text,type:"audio/mpeg"}),"Your browser does not support the audio element."]})})]}),S.senderModel==="Admin"&&e.jsx("img",{src:"/public/userIcon.webp",alt:"User",className:"w-10 h-10 rounded-full"})]},S._id)),e.jsx("div",{ref:c})]})}),e.jsxs("div",{className:"flex justify-between items-center px-5 py-2 bg-sky-200 rounded-lg mt-2",children:[!O&&e.jsx(Ys,{onRecordingComplete:he}),D&&e.jsx(je,{type:"bubbles",className:"text-sky-500",color:"skyBlue",width:100}),w==="text"&&e.jsx("input",{type:"text",placeholder:"Write something...",className:"flex-1 mx-3 p-2 rounded-lg border bg-sky-100 border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-500",value:F.text,onChange:T,onKeyPress:S=>S.key==="Enter"&&z()}),e.jsxs("div",{className:"flex",children:[_&&_<100?e.jsx(je,{type:"bubbles",className:"text-sky-500",color:"skyBlue",width:100}):A&&e.jsx(e.Fragment,{children:typeof w=="string"&&w.startsWith("image/")?e.jsx("div",{children:e.jsx("img",{src:A,alt:"Selected file",width:250})}):typeof w=="string"&&w.startsWith("video/")?e.jsx("video",{src:A,width:250,height:400,controls:!0}):e.jsxs("div",{className:"flex gap-1 justify-center items-center",children:[e.jsx("audio",{className:"rounded",src:A,controls:!0}),e.jsx("div",{className:"hover:bg-sky-100 p-3 rounded-full",onClick:ke,children:e.jsx(Is,{className:"text-sky-500 cursor-pointer"})})]})}),e.jsx("input",{type:"file",ref:I,name:"",id:"",onChange:G,hidden:!0}),!O&&e.jsx(It,{onClick:()=>{var S;return(S=I.current)==null?void 0:S.click()},className:"text-sky-500 text-2xl cursor-pointer"})]}),F&&F.text!==""&&e.jsx("div",{className:"p-2 rounded-full bg-sky-500 ml-3 cursor-pointer",onClick:z,children:e.jsx(As,{className:"text-white text-2xl"})})]}),C&&e.jsxs("div",{className:"w-34 h-39 absolute bg-slate-700 opacity-70 right-14 rounded top-12 flex flex-col p-3 gap-4 md:w-40",children:[(s==null?void 0:s.propertyId.userType)!=="Unknown"&&e.jsxs(e.Fragment,{children:[e.jsx("a",{href:`https://wa.me/${(Pe=s==null?void 0:s.userId)==null?void 0:Pe.phone}`,children:e.jsxs("div",{className:"flex justify-start gap-2  rounded items-center hover:p-1 hover:bg-slate-900 cursor-pointer text-white text-sm md:text-lg",children:[e.jsx(Ps,{className:"text-green-600"})," ",e.jsx("span",{className:"text-sm",children:" Whats app"})]})}),e.jsx("a",{href:`tel:${(ts=s==null?void 0:s.userId)==null?void 0:ts.phone}`,children:e.jsxs("div",{className:"flex justify-start gap-2  rounded items-center hover:p-1 hover:bg-slate-900 cursor-pointer text-white text-sm md:text-lg",children:[e.jsx(Fe,{className:"text-green-600"})," ",e.jsx("span",{className:"text-sm",children:s==null?void 0:s.userId.phone})]})})]}),e.jsxs("div",{className:"flex justify-start gap-2  rounded items-center hover:p-1 hover:bg-slate-900 cursor-pointer text-white text-sm md:text-lg",onClick:k,children:[e.jsx(Ts,{className:"text-red-600"})," ",e.jsx("span",{className:"text-sm",children:"Clear chat"})]})]})]})]})},ba=()=>{const[s,t]=a.useState(!0);return e.jsxs("div",{className:"flex w-screen",children:[e.jsx("div",{className:"hidden md:block",children:e.jsx(ue,{navShowSet:t})}),e.jsx("div",{className:`hidden md:block transition-all duration-300 ${s?"w-[250px]":"w-[60px]"}`}),e.jsx("div",{className:"flex-1",children:e.jsx(wa,{})})]})},va={currentUser:null,error:null,loading:!1,messages:[]},Gs=ze({name:"user",initialState:va,reducers:{signInSuccess:(s,t)=>{s.currentUser=t.payload,s.loading=!1,s.error=null},setMessages:(s,t)=>{s.messages=Array.isArray(t.payload)?t.payload:[]},signoutSuccess:s=>{s.currentUser=null,s.error=null,s.loading=!1,s.messages=[]}}}),{signInSuccess:Ae,setMessages:ns,signoutSuccess:Hs}=Gs.actions,ka=Gs.reducer,Sa=()=>{const{currentUser:s}=J(l=>l.user),[t,o]=a.useState(),[n,x]=a.useState(""),h=ae(),c=me(),u=new URLSearchParams(ve().search),j=u.get("adminId"),y=u.get("propId"),[N,C]=a.useState({adminId:j||"",propId:(t==null?void 0:t._id)||"",username:"",purpose:"",phone:"",verified:!1,firebaseCode:""}),b=()=>{let l=localStorage.getItem("mac-id");return l||(l=At(),localStorage.setItem("mac-id",l)),l},E=0,p=async l=>{try{const _=await fetch("/user/create_unknown_user_data",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({adminId:j,propId:l,username:"Unknown",purpose:"Unknown contact",phone:E,firebaseCode:"0000000000",verified:!0,macId:n})});if(_.ok){const m=await _.json();if(m)try{const O=await W.post("/user/start_conversation",{userId:m._id,adminId:m.adminId,propertyId:l});O.data&&(P("Successful!"),c(Ae(O.data.user)),h(`/chat_user?conId=${O.data.user.conversationId}`))}catch{}}else throw new Error("Failed to create unknown user")}catch{P.error("Failed to create unknown user. Please try again.")}};a.useEffect(()=>{const l=b();l&&x(l),(async()=>{try{const m=await fetch("/user/get_admins_property_data",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({propId:y,adminId:j})});if(m.ok){const O=await m.json();C({...N,propId:O._id}),o(O),s&&s.propId._id===O._id?(P("You have an old chat list here"),h(`/chat_user?conId=${s.conversationId}`)):(c(Hs()),O.userType==="Unknown"&&!O.deleted&&n!==""&&p(O._id))}else throw new Error("Failed to fetch property data")}catch{P.error("Failed to fetch property data. Please try again.")}})()},[n]);const i=l=>{const{name:_,value:m}=l.target;C(O=>({...O,[_]:m}))},v=l=>{C(_=>({..._,phone:l}))},r=()=>N.username&&N.purpose&&N.phone,A=async()=>{if(!r())return P.error("Please fill out all fields.");if((t==null?void 0:t.userType)==="Unverified"){console.log("unverified user clicked ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥");const l=await fetch("/user/create_unverified_user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(N)});if(!l.ok)throw new Error("Network response was not ok");const _=await l.json();if(_)try{const m=await W.post("/user/start_conversation",{userId:_._id,adminId:_.adminId._id,propertyId:t==null?void 0:t._id});m.data&&(P("successful!"),c(Ae(m.data.user)),h(`/chat_user?conId=${m.data.user.conversationId}`),console.log(m.data.user))}catch{}}else(t==null?void 0:t.userType)==="Verified"&&w()},d=async l=>{try{const _=await fetch("/user/create_verified_user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});if(!_.ok)throw new Error("Network response was not ok");const m=await _.json();console.log(m),m._id&&h(`/user_verify_otp_page/${m._id}`)}catch{P.error("Something went wrong. Please try again.")}},w=async()=>{if(!r())return P.error("Please fill out all fields.");try{const l=new $e(oe,"recaptcha",{}),_="+"+N.phone,m=await Ve(oe,_,l);if(console.log(m),m){const O=N.phone+""+Date.now(),H={...N,userId:O,firebaseCode:m.verificationId};C(H),d(H)}else console.log("Error confirming the captcha.")}catch(l){console.log(l),P.error("Failed to send OTP. Please try again.")}};return console.log(N),console.log(t),e.jsxs("div",{className:"relative min-h-screen flex flex-col items-center justify-center bg-gray-100 p-4",children:[e.jsx("div",{className:"absolute z-0 rounded-2xl -top-40 left-1/2 transform -translate-x-1/2 bg-sky-500 w-60 h-40 lg:h-96 rotate-45"}),e.jsx("div",{className:"w-full flex justify-end p-4",children:e.jsx("button",{className:"bg-sky-500 py-2 px-3 rounded text-white hover:bg-sky-700",children:"Register"})}),e.jsx("div",{className:"w-full max-w-4xl mx-auto p-4 lg:px-16",children:e.jsxs("div",{className:"p-6 lg:p-10 flex flex-col justify-center items-center rounded relative z-10 border-2 bg-white gap-5 shadow-md",children:[e.jsx("h1",{className:"uppercase text-lg lg:text-2xl text-center font-bold tracking-wider",children:"Enter User Details"}),e.jsxs("div",{className:"flex flex-col gap-4 lg:gap-8",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex justify-between px-2 lg:px-10",children:[e.jsx("span",{children:"Name"}),(N==null?void 0:N.username)&&e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(L,{className:"text-green-600 text-xs"}),e.jsx("span",{children:"Valid"})]})]}),e.jsx("input",{type:"text",onChange:i,value:N==null?void 0:N.username,name:"username",className:"rounded border-2 w-full px-5 lg:w-[600px] py-3 placeholder:font-semibold placeholder:px-2 lg:placeholder:px-6",placeholder:"Enter your name"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex justify-between px-2 lg:px-10",children:[e.jsx("span",{children:"Purpose"}),(N==null?void 0:N.purpose)&&e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(L,{className:"text-green-600 text-xs"}),e.jsx("span",{children:"Valid"})]})]}),e.jsx("input",{type:"text",onChange:i,value:N==null?void 0:N.purpose,name:"purpose",className:"rounded border-2 w-full px-5 lg:w-[600px] py-3 placeholder:font-semibold placeholder:px-2 lg:placeholder:px-6",placeholder:"Enter purpose of contacting"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex justify-between px-2 lg:px-10",children:[e.jsx("span",{children:"Phone"}),N.phone&&e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(L,{className:"text-green-600 text-xs"}),e.jsx("span",{children:"Valid"})]})]}),e.jsx(cs,{country:"in",value:N==null?void 0:N.phone,onChange:v,containerClass:"rounded border-2 w-full px-5 lg:w-[600px] py-3 placeholder:font-semibold placeholder:px-2 lg:placeholder:px-6",inputClass:"w-full",placeholder:"Enter your phone"})]})]}),e.jsx("div",{id:"recaptcha",className:"recaptcha"}),e.jsx("div",{children:e.jsx("button",{className:"bg-sky-500 py-2 px-4 rounded text-white hover:bg-sky-700",onClick:A,disabled:!r(),children:"Proceed"})})]})})]})},Ca=()=>{const[s,t]=a.useState(new Array(6).fill("")),[o,n]=a.useState(30),[x,h]=a.useState(null),c=is(),f=ae(),u=me();a.useEffect(()=>{if(o>0){const C=setTimeout(()=>n(o-1),1e3);return()=>clearTimeout(C)}},[o]),a.useEffect(()=>{(async()=>{try{const b=await fetch(`/user/get_user_by_id/${c.id}`);if(b.ok){const E=await b.json();h(E)}else console.log("Error fetching user data:",b.status)}catch(b){console.log("Error fetching user data:",b)}})()},[c.id]);const j=(C,b)=>{if(isNaN(Number(C.value)))return;const E=[...s];E[b]=C.value,t(E),C.nextSibling&&C.value!==""&&C.nextSibling.focus()},y=async()=>{n(60);try{const C=new $e(oe,"recaptcha",{}),b=await Ve(oe,"+"+(x==null?void 0:x.phone),C);if(b){console.log(b);const E=await fetch("/user/user_update_firebase_verify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({firebaseConfirm:b.verificationId,phone:x==null?void 0:x.phone})});if(E.ok){const p=await E.json();h(p),P("OTP resended successfully")}else console.log("Error updating firebase verification:",E.status)}else console.log("Error confirming the captcha.")}catch(C){console.log("Error resending OTP:",C)}},N=async()=>{const C=s.join(""),b=x==null?void 0:x.firebaseCode;if(!b){console.log("Verification ID is missing.");return}try{const E=ds.credential(b,C),p=await xs(oe,E);if(console.log("Verification result:",p),p){P("OTP verification successful!");try{if(!(x!=null&&x._id)){console.log("User ID is missing.");return}const i=await fetch(`/user/user_update_verify/${x._id}`,{method:"POST"});if(i.ok){const v=await i.json();if(h(v),console.log("Verification update response data:",v),v)try{const r=await W.post("/user/start_conversation",{userId:v._id,adminId:v.adminId,propertyId:v.propId});r.data&&(console.log("Conversation created:",r.data),P("OTP verification successful!"),u(Ae(r.data.user)),f(`/chat_user?conId=${r.data.user.conversationId}`))}catch(r){console.error("Error starting conversation:",r)}else v!=null&&v.conversationId&&(u(Ae(v)),f(`/chat_user?conId=${v.conversationId}`))}else{const v=await i.text();console.log("Error updating verification status:",i.statusText,v),P("Error updating verification status")}}catch(i){console.log("Error during verification update:",i),P("Error during verification update")}}else return P("verification failed")}catch(E){E.code==="auth/code-expired"?P("The OTP has expired. Please request a new one."):E.code==="auth/invalid-verification-code"?P("The OTP entered is invalid. Please try again."):alert("Error verifying OTP. Please try again."),console.log("Error verifying OTP:",E)}};return console.log(s),e.jsx("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gray-100 p-4",children:e.jsxs("div",{className:"bg-white shadow-lg rounded-lg p-8 max-w-sm w-full",children:[e.jsx("div",{className:"flex justify-center mb-6",children:e.jsx("img",{src:"https://firebasestorage.googleapis.com/v0/b/elite-mediator.appspot.com/o/360_F_523692923_hxuZgDZr6uzJx6yVvNjOGfgVnQVXrKad.jpg?alt=media&token=f218a4b5-325b-45bb-9ff6-b66d056c74b6",alt:"OTP Icon",className:"w-50 h-60 object-cover"})}),e.jsx("h2",{className:"text-center text-lg font-semibold mb-4",children:"Enter the OTP sent to your mobile"}),e.jsx("div",{className:"flex justify-center mb-4 space-x-2",children:s.map((C,b)=>e.jsx("input",{type:"text",name:"otp",maxLength:1,className:"w-12 h-12 text-center text-lg border border-gray-300 rounded-md focus:ring-2 focus:ring-sky-500 focus:border-transparent",value:C,onChange:E=>j(E.target,b),onFocus:E=>E.target.select()},b))}),e.jsx("button",{onClick:N,className:"w-full py-2 bg-sky-500 text-white font-semibold rounded-md hover:bg-sky-600 transition duration-300",children:"Verify"}),e.jsx("div",{className:"mt-4 flex justify-center",children:e.jsx("button",{disabled:o!==0,onClick:y,className:"text-sky-500 underline",children:o===0?"Resend OTP":`Resend OTP in ${o} seconds`})}),e.jsx("div",{id:"recaptcha"})]})})},_a=()=>{const{currentUser:s}=J(t=>t.user);return s?e.jsx(qe,{}):e.jsx(Ye,{to:"/"})},Ea=()=>{const{socket:s}=xe(),t=ae();let o=a.useRef(),n=a.useRef();const{currentAdmin:x}=J(g=>g.admin),[h,c]=a.useState(""),f=ve(),u=new URLSearchParams(f.search),j=u.get("conId"),y=u.get("incommingId"),N=u.get("callerId"),b=u.get("videoCall")==="true",[E,p]=a.useState(!1),[i,v]=a.useState(0),[r,A]=a.useState(!1),[d,w]=a.useState(!0);let l=a.useRef(null);a.useEffect(()=>{s.emit("join room",j);const g=setInterval(()=>{v(I=>I+1)},1e3);return()=>clearInterval(g)},[]);const _=g=>{const I=`0${g%60}`.slice(-2),M=`0${`${Math.floor(g/60)}`%60}`.slice(-2);return`${`0${Math.floor(g/3600)}`.slice(-2)}:${M}:${I}`},m=async()=>{try{const I=await(await fetch(`/api/selected_conversation/${j}`)).json();c(I.userId.username),console.log(I)}catch(g){console.log(g)}},O=()=>{if(o.current&&o.current.srcObject){const g=o.current.srcObject;console.log(g),g.getAudioTracks().forEach(I=>{I.enabled=!I.enabled}),p(I=>!I)}},H=async g=>{try{const I=await fetch(`/api/decline_call/${g}`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!I.ok)throw new Error(`HTTP error! status: ${I.status}`);const T=await I.json();console.log(T)}catch(I){console.error("Error updating call status:",I)}},D=async g=>{try{const I=await fetch(`/api/accept_call/${g}`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!I.ok)throw new Error(`HTTP error! status: ${I.status}`);const T=await I.json();console.log(T)}catch(I){console.error("Error updating call status:",I)}},$=async g=>{try{const I=await fetch(`/api/disconnect_call/${g}`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!I.ok)throw new Error(`HTTP error! status: ${I.status}`);const T=await I.json();console.log(T)}catch(I){console.error("Error updating call status:",I)}};a.useEffect(()=>{l.current||(l.current=new RTCPeerConnection({iceServers:[{urls:"stun:stun.l.google.com:19302"}]})),m(),s.emit("join room",j);const g=async()=>{var V,z;try{const B={audio:!0,video:b},G=await navigator.mediaDevices.getUserMedia(B);G.getTracks().forEach(se=>{var re;return(re=l==null?void 0:l.current)==null?void 0:re.addTrack(se,G)}),o.current&&(o.current.srcObject=G);const Z=await((V=l==null?void 0:l.current)==null?void 0:V.createOffer());await((z=l==null?void 0:l.current)==null?void 0:z.setLocalDescription(Z)),s.emit("webrtc-offer",{incommingId:x.username,room:j,isVideo:b,offer:Z,callerId:N})}catch(B){console.error("Error creating offer:",B)}};console.log(y+"  "+x.username),y===x._id&&g();const I=async V=>{console.log("handling offer ðŸ’•ðŸ’•ðŸ’•ðŸ’•ðŸ’•ðŸ’•"),V.incommingId!==x.username&&Le({title:"Incoming Call",message:`You have a call from ${V.incommingId}. Do you want to accept the call?`,buttons:[{label:"Yes",onClick:async()=>{var Z,se,re;const z={audio:!0,video:V.isVideo},B=await navigator.mediaDevices.getUserMedia(z);B.getTracks().forEach(k=>{var U;return(U=l==null?void 0:l.current)==null?void 0:U.addTrack(k,B)}),o.current&&(o.current.srcObject=B),await((Z=l==null?void 0:l.current)==null?void 0:Z.setRemoteDescription(new RTCSessionDescription(V.offer)));const G=await((se=l==null?void 0:l.current)==null?void 0:se.createAnswer());await((re=l==null?void 0:l.current)==null?void 0:re.setLocalDescription(G)),s.emit("webrtc-answer",{room:j,answer:G,incommingId:x.username,callerId:N}),D(V.callerId)}},{label:"No",onClick:async()=>{s.emit("webrtc-disconnect",j,N),H(V.callerId)}}]})},T=async V=>{var G,Z,se;console.log("handling answer ðŸ’•ðŸ’•ðŸ’•ðŸ’•ðŸ’•ðŸ’•");const{incommingId:z,answer:B}=V;if(x.username!==z)if(((G=l==null?void 0:l.current)==null?void 0:G.signalingState)==="have-local-offer")try{await((Z=l==null?void 0:l.current)==null?void 0:Z.setRemoteDescription(new RTCSessionDescription(B)))}catch(re){console.error("Error setting remote description:",re)}else console.warn("Signaling state is not 'have-local-offer'. Current state: ",(se=l==null?void 0:l.current)==null?void 0:se.signalingState)},M=async V=>{var z;console.log("handling icecandidate ðŸ’•ðŸ’•ðŸ’•ðŸ’•ðŸ’•ðŸ’•");try{await((z=l==null?void 0:l.current)==null?void 0:z.addIceCandidate(new RTCIceCandidate(V)))}catch(B){console.error("Error adding received ice candidate",B)}},Q=V=>{A(!1),o.current&&o.current.srcObject&&(o.current.srcObject.getTracks().forEach(B=>B.stop()),o.current.srcObject=null),l.current&&(l.current.getSenders().forEach(z=>z.track&&z.track.stop()),l.current.close(),l.current=new RTCPeerConnection({iceServers:[{urls:"stun:stun.l.google.com:19302"}]})),n.current&&(n.current.srcObject=null),s.off("webrtc-offer",I),s.off("webrtc-answer",T),s.off("webrtc-ice-candidate",M),t(`/admin_chat?conId=${V}`)};return s.on("webrtc-offer",I),s.on("webrtc-answer",T),s.on("webrtc-ice-candidate",M),s.on("webrtc-disconnect",Q),l.current.onicecandidate=V=>{V.candidate&&s.emit("webrtc-ice-candidate",{room:j,candidate:V.candidate})},l.current.ontrack=V=>{V.streams&&V.streams.length>0&&(w(!1),A(!0),n.current.srcObject=V.streams[0],console.log(o),console.log(n))},()=>{s.off("webrtc-offer"),s.off("webrtc-answer"),s.off("webrtc-ice-candidate"),s.off("webrtc-disconnect")}},[j,x.username,s]);const F=()=>{o.current&&o.current.srcObject&&(o.current.srcObject.getTracks().forEach(I=>I.stop()),o.current.srcObject=null),l.current&&(l.current.getSenders().forEach(g=>g.track&&g.track.stop()),l.current.close()),s.emit("webrtc-disconnect",j,N),s.off("webrtc-offer"),s.off("webrtc-answer"),s.off("webrtc-ice-candidate"),n.current&&(n.current.srcObject=null),t(`/admin_chat?conId=${j}`),$(N)};return e.jsxs("div",{className:"flex flex-col max-h-screen gap-y-2 p-9",children:[e.jsxs("div",{className:"flex flex-col gap-5 mb-10",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("h3",{className:"text-2xl font-bold",children:"Connected"})}),e.jsx("div",{className:"flex justify-center",children:b?e.jsxs("div",{className:"flex flex-col justify-center items-center relative",children:[e.jsx("video",{ref:o,autoPlay:!0,muted:!0,className:"w-1/4 absolute bottom-4 z-10 right-4 md:right-16 md:bottom-4 md:w-[250px] border-2 border-white"}),e.jsx("video",{ref:n,autoPlay:!0,className:"w-full h-full md:w-[900px] md:h-[700px] border-2 border-white"})]}):e.jsxs("div",{className:"flex flex-col justify-center items-center",children:[e.jsx("div",{className:`w-52 h-52 rounded-full flex justify-center items-center ${r&&" bg-green-300"}`,children:e.jsx("div",{className:"w-48 h-48 bg-sky-500 rounded-full flex justify-center items-center",children:e.jsx(Us,{className:"text-white text-9xl p-2"})})}),e.jsxs("div",{className:"w-[50px] h-[50px]",children:[e.jsx("video",{ref:o,autoPlay:!0,muted:!0}),e.jsx("video",{ref:n,autoPlay:!0})]})]})}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("h2",{className:"font-bold text-3xl text-sky-500",children:h}),d&&d?e.jsx("p",{children:"Calling...."}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-green-600",children:"Connected"}),e.jsxs("p",{children:["Call Duration: ",r?_(i):"00:00:00"]})]})]})})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("div",{className:"flex justify-center px-16",children:e.jsx("button",{className:"flex justify-center p-2 items-center hover:rounded-full hover:bg-slate-100",onClick:O,children:E?e.jsx(Os,{className:"text-zinc-500 text-6xl"}):e.jsx(Rs,{className:"text-zinc-500 text-6xl"})})}),e.jsx("div",{className:"flex justify-center mt-4",children:e.jsx("button",{onClick:F,className:"flex justify-center items-center w-20 h-20 bg-red-400 rounded-full hover:bg-red-800",children:e.jsx($s,{className:"text-white text-5xl"})})})]})]})},Ia=()=>{const s=ae(),{currentUser:t}=J(D=>D.user),o=ve(),n=new URLSearchParams(o.search),x=n.get("conId"),h=n.get("incommingId"),c=n.get("callerId"),u=n.get("videoCall")==="true",{socket:j}=xe(),[y,N]=a.useState(!1),[C,b]=a.useState(0),[E,p]=a.useState(!1),[i,v]=a.useState(!0),r=a.useRef(null),A=a.useRef(null);let d=a.useRef(null);a.useEffect(()=>{const D=setInterval(()=>{b($=>$+1)},1e3);return()=>clearInterval(D)},[]);const w=D=>{const $=`0${D%60}`.slice(-2),g=`0${`${Math.floor(D/60)}`%60}`.slice(-2);return`${`0${Math.floor(D/3600)}`.slice(-2)}:${g}:${$}`},l=()=>{if(console.log("localVideoRef.current:",r.current),r.current){const D=r.current.srcObject;if(D){const $=D.getAudioTracks();$.length>0?($.forEach(F=>{F.enabled=!F.enabled}),N(F=>!F),console.log("Mute toggled:",!y)):console.log("No audio tracks found in local stream")}else console.log("localStream is null or undefined")}else console.log("localVideoRef is null or undefined")};a.useEffect(()=>{d.current||(d.current=new RTCPeerConnection({iceServers:[{urls:"stun:stun.l.google.com:19302"}]})),j.emit("join room",x);const D=async()=>{var T,M;try{const Q={audio:!0,video:u},V=await navigator.mediaDevices.getUserMedia(Q);V.getTracks().forEach(B=>{var G;return(G=d==null?void 0:d.current)==null?void 0:G.addTrack(B,V)}),r.current&&(r.current.srcObject=V,console.log("Stream assigned to localVideoRef"));const z=await((T=d==null?void 0:d.current)==null?void 0:T.createOffer());await((M=d==null?void 0:d.current)==null?void 0:M.setLocalDescription(z)),j.emit("webrtc-offer",{incommingId:t.username,room:x,isVideo:u,offer:z,callerId:c})}catch(Q){console.error("Error creating offer:",Q)}};h===t._id&&D();const $=async T=>{console.log(T),T.incommingId!==t.username&&Le({title:"Incoming Call",message:`You have a call from ${T.incommingId}. Do you want to accept the call?`,buttons:[{label:"Yes",onClick:async()=>{var M,Q,V;try{m(T.callerId);const z={audio:!0,video:T.isVideo},B=await navigator.mediaDevices.getUserMedia(z);B.getTracks().forEach(Z=>{var se;return(se=d==null?void 0:d.current)==null?void 0:se.addTrack(Z,B)}),r.current&&(r.current.srcObject=B,console.log("Stream assigned to localVideoRef on offer acceptance")),console.log(r),await((M=d==null?void 0:d.current)==null?void 0:M.setRemoteDescription(new RTCSessionDescription(T.offer)));const G=await((Q=d==null?void 0:d.current)==null?void 0:Q.createAnswer());await((V=d==null?void 0:d.current)==null?void 0:V.setLocalDescription(G)),j.emit("webrtc-answer",{room:x,answer:G,incommingId:t.username,callerId:T.callerId})}catch(z){console.error("Error handling offer acceptance:",z)}}},{label:"No",onClick:()=>{try{s(`/chat_user?conId=${x}`),_(T.callerId),j.emit("webrtc-disconnect",x,T.callerId)}catch(M){console.error("Error handling offer rejection:",M)}}}]})},F=async T=>{var V,z,B;const{incommingId:M,answer:Q}=T;if(t.username!==M)if(((V=d==null?void 0:d.current)==null?void 0:V.signalingState)==="have-local-offer")try{await((z=d==null?void 0:d.current)==null?void 0:z.setRemoteDescription(new RTCSessionDescription(Q)))}catch(G){console.error("Error setting remote description:",G)}else console.warn("Signaling state is not 'have-local-offer'. Current state: ",(B=d==null?void 0:d.current)==null?void 0:B.signalingState)},g=async T=>{var M;try{await((M=d==null?void 0:d.current)==null?void 0:M.addIceCandidate(new RTCIceCandidate(T))),console.log(r),console.log(A)}catch(Q){console.error("Error adding received ice candidate",Q)}},I=T=>{r.current&&r.current.srcObject&&(r.current.srcObject.getTracks().forEach(Q=>Q.stop()),r.current.srcObject=null),d.current&&(d.current.getSenders().forEach(M=>M.track&&M.track.stop()),d.current.close(),d.current=new RTCPeerConnection({iceServers:[{urls:"stun:stun.l.google.com:19302"}]})),A.current&&(A.current.srcObject=null),j.off("webrtc-offer",$),j.off("webrtc-answer",F),j.off("webrtc-ice-candidate",g),s(`/chat_user?conId=${T}`)};return j.on("webrtc-offer",$),j.on("webrtc-answer",F),j.on("webrtc-ice-candidate",g),j.on("webrtc-disconnect",I),d.current.onicecandidate=T=>{T.candidate&&j.emit("webrtc-ice-candidate",{room:x,candidate:T.candidate})},d.current.ontrack=T=>{T.streams&&T.streams.length>0&&(v(!1),p(!0),A.current.srcObject=T.streams[0])},()=>{j.off("webrtc-offer",$),j.off("webrtc-answer",F),j.off("webrtc-ice-candidate",g),j.off("webrtc-disconnect",I)}},[x,t.username,u]);const _=async D=>{try{const $=await fetch(`/api/decline_call/${D}`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!$.ok)throw new Error(`HTTP error! status: ${$.status}`);const F=await $.json();console.log(F)}catch($){console.error("Error updating call status:",$)}},m=async D=>{try{const $=await fetch(`/api/accept_call/${D}`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!$.ok)throw new Error(`HTTP error! status: ${$.status}`);const F=await $.json();console.log(F)}catch($){console.error("Error updating call status:",$)}},O=async D=>{try{const $=await fetch(`/api/disconnect_call/${D}`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!$.ok)throw new Error(`HTTP error! status: ${$.status}`);const F=await $.json();console.log(F)}catch($){console.error("Error updating call status:",$)}},H=()=>{r.current&&r.current.srcObject&&(r.current.srcObject.getTracks().forEach($=>$.stop()),r.current.srcObject=null),d.current&&(d.current.getSenders().forEach(D=>D.track&&D.track.stop()),d.current.close()),j.emit("webrtc-disconnect",x,c),j.off("webrtc-offer"),j.off("webrtc-answer"),j.off("webrtc-ice-candidate"),A.current&&(A.current.srcObject=null),s(`/chat_user?conId=${x}`),O(c)};return e.jsxs("div",{children:[e.jsx(Cs,{}),e.jsxs("div",{className:"flex flex-col gap-y-2 p-9",children:[e.jsxs("div",{className:"flex flex-col gap-5 mb-10",children:[e.jsx("div",{className:"flex justify-center",children:i&&i?e.jsx("h3",{className:"text-2xl font-bold",children:"Calling...."}):e.jsx("h3",{className:"text-2xl font-bold",children:"Connected"})}),e.jsx("div",{className:"flex justify-center",children:u?e.jsxs("div",{className:"flex flex-col justify-center items-center relative",children:[e.jsx("video",{ref:r,autoPlay:!0,muted:!0,className:"w-1/4 absolute bottom-4 z-10 right-4 md:right-16 md:bottom-4 md:w-[250px] border-2 border-white"}),e.jsx("video",{ref:A,autoPlay:!0,className:"w-full h-full md:w-[900px] md:h-[700px] border-2 border-white"})]}):e.jsxs("div",{className:"flex flex-col justify-center items-center",children:[e.jsx("div",{className:`w-52 h-52 rounded-full flex justify-center items-center ${E&&" bg-green-300"}`,children:e.jsx("div",{className:"w-48 h-48 bg-sky-500 rounded-full flex justify-center items-center",children:e.jsx(Us,{className:"text-white text-9xl p-2"})})}),e.jsxs("div",{className:"w-[50px] h-[50px]",children:[e.jsx("video",{ref:r,autoPlay:!0,muted:!0}),e.jsx("video",{ref:A,autoPlay:!0})]})]})}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("h2",{className:"font-bold text-3xl text-sky-500",children:"Arjun Kumar VS"}),i&&i?e.jsx("p",{children:"Calling...."}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-green-600",children:"Connected"}),e.jsxs("p",{children:["Call Duration: ",E?w(C):"00:00:00"]})]})]})})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("div",{className:"flex justify-center px-16",children:e.jsx("button",{className:"flex justify-center p-2 items-center hover:rounded-full hover:bg-slate-100",onClick:l,children:y?e.jsx(Os,{className:"text-zinc-500 text-6xl"}):e.jsx(Rs,{className:"text-zinc-500 text-6xl"})})}),e.jsx("div",{className:"flex justify-center mt-4",children:e.jsx("button",{onClick:H,className:"flex justify-center items-center w-20 h-20 bg-red-400 rounded-full hover:bg-red-800",children:e.jsx($s,{className:"text-white text-5xl"})})})]})]})]})},Aa=()=>{var se,re;const s=a.useRef(null),{currentUser:t,messages:o}=J(k=>k.user),{socket:n}=xe(),x=me(),h=ae(),c=ve(),u=new URLSearchParams(c.search).get("conId"),[j,y]=a.useState(!1),[N,C]=a.useState(null),[b,E]=a.useState(!1),[p,i]=a.useState(),[v,r]=a.useState("text"),[A,d]=a.useState(!1),[w,l]=a.useState({conversationId:u,senderId:t._id,senderModel:"User",type:"text",text:""}),_=a.useRef(null),m=async()=>{const k=await De(),X=await(await fetch("/user/user_add_or_get_fcmtoken",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:k,userId:t._id})})).json();console.log(X),console.log("fcm updated succesfully â¤ï¸â¤ï¸â¤ï¸â¤ï¸â¤ï¸â¤ï¸â¤ï¸â¤ï¸â¤ï¸â¤ï¸â¤ï¸"),X&&x(Ae(X))},O=k=>{if(k.target.files&&k.target.files[0]){const U=k.target.files[0];if(console.log(k.target.files),U.type.startsWith("image/")||U.type.startsWith("video/")){console.log(U.type),r(U.type),i(U),H(U);return}return ie("Please select an Image or a Video..")}},H=async k=>{if(!k){ie("Please select a file");return}if(k.size>20971520){ie("Maximum limit of the file size you can share is 20MB"),ie("file size is too large select another file.."),r("text"),i(null);return}try{const X=fe(ge),he=new Date().getTime()+"_"+k.name,ke=Ne(X,he),Se=we(ke,k);E(!0),Se.on("state_changed",le=>{const K=le.bytesTransferred/le.totalBytes*100;C(K)},le=>{console.log(le),C(null)},()=>{be(Se.snapshot.ref).then(le=>{C(null),console.log(le),i(le),l(K=>({...K,type:k.type,text:le}))})})}catch{C(null)}};a.useEffect(()=>{m(),n.emit("join room",u),n.emit("join room",t.adminId._id);const k=U=>{console.log(U),U.callerId&&h(`/call_page_user?conId=${U.conId}&incommingId=${U.incommingId}&callerId=${U.callerId}&videoCall=${U.videoCall}`)};return n.on("incoming-call",k),()=>{n.off("incoming-call",k)}},[u,t.username,h]);const D=async(k=!1)=>{try{const X=await(await fetch("/user/start_call",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({callData:{conversationId:t.conversationId,adminId:t.adminId._id,userId:t._id,caller:"User",callType:k?"video":"audio",receiver:"Admin"},token:t.adminId.fcmToken,username:t.username})})).json();console.log(X),X&&n.emit("incoming-call",{conId:u,incommingId:t._id,adminId:t.adminId._id,callerId:X._id,videoCall:k,admin:!1})}catch(U){console.error("Error starting call:",U)}};console.log(t),a.useEffect(()=>(n.on("recieve_message",k=>{k.conversationId===u&&x(ns([...o,k]))}),()=>{n.off("recieve_message")}),[o,x,u]);const $=async()=>{try{const k=await W.get(`/user/get_user_messages/${u}`);console.log(k),console.log(k.data),x(ns(k.data))}catch(k){console.error("Error fetching messages:",k)}};a.useEffect(()=>{u&&(n.emit("join room",u),$()),h(t?`/chat_user?conId=${u}`:"/")},[t,u,h]);const F=async()=>{var k;console.log("sending message");try{const U=await W.post("/user/user_send_message_to_admin",{messageData:w,token:(k=t==null?void 0:t.adminId)==null?void 0:k.fcmToken,username:t.username});n.emit("chat message",U.data,u,t.adminId),n.emit("update conversation",t.adminId),n.emit("notify",t.adminId),r("text"),i(null),l({...w,type:"text",text:""}),g(),E(!1)}catch(U){console.error("Error sending message:",U)}},g=()=>{var k;(k=s.current)==null||k.scrollIntoView({behavior:"smooth"})};a.useEffect(()=>{g()},[o]);const I=()=>{x(Hs()),h("/")},T=k=>{const U={hour:"2-digit",minute:"2-digit",hour12:!0};return new Date(k).toLocaleTimeString([],U)},M=async()=>{Le({title:"Clear Chat",message:"Do you want to delete all this conversations ?",buttons:[{label:"Yes",onClick:async()=>{console.log("clearing chat clicked"),(await(await fetch(`/user/clear_user_chat/${u}`)).json()).success&&($(),y(!1),ie("All messages deleted sucessfully...",{duration:1e3}))}},{label:"No",onClick:()=>{y(!1)}}]})},Q=k=>{l({...w,text:k.target.value})},V=20*1024*1024,z=async k=>{if(!k||k.size===0)return ie.error("Please select an audio file"),null;if(k instanceof File&&k.size>V)return ie.error("Maximum audio file size limit is 20MB"),null;try{d(!0);const U=fe(),X=new Date().getTime()+"_"+(k instanceof File?k.name:"audio.webm"),he=Ne(U,X),ke=we(he,k);return E(!0),new Promise((Se,le)=>{ke.on("state_changed",K=>{const Pe=K.bytesTransferred/K.totalBytes*100;console.log(`Upload is ${Pe}% done`)},K=>{console.error("Error uploading audio:",K),ie.error("Failed to upload audio"),le(K)},async()=>{try{const K=await be(ke.snapshot.ref);console.log("File available at",K),Se(K)}catch(K){console.error("Error getting download URL:",K),ie.error("Failed to get audio download URL"),le(K)}})})}catch(U){return console.error("Error uploading audio:",U),ie.error("Failed to upload audio"),null}},B=async k=>{try{const U=await z(k);U&&(l({...w,text:U,type:k.type}),console.log("Audio URL:",U),r(k),console.log(k.type),i(U),d(!1))}catch(U){console.error("Error handling recording:",U)}},G=async()=>{i(""),r("text"),l({...w,text:"",type:"text"}),E(!1)},Z=k=>{const U=document.createElement("a");U.href=k||"",U.download="image.jpg",U.target="_blank",U.click()};return e.jsxs("div",{className:"pt-1 h-screen bg-gray-50 flex flex-col",children:[e.jsx(Vs,{}),e.jsxs("div",{className:"border-2 flex flex-col h-full p-4 bg-white shadow-lg",children:[e.jsxs("div",{className:"flex justify-between items-center px-5 py-3 border-b-2",children:[e.jsxs("div",{className:"flex gap-5 items-center",children:[e.jsx("img",{src:((se=t==null?void 0:t.adminId)==null?void 0:se.image)||"https://cdn-icons-png.flaticon.com/512/9385/9385289.png",className:"w-10 h-10 rounded-full",alt:"User"}),t&&e.jsx("span",{className:"text-xl font-bold",children:(re=t==null?void 0:t.adminId)==null?void 0:re.username})]}),e.jsxs("div",{className:"flex gap-5 items-center text-lg md:text-2xl text-sky-500",children:[e.jsx(Fe,{className:"cursor-pointer hover:text-sky-800",onClick:()=>D(!1)}),t.propId.allowVedioCalls&&e.jsx(Xe,{className:"cursor-pointer hover:text-sky-800",onClick:()=>D(!0)}),e.jsx(_s,{className:"cursor-pointer hover:text-sky-800 hover:bg-slate-200 rounded-full hover:text-2xl hover:p-1 md:hover:text-3xl",onClick:()=>y(!j)}),e.jsx(Pt,{className:"cursor-pointer ",onClick:I})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto py-4",children:e.jsxs("div",{className:"flex flex-col gap-4 px-5",children:[(o==null?void 0:o.length)>0&&o.map(k=>{var U,X,he;return e.jsxs("div",{className:`flex ${k.senderModel==="User"?"justify-end":"justify-start"} gap-3`,children:[k.senderModel!=="User"&&e.jsx("img",{src:(U=t==null?void 0:t.adminId)==null?void 0:U.image,alt:"Admin",className:"w-10 h-10 rounded-full"}),e.jsxs("div",{className:"flex flex-col max-w-[300px] md:max-w-[350px] lg:max-w-[650px]",children:[e.jsxs("div",{className:"flex justify-between text-xs text-slate-400",children:[e.jsx("span",{children:T(k.createdAt)}),e.jsx("span",{children:k.senderModel==="User"?e.jsx("span",{className:"text-sky-500 font-bold",children:"You"}):e.jsx("span",{className:"text-sky-500 font-bold",children:t.adminId.username})||"Admin"})]}),k.type==="text"?e.jsx("div",{className:"p-3 rounded-xl bg-sky-100 text-sm break-words",children:k.text}):e.jsx("div",{className:"p-2 rounded-xl bg-sky-100 text-sm break-words",children:k!=null&&k.type&&((X=k==null?void 0:k.type)!=null&&X.startsWith("image/"))?e.jsxs("div",{className:"relative",children:[e.jsx(Es,{onClick:()=>Z(k.text),className:"text-sky-500 hover:text-sky-800 absolute top-0 left-0 text-3xl  md:text-5xl cursor-pointer"}),e.jsx("img",{src:k.text,alt:"Shared file",className:"w-[200px] md:w-[500px]"})]}):(he=k==null?void 0:k.type)!=null&&he.startsWith("video/")?e.jsx("video",{className:"w-[200px] md:w-[500px]",controls:!0,children:e.jsx("source",{src:k.text,type:k.type})}):e.jsxs("audio",{className:"w-[200px] h-[60px] md:w-[500px] ",controls:!0,children:[e.jsx("source",{src:k.text,type:"audio/mpeg"}),"Your browser does not support the audio element."]})})]}),k.senderModel==="User"&&e.jsx("img",{src:"https://cdn-icons-png.flaticon.com/512/9385/9385289.png",alt:"User",className:"w-10 h-10 rounded-full"})]},k._id)}),e.jsx("div",{ref:s})]})}),e.jsxs("div",{className:"flex justify-between items-center px-5 py-2 bg-sky-200 rounded-lg mt-2",children:[!b&&e.jsx(Ys,{onRecordingComplete:B}),A&&e.jsx(je,{type:"bubbles",className:"text-sky-500",color:"skyBlue",width:100}),v==="text"&&e.jsx("input",{type:"text",placeholder:"Write something...",className:"flex-1 mx-3 p-2 rounded-lg border bg-sky-100 border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-500",value:w.text,onChange:Q,onKeyPress:k=>k.key==="Enter"&&F()}),e.jsxs("div",{className:"flex",children:[N&&N<100?e.jsx(je,{type:"bubbles",className:"text-sky-500",color:"skyBlue",width:100}):p&&e.jsx(e.Fragment,{children:typeof v=="string"&&v.startsWith("image/")?e.jsx("img",{src:p,alt:"Selected file",width:250}):typeof v=="string"&&v.startsWith("video/")?e.jsx("video",{src:p,width:250,height:400,controls:!0}):e.jsxs("div",{className:"flex gap-1 justify-center items-center",children:[e.jsx("audio",{className:"rounded",src:p,controls:!0}),e.jsx("div",{className:"hover:bg-sky-100 p-3 rounded-full",onClick:G,children:e.jsx(Is,{className:"text-sky-500 cursor-pointer"})})]})}),e.jsx("input",{type:"file",ref:_,name:"",id:"",onChange:O,hidden:!0}),!b&&e.jsx(Tt,{onClick:()=>{var k;return(k=_.current)==null?void 0:k.click()},className:"text-sky-500 text-2xl cursor-pointer"})]}),w&&w.text!==""&&e.jsx("div",{className:"p-2 rounded-full bg-sky-500 ml-3 cursor-pointer",onClick:F,children:e.jsx(As,{className:"text-white text-2xl"})})]}),j&&e.jsx("div",{className:"w-34 h-39 absolute bg-slate-700 opacity-70 right-24 rounded top-16 flex flex-col p-3 gap-4 md:w-40",children:e.jsxs("div",{className:"flex justify-start gap-2  rounded items-center hover:p-1 hover:bg-slate-900 cursor-pointer text-white text-sm md:text-lg",onClick:M,children:[e.jsx(Ts,{className:"text-red-600"})," ",e.jsx("span",{className:"text-sm",children:"Clear chat"})]})})]})]})},Pa=()=>{const[s,t]=a.useState([]),{currentAdmin:o}=J(m=>m.admin),[n,x]=a.useState(""),[h,c]=a.useState(""),[f,u]=a.useState(""),[j,y]=a.useState(""),[N,C]=a.useState([]),[b,E]=a.useState("");a.useEffect(()=>{r(),v()},[o,f,j]);const p=async m=>{await(await fetch(`/api/admin_delete_user_data/${m}`)).json()==="deleted"&&v()},i=m=>{ye.fire({title:"Are you sure?",text:"This users chat list and all messages will be remove",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(O=>{O.isConfirmed&&(p(m),ye.fire("Deleted!","Your file has been deleted.","success"))})},v=async()=>{try{const m=await W.get("/api/get_users_list",{params:{adminId:o._id,startDate:n,endDate:h,propertyName:f,userType:j}});m.data!=="Empty list"?t(m.data):(t([]),P("Filtered user list empty"))}catch(m){console.error("Error fetching users list:",m)}},r=async()=>{try{const O=await(await fetch(`/api/get_admin_property_data_filtering/${o._id}`)).json();C(O)}catch(m){console.log("Error fetching admin properties:",m)}},A=m=>{const O=m.target.value;new Date(O)>new Date(h)?P.error("Start date cannot be later than end date."):x(O)},d=m=>{const O=m.target.value;new Date(n)>new Date(O)?P.error("End date cannot be earlier than start date."):c(O)},w=m=>{E(m.target.value)},l=s.filter(m=>m.username.toLowerCase().includes(b.toLowerCase())),_=()=>{console.log("filtering by date"),n&&h?v():P.error("please select the dates..")};return console.log(l),e.jsx("div",{className:"p-2 h-screen",children:e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsx("h1",{className:"text-2xl font-bold p-4",children:"All Visitors"}),e.jsxs("div",{className:"flex flex-col border  p-4 rounded-lg gap-4 bg-white shadow-lg h-full",children:[e.jsxs("div",{className:"flex flex-col gap-1 xl:flex-row justify-between bg-sky-500 p-4 rounded",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 lg:gap-16 justify-center items-center px-2 lg:px-5",children:[e.jsx("div",{className:"flex relative w-full lg:w-auto",children:e.jsxs("select",{onChange:m=>{y(m.target.value),u(""),c(""),x("")},className:"py-3 px-2 bg-white lg:px-16 text-xs rounded-full cursor-pointer w-full lg:w-auto",children:[e.jsx("option",{value:"",children:"All Users"}),e.jsx("option",{value:"Unknown",children:"Unknown"}),e.jsx("option",{value:"Unverified",children:"Unverified"}),e.jsx("option",{value:"Verified",children:"Verified"})]})}),e.jsx("div",{className:"flex relative w-full lg:w-auto mt-4 lg:mt-0",children:e.jsxs("select",{onChange:m=>{u(m.target.value),y(""),c(""),x("")},className:"py-3  px-2 bg-white lg:px-5 text-xs rounded-full cursor-pointer w-full lg:w-auto",children:[e.jsx("option",{value:"All",children:"All Properties"}),N&&N.map(m=>e.jsxs("option",{className:`${m.deleted?"text-red-500":"font-bold text-green-500"}`,value:m._id,children:[m.propertyName," ",m.deleted?" - (Deleted)":" -  (Active)"]},m._id))]})})]}),e.jsx("div",{className:"flex flex-col lg:flex-row gap-4 mt-4 lg:mt-0 bg-sky-300 rounded p-3 w-full lg:w-auto",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center space-y-2 sm:space-y-0 sm:space-x-4 w-full",children:[e.jsxs("div",{className:"flex items-center space-x-2 w-full lg:w-auto",children:[e.jsx("label",{htmlFor:"start-date",className:"text-xs",children:"Start Date:"}),e.jsx("input",{type:"date",id:"start-date",name:"start-date",value:n,onChange:A,className:"py-2 px-2 rounded-full border border-gray-300 cursor-pointer w-full lg:w-auto"})]}),e.jsx("div",{className:"flex-col md:flex-row items-center space-x-2 w-full lg:w-auto mt-4 sm:mt-0",children:e.jsxs("div",{className:"flex items-center space-x-2 w-full lg:w-auto",children:[e.jsx("label",{htmlFor:"end-date",className:"text-xs",children:"End Date:"}),e.jsx("input",{type:"date",id:"end-date",name:"end-date",value:h,onChange:d,className:"py-2 px-2 rounded-full border border-gray-300 cursor-pointer w-full lg:w-auto"})]})}),e.jsx("button",{className:"bg-white text-xs p-3 rounded-full font-semibold hover:bg-sky-200 w-full lg:w-auto mt-4 sm:mt-0",onClick:_,children:"Apply"})]})})]}),e.jsxs("div",{className:"flex items-center border p-2 px-5 rounded-lg bg-gray-100 shadow-sm",children:[e.jsx("input",{type:"text",className:"flex-grow border-none focus:outline-none px-5 bg-transparent",placeholder:"Search...",value:b,onChange:w}),e.jsx(vs,{className:"text-gray-500"})]}),e.jsx("div",{className:"flex flex-col gap-4 overflow-y-auto flex-grow mt-4",children:l&&l.map(m=>{var O,H,D;return e.jsxs("div",{className:"flex flex-col border p-4 rounded-lg gap-4 shadow-sm bg-gray-50",children:[e.jsxs("div",{className:"flex justify-between items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-4 px-5 py-2 bg-white border rounded-lg shadow-sm flex-grow",children:[e.jsx("h3",{className:"text:xs md:text-lg font-semibold",children:"Visited on"}),e.jsxs("span",{className:"text:xs md:text-lg",children:[new Date(m==null?void 0:m.createdAt).toLocaleDateString()," ---"," ",new Date(m==null?void 0:m.createdAt).toLocaleTimeString()]})]}),e.jsx(Y,{to:`/admin_chat?conId=${m==null?void 0:m.conversationId}`,children:e.jsxs("button",{className:"flex items-center gap-1 text-white bg-sky-500 px-4 py-2 rounded-lg shadow-sm w-24 justify-center",children:[e.jsx(Ut,{}),"Chats"]})})]}),e.jsxs("div",{className:"flex justify-between items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-4 px-5 py-2 bg-white border rounded-lg shadow-sm flex-grow",children:[e.jsx("h3",{className:"font-semibold text:xs md:text-lg",children:"Name"}),e.jsx("span",{className:"text:xs md:text-lg",children:m==null?void 0:m.username})]}),e.jsxs("button",{onClick:()=>i(m._id),className:"flex items-center gap-1 text-white bg-red-500 px-4 py-2 rounded-lg shadow-sm w-24 justify-center",children:[e.jsx(bs,{}),"Delete"]})]}),e.jsxs("div",{className:"flex justify-between items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-4 px-5 py-2 bg-white border rounded-lg shadow-sm flex-grow",children:[e.jsx("h3",{className:"font-semibold text:xs md:text-lg",children:"Purpose"}),e.jsx("span",{className:"text:xs md:text-lg",children:(m==null?void 0:m.purpose)!=="Unknown contact"?m==null?void 0:m.purpose:"Visited by an unknown user"})]}),((O=m==null?void 0:m.propId)==null?void 0:O.userType)!=="Unknown"&&e.jsxs("a",{className:"flex items-center gap-1 text-white text-xs bg-green-500 px-4 py-3 rounded-lg shadow-sm w-24 justify-center",target:"_blank",href:`https://wa.me/${m==null?void 0:m.phone}`,rel:"noopener noreferrer",children:[e.jsx(Ps,{className:"text-white"}),"Message"]})]}),((H=m==null?void 0:m.propId)==null?void 0:H.userType)!=="Unknown"&&e.jsxs("div",{className:"flex justify-between items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-4 px-5 py-2 bg-white border rounded-lg shadow-sm flex-grow",children:[e.jsx("h3",{className:"font-semibold text:xs md:text-lg",children:"Phone"}),e.jsx("span",{className:"text:xs md:text-lg",children:m==null?void 0:m.phone})]}),e.jsxs("a",{href:`tel:${m==null?void 0:m.phone}`,className:"flex items-center gap-1 text-white bg-sky-500 px-4 py-2 rounded-lg shadow-sm w-24 justify-center",children:[e.jsx(Ot,{}),"Call"]})]}),e.jsx("div",{className:"flex justify-between items-center gap-2",children:e.jsxs("div",{className:"flex items-center gap-4 px-5 py-2 bg-white border rounded-lg shadow-sm flex-grow",children:[e.jsx("h3",{className:"font-semibold text:xs md:text-lg",children:"Property"}),e.jsx("span",{className:"text:xs md:text-lg",children:(D=m==null?void 0:m.propId)==null?void 0:D.propertyName})]})})]},m==null?void 0:m._id)})})]})]})})},Ta=()=>{const[s,t]=a.useState(!0);return e.jsxs("div",{className:"flex w-screen",children:[e.jsx(ue,{navShowSet:t}),e.jsx("div",{className:`transition-all duration-300 ${s?"w-[250px]":"w-[60px]"}`}),e.jsx("div",{className:"flex-1",children:e.jsx(Pa,{})})]})},Ua=()=>{const{currentAdmin:s}=J(f=>f.admin),[t,o]=a.useState([]),n=async()=>{try{const f=await W.get(`/api/get_admin_property_data/${s._id}`);if(f.status===200){const u=f.data;o(u)}}catch(f){console.error("Error fetching property data",f)}};a.useEffect(()=>{n()},[s._id]);const x=async f=>{try{const u=await W.get(`/api/delete_property/${f}`);console.log(u.data),u.data.success&&n()}catch(u){console.log(u)}},h=f=>{const u=document.createElement("a");u.href=f||"",u.download="qr_code.png",u.click()},c=f=>{ye.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(u=>{u.isConfirmed&&(x(f),ye.fire("Deleted!","Your file has been deleted.","success"))})};return e.jsxs("div",{className:"relative p-1",children:[e.jsx("div",{className:"absolute z-0 rounded-2xl -top-56 left-1/2 transform -translate-x-1/2 bg-zinc-300 w-60 h-40 lg:h-96 rotate-45"}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("h1",{className:"text-start text-xl font-bold mt-14 ml-2 md:text-3xl",children:"Your available QR Codes"}),e.jsx("div",{className:"flex justify-end mb-4",children:e.jsx(Y,{to:"/generate_qr",children:e.jsx("button",{className:"bg-sky-500 text-white text-xs px-2 py-1 gap-1 rounded hover:bg-sky-600 lg:text-lg lg:py-2 lg:px-4 lg:gap-2 flex items-center",children:"GENERATE NEW CODE"})})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full rounded shadow",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"flex gap-2 justify-center items-center bg-zinc-300 text-xs font-bold lg:text-lg px-1 py-2 rounded lg:gap-16",children:[e.jsx("th",{className:"flex-1 text-left",children:"QR CODE"}),e.jsx("th",{className:"flex-1 text-left",children:"DOWNLOAD"}),e.jsx("th",{className:"flex-1 text-left",children:"VIDEO CALL"}),e.jsx("th",{className:"flex-1 text-left",children:"PROPERTY NAME"}),e.jsx("th",{className:"flex-1 text-left",children:"PROPERTY ADDRESS"}),e.jsx("th",{className:"flex-1 text-left",children:"DELETE"})]})}),e.jsx("tbody",{className:"text-white flex flex-col",children:t.length>0?t.map(f=>e.jsxs(e.Fragment,{children:[e.jsxs("tr",{className:"flex gap-5 justify-center items-center mt-5 bg-sky-500 text-xs lg:text-lg px-2 py-2 rounded lg:gap-x-28",children:[e.jsx("td",{className:"flex-1 text-left",children:e.jsx("img",{src:f.code,alt:"QR",className:"w-10 h-10 lg:w-16 lg:h-16"})}),e.jsx("td",{className:"flex-1 text-left cursor-pointer",children:e.jsx(Rt,{onClick:()=>h(f.code),className:"text-2xl hover:text-sky-800"})}),e.jsx("td",{className:"flex-1 text-left text-green-200",children:f.allowVedioCalls?"ALLOWED":"NOT ALLOWED"}),e.jsx("td",{className:"flex-1 text-left",children:f.propertyName}),e.jsx("td",{className:"flex-1 text-left",children:e.jsx("p",{children:f.propertyAddress})}),e.jsx("td",{className:"flex-1 text-left",children:e.jsx("button",{onClick:()=>c(f._id),className:"bg-red-500 text-white text-xs cursor-pointer rounded hover:bg-red-700 lg:text-sm lg:py-1 lg:px-2",children:"delete"})})]},f._id),e.jsxs("div",{className:"flex text-slate-600 bg-sky-400 justify-between py-1 px-8 font-bold",children:[e.jsx("h2",{children:"Scanned count :- "}),e.jsx("h2",{children:f==null?void 0:f.scannedCount})]})]})):e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"text-center",children:"No Property data available"})})})]})})]})]})},Oa=()=>{const[s,t]=a.useState(!0);return e.jsxs("div",{className:"flex w-screen",children:[e.jsx(ue,{navShowSet:t}),e.jsx("div",{className:`transition-all duration-300 ${s?"w-[250px]":"w-[60px]"}`}),e.jsx("div",{className:"flex-1",children:e.jsx(Ua,{})})]})},Ra={currentSuperAdmin:null,error:null,loading:!1,messages:[]},Qs=ze({name:"superAdmin",initialState:Ra,reducers:{signInSuccess:(s,t)=>{s.currentSuperAdmin=t.payload,s.loading=!1,s.error=null},setMessages:(s,t)=>{s.messages=Array.isArray(t.payload)?t.payload:[]},signoutSuccess:s=>{s.currentSuperAdmin=null,s.error=null,s.loading=!1,s.messages=[]}}}),{signInSuccess:$a,setMessages:dl,signoutSuccess:Va}=Qs.actions,La=Qs.reducer,Da=()=>{const[s,t]=a.useState(""),[o,n]=a.useState(""),[x,h]=a.useState(!0),[c,f]=a.useState(!0),[u,j]=a.useState(""),[y,N]=a.useState(!1),{currentSuperAdmin:C}=J(w=>w.superAdmin),[b,E]=a.useState([]),p=me(),i=ae(),v=async()=>{try{const w=await W.get("/superAdmin/get_posters");E(w.data)}catch(w){console.log(w),P("Failed to fetch posters.")}},r=w=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(w),A=w=>w.length>=8;a.useEffect(()=>{v(),h(r(s)),f(A(o)),C&&i("/super_admin_dashboard")},[s,o]);const d=async()=>{if(!x||!c){j("Please enter valid email and password.");return}const w=await W.post("/superAdmin/super_admin_login",{email:s,password:o});w.data!=="Invalid"?(p($a(w.data)),P("Logged in sucessfully"),i("/super_admin_dashboard")):P("Error logging in")};return e.jsxs("div",{className:"flex justify-center h-screen w-full",children:[e.jsx("div",{className:"hidden sm:flex sm:flex-1 sm:h-full",children:e.jsx("img",{src:b.length>0?b[9].imageUrl:"https://firebasestorage.googleapis.com/v0/b/elite-mediator.appspot.com/o/login.jpg?alt=media&token=23fd7400-7426-40c8-87c3-dc4c1eabc8c9",alt:"Dummy",className:"h-full object-cover w-full"})}),e.jsx("div",{className:"w-full lg:flex-1 h-full bg-sky-100 p-5",children:e.jsxs("div",{className:"bg-white h-full flex flex-col justify-center items-center",children:[e.jsx("h1",{className:"text-2xl lg:text-3xl",children:"Login (Super Admin)"}),e.jsxs("div",{className:"flex flex-col pt-5",children:[e.jsxs("div",{className:"flex justify-between px-5 py-1",children:[e.jsx("span",{className:"text-xs text-zinc-500",children:"Email"}),e.jsxs("div",{className:"flex justify-between gap-1",children:[s&&(x?e.jsx(L,{className:"text-green-600 text-xs"}):e.jsx(Ee,{className:"text-red-600 text-xs"})),e.jsx("span",{className:`text-xs text-center ${x?"text-green-500":"text-red-500"}`,children:s.length>0&&(x?"Valid":"Invalid")})]})]}),e.jsx("input",{type:"text",className:`w-[300px] border rounded py-1 px-5 ${x?"":"border-red-500"}`,placeholder:"Enter your email",value:s,onChange:w=>t(w.target.value)})]}),e.jsxs("div",{className:"flex flex-col pt-5",children:[e.jsxs("div",{className:"flex justify-between px-5 py-1",children:[e.jsx("span",{className:"text-xs text-zinc-500",children:"Password"}),e.jsxs("div",{className:"flex justify-between gap-1",children:[o&&(c?e.jsx(L,{className:"text-green-600 text-xs"}):e.jsx(Ee,{className:"text-red-600 text-xs"})),e.jsx("span",{className:`text-xs text-center ${c?"text-green-500":"text-red-500"}`,children:o.length>0&&(c?"Valid":"Invalid")})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:y?"text":"password",className:`w-[300px] border rounded py-1 px-5 ${c?"":"border-red-500"}`,placeholder:"Enter your password",value:o,onChange:w=>n(w.target.value)}),y?e.jsx(Be,{className:"absolute top-2 right-3 cursor-pointer",onClick:()=>N(!1)}):e.jsx(We,{className:"absolute top-2 right-3 cursor-pointer",onClick:()=>N(!0)})]})]}),u&&e.jsx("div",{className:"text-red-500 text-sm mt-2",children:u}),e.jsx("div",{className:"w-[300px] mt-6",children:e.jsx("button",{onClick:d,className:"bg-sky-500 w-full rounded py-1 px-5 text-white hover:bg-sky-600",children:"Login"})})]})})]})},Me=({navShowSet:s})=>{const[t,o]=a.useState(!0),n=me();a.useEffect(()=>{s(t)},[s,t]),a.useEffect(()=>{const h=()=>{o(window.innerWidth>=768)};return h(),window.addEventListener("resize",h),()=>{window.removeEventListener("resize",h)}},[]);const x=()=>{n(Va())};return e.jsxs("div",{className:"fixed z-20",children:[e.jsxs("div",{className:`flex p-1 gap-1 transition-all duration-300 ${t?"bg-sky-50 w-[250px]":"w-[60px]"}`,children:[e.jsx("img",{className:" rounded bg-sky-500 font-sans w-14 text-center",src:"https://firebasestorage.googleapis.com/v0/b/elite-mediator.appspot.com/o/logo.png?alt=media&token=d632f87d-5330-4f8d-bf5c-67780c74798d",alt:""}),e.jsx("span",{className:`flex justify-center items-center text-2xl transition-all duration-300 whitespace-nowrap ${t?"opacity-100":"opacity-0"}`,children:"ELITE MEDIATOR"})]}),e.jsxs("div",{className:`transition-all duration-300 ${t?"h-screen w-[250px] bg-sky-50":"h-screen w-[60px] bg-sky-50"}`,children:[e.jsx("span",{className:"hidden md:flex justify-center items-center bg-sky-500 rounded-full w-7 h-7 absolute -right-2 cursor-pointer",onClick:()=>o(!t),children:t?e.jsx(us,{className:"text-3xl"}):e.jsx($t,{className:"text-xs"})}),e.jsx("br",{}),e.jsx("br",{}),e.jsxs("div",{className:`  transition-all duration-300 ${t?"h-screen w-[250px] bg-sky-50":"h-screen w-[60px] bg-sky-50"} flex flex-col gap-10 relative`,children:[e.jsxs(Y,{to:"/super_admin_dashboard",className:`flex gap-5 self-start ${location.pathname==="/super_admin_dashboard"?"text-black":"text-sky-500"} px-5 hover:text-black cursor-pointer items-center text-xl`,children:[e.jsx("span",{children:e.jsx(hs,{})}),e.jsx("span",{className:`text-sm transition-opacity duration-300 ${t?"opacity-100":"opacity-0 hidden"}`,children:"DASHBOARD"})]}),e.jsxs(Y,{to:"/super_admin_registered_admin_list",className:`flex gap-5 self-start ${location.pathname==="/super_admin_registered_admin_list"?"text-black":"text-sky-500"} px-5 hover:text-black cursor-pointer items-center text-xl`,children:[e.jsx("span",{children:e.jsx(Vt,{})}),e.jsx("span",{className:`text-sm transition-opacity duration-300 ${t?"opacity-100":"opacity-0 hidden"}`,children:"ALL USERS"})]}),e.jsxs(Y,{to:"/super_admin_poster_page",className:`flex gap-5 self-start ${location.pathname==="/super_admin_poster_page"?"text-black":"text-sky-500"} px-5 hover:text-black cursor-pointer items-center text-xl`,children:[e.jsx("span",{children:e.jsx(Lt,{})}),e.jsx("span",{className:`text-sm transition-opacity duration-300 ${t?"opacity-100":"opacity-0 hidden"}`,children:"POSTERS"})]}),e.jsxs("div",{onClick:x,className:`flex gap-5 self-start ${location.pathname==="/super_admin"?"text-black":"text-sky-500"} px-5 hover:text-black cursor-pointer items-center text-xl`,children:[e.jsx("span",{children:e.jsx(Dt,{})}),e.jsxs("span",{className:`text-sm transition-opacity duration-300 ${t?"opacity-100":"opacity-0 hidden"}`,children:["LOGOUT"," "]})]})]})]})]})};Ge.register(He,Qe,Mt,Je,Ke,Ze);const Ma=()=>{const[s,t]=a.useState(),o=async()=>{const h=await W.get("/superAdmin/admin_generated_qrcodes");t(h.data)};a.useEffect(()=>{o()},[]);const n={labels:["Total QrCode's","Verified QrCode's","Unverified QrCode's","Unknown QrCode's"],datasets:[{label:"Generated Qr Code's Statistics",data:[s==null?void 0:s.All,s==null?void 0:s.verified,s==null?void 0:s.unverified,s==null?void 0:s.unknown],borderColor:"rgb(14 165 233)",backgroundColor:"rgba(75, 192, 192, 0.2)",fill:!1}]},x={responsive:!0,scales:{x:{beginAtZero:!0}},plugins:{legend:{display:!0,position:"top"},title:{display:!0,text:"User Statistics Chart"}}};return e.jsx("div",{className:"p-6 w-[500px] relative z-20 md:w-[900px]  mx-auto lg:w-[1200px]",children:e.jsx(Ft,{className:"w-full",data:n,options:x})})};Ge.register(He,Qe,ys,Ns,Je,Ke,Ze);const Fa=()=>{const[s,t]=a.useState(),o=async()=>{try{const h=await W.get("/superAdmin/admin_and_visitors_count");t(h.data),console.log(h.data)}catch(h){console.log(h)}};a.useEffect(()=>{o()});const n={labels:["Registered Admins","All Users","Verified Users","Unverified Users","Unknown Users"],datasets:[{label:"User Statistics",data:[s==null?void 0:s.Admins,s==null?void 0:s.AllVisitors,s==null?void 0:s.VerifiedVisitors,s==null?void 0:s.UnverifiedVisitors,s==null?void 0:s.UnknownVisitors],borderColor:"rgb(14 165 233)",backgroundColor:"rgba(75, 192, 192, 0.2)",fill:!1,tension:.1}]},x={responsive:!0,scales:{x:{beginAtZero:!0}},plugins:{legend:{display:!0,position:"top"},title:{display:!0,text:"User Statistics Chart"}}};return e.jsx("div",{className:"p-6 w-[500px] relative z-20 md:w-[900px]  mx-auto lg:w-[1200px]",children:e.jsx(ws,{className:"w-full",data:n,options:x})})},za=()=>{const[s,t]=a.useState(),[o,n]=a.useState(""),x=async()=>{try{const c=await W.get("/superAdmin/get_all_admins_data");console.log(c),t(c.data)}catch(c){console.log(c)}},h=s==null?void 0:s.filter(c=>c.username.toLowerCase().includes(o==null?void 0:o.toLocaleLowerCase()));return a.useEffect(()=>{x()},[]),console.log(s),e.jsxs("div",{className:"container mx-auto",children:[e.jsx("div",{className:"absolute z-0 rounded-2xl -top-14 sm:ml-30 md:ml-28 lg:left-20 transform translate-x-1/2 -translate-y-1/2 bg-zinc-300 w-40 h-40 lg:w-72 lg:h-72 rotate-45"}),e.jsxs("div",{className:"flex  mt-16 pl-8 flex-col w-full relative",children:[e.jsx("div",{className:"bg-white",children:e.jsx(Fa,{})}),e.jsx("div",{className:"flex",children:e.jsx(Ma,{})}),e.jsx("div",{className:"flex justify-center rounded",children:e.jsxs("div",{className:"flex flex-col border-2 rounded w-[400px] mx-6 md:mx-12 md:w-full ",children:[e.jsx("div",{className:"flex justify-center bg-sky-500",children:e.jsx("h1",{className:"text-white p-3",children:"RECENT REGISTERED ADMINS"})}),e.jsx("div",{className:"flex justify-start px-5 h-10 md:h-14",children:e.jsxs("div",{className:"flex rounded justify-between items-center mt-2 border-2 h-8 p-2 md:w-[900px] md:h-12",children:[e.jsx("input",{type:"text",className:"mx-4 w-full h-full",onChange:c=>n(c.target.value),placeholder:"Search..."}),e.jsx(Ls,{className:"cursor-pointer mr-1 rounded text-zinc-500 md:text-2xl"})]})}),e.jsxs("table",{className:"w-full text-left p-5 mt-4 text-xs md:text-sm lg:text-lg ",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-2 border-b",children:"ID"}),e.jsx("th",{className:"p-2 border-b",children:"NAME"}),e.jsx("th",{className:"p-2 border-b",children:"EMAIL"}),e.jsx("th",{className:"p-2 border-b",children:"DETAILS"})]})}),e.jsx("tbody",{children:h&&h.length>0?h.map(c=>{var f;return e.jsxs("tr",{children:[e.jsxs("td",{className:"p-2 border-b",children:["#",(f=c==null?void 0:c._id)==null?void 0:f.substring(0,5)]}),e.jsx("td",{className:"p-2 border-b",children:c==null?void 0:c.username}),e.jsx("td",{className:"p-2 border-b",children:c==null?void 0:c.email}),e.jsx("td",{className:"p-2 border-b hover:text-sky-500 cursor-pointer",children:e.jsx(Y,{to:`/super_admin_registered_admin_profile?adminId=${c._id}`,children:e.jsx(Ds,{className:"text-lg md:text-2xl "})})})]},c==null?void 0:c._id)}):e.jsx("div",{className:"flex justify-center text-4xl p-6 font-bold",children:"No Data available"})})]})]})})]})]})},Ba=()=>{const[s,t]=a.useState(!0);return e.jsxs("div",{className:"flex w-screen",children:[e.jsx(Me,{navShowSet:t}),e.jsx("div",{className:`transition-all duration-300 ${s?"w-[250px]":"w-[60px]"}`}),e.jsx("div",{className:"flex-1",children:e.jsx(za,{})})]})},Wa=()=>{const[s,t]=a.useState(),[o,n]=a.useState(""),x=async()=>{try{const c=await W.get("/superAdmin/get_all_admins_data");console.log(c),t(c.data)}catch(c){console.log(c)}},h=s==null?void 0:s.filter(c=>c.username.toLowerCase().includes(o==null?void 0:o.toLocaleLowerCase()));return a.useEffect(()=>{x()},[]),console.log(s),e.jsxs("div",{className:"container mx-auto",children:[e.jsx("div",{className:"absolute z-0 rounded-2xl -top-14 sm:ml-30 md:ml-28 lg:left-20 transform translate-x-1/2 -translate-y-1/2 bg-zinc-300 w-40 h-40 lg:w-72 lg:h-72 rotate-45"}),e.jsxs("div",{className:"flex flex-col gap-5 p-6 mt-5 relative z-10",children:[e.jsx("h1",{className:"text-2xl font-bold text-center",children:"All Admins"}),e.jsx("div",{className:"relative z-30",children:e.jsxs("div",{className:"flex flex-col border-2 shadow-lg rounded-lg bg-white",children:[e.jsxs("div",{className:"flex gap-1 justify-between items-center bg-sky-500 p-4 rounded-t-lg",children:[e.jsx("div",{className:"cursor-pointer px-1 text-white hover:text-black",children:"(All)"}),e.jsxs("div",{className:"flex justify-between gap-2 items-center",children:[e.jsx("div",{className:"flex bg-sky-100 p-1 rounded-full md:px-5",children:e.jsx("input",{type:"date",className:"bg-sky-100 rounded-full outline-none"})}),e.jsx("div",{className:"flex bg-sky-100 p-1 rounded-full md:px-5",children:e.jsx("input",{type:"date",className:"bg-sky-100 rounded-full outline-none"})}),e.jsx("div",{className:"flex",children:e.jsx("button",{className:"text-white hover:text-black hover:bg-white hover:rounded-full hover:p-1 transition duration-300",children:"Apply"})})]})]}),e.jsx("div",{className:"flex my-2 px-5",children:e.jsxs("div",{className:"flex rounded justify-between items-center mt-2 border-2 p-2 w-full shadow-md",children:[e.jsx("input",{type:"text",className:"mx-4 w-full h-full outline-none",onChange:c=>n(c.target.value),placeholder:"Search..."}),e.jsx(Ls,{className:"cursor-pointer mr-1 rounded text-zinc-500 md:text-2xl"})]})}),e.jsxs("div",{className:"flex flex-col justify-between h-[450px] border-2 rounded-b-lg overflow-hidden shadow-lg",children:[e.jsxs("table",{className:"w-full text-left p-5 mt-4 text-xs md:text-sm lg:text-lg",children:[e.jsx("thead",{className:"bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-2 border-b",children:"ID"}),e.jsx("th",{className:"p-2 border-b",children:"NAME"}),e.jsx("th",{className:"p-2 border-b",children:"EMAIL"}),e.jsx("th",{className:"p-2 border-b",children:"PHONE"}),e.jsx("th",{className:"p-2 border-b",children:"DETAILS"})]})}),e.jsx("tbody",{children:h&&h.length>0?h.map(c=>{var f;return e.jsxs("tr",{className:"even:bg-gray-50",children:[e.jsxs("td",{className:"p-2 border-b",children:["#",(f=c._id)==null?void 0:f.substring(0,6)]}),e.jsx("td",{className:"p-2 border-b",children:c.username}),e.jsx("td",{className:"p-2 border-b",children:c.email}),e.jsx("td",{className:"p-2 border-b",children:c.phone}),e.jsx("td",{className:"p-2 border-b hover:text-sky-500 cursor-pointer",children:e.jsx(Y,{to:`/super_admin_registered_admin_profile?adminId=${c._id}`,children:e.jsx(Ds,{className:"text-lg md:text-2xl"})})})]},c._id)}):e.jsx("div",{className:"flex justify-center text-4xl p-6 font-bold",children:"No Data available"})})]}),e.jsxs("div",{className:"flex justify-between items-center p-4 bg-gray-50",children:[e.jsx("button",{className:"p-2 bg-sky-500 text-white rounded hover:bg-sky-600 transition duration-300",children:e.jsx(ks,{})}),e.jsxs("span",{children:["Page ",1," of ",1]}),e.jsx("button",{className:"p-2 bg-sky-500 text-white rounded hover:bg-sky-600 transition duration-300",children:e.jsx(Ss,{})})]})]})]})})]})]})},qa=()=>{const[s,t]=a.useState(!0);return e.jsxs("div",{className:"flex w-screen",children:[e.jsx(Me,{navShowSet:t}),e.jsx("div",{className:`transition-all duration-300 ${s?"w-[250px]":"w-[60px]"}`}),e.jsx("div",{className:"flex-1",children:e.jsx(Wa,{})})]})},Ya=()=>{const s=ve(),o=new URLSearchParams(s.search).get("adminId"),[n,x]=a.useState(),[h,c]=a.useState("All"),[f,u]=a.useState(),j=async()=>{try{const i=await W.get(`/superAdmin/get_admin_profile/${o}`);x(i.data)}catch(i){console.log(i)}},y=async()=>{try{const i=await W.post("/superAdmin/get_admin_visitors",{adminId:o,userType:h});console.log(i),u(i.data)}catch(i){console.error("Error fetching admin visitors:",i)}},N=i=>{const v={year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!0};return new Date(i).toLocaleString([],v)},C=async i=>{(await W.get(`/superAdmin/unblock_an_admin/${i}`)).data.unblocked?(P("Admin was sucessfully unblocked"),j()):P("failed unblocking admin")},b=i=>{ye.fire({title:"Are you sure?",text:"Do you want to block this Admin from accesing his account ?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(v=>{v.isConfirmed&&E(i)})},E=async i=>{(await W.get(`/superAdmin/block_an_admin/${i}`)).data.blocked?(ye.fire("Admin was sucessfully blocked.."),j()):P("Failed blocking the admin")},p=i=>{ye.fire({title:"Are you sure?",text:"Do you want to block this Admin from accesing his account ?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(v=>{v.isConfirmed&&C(i)})};return a.useEffect(()=>{j(),y()},[h]),console.log(h),console.log(o),console.log(f),e.jsxs("div",{className:"container mx-auto",children:[e.jsx("div",{className:"absolute z-0 rounded-2xl -top-14 sm:ml-30 md:ml-28 lg:left-20 transform translate-x-1/2 -translate-y-1/2 bg-zinc-300 w-40 h-40 lg:w-72 lg:h-72 rotate-45"}),e.jsxs("div",{className:"flex flex-col  p-3 ",children:[e.jsx("h1",{className:"p-5 text-3xl relative z-10 font-bold",children:"Profile Info"}),e.jsxs("div",{className:"flex flex-col border-2 rounded relative z-30",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center px-28 py-3",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("img",{src:n==null?void 0:n.image,className:"w-32 md:w-50 rounded ",alt:""})}),e.jsx("div",{className:"flex justify-end w-15 h-8 md:w-20 m-2",children:n&&n.blocked?e.jsx("button",{onClick:()=>p(n==null?void 0:n._id),className:"p-1 bg-red-500 w-full rounded text-white hover:bg-red-900 ",children:"Unblock"}):e.jsx("button",{onClick:()=>b(n==null?void 0:n._id),className:"p-1 bg-red-500 w-full rounded text-white hover:bg-red-900 ",children:"Block"})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-10",children:[e.jsxs("div",{className:"flex flex-col w-[350px] mx-auto",children:[e.jsxs("div",{className:"flex justify-between px-5",children:[e.jsx("span",{className:"text-zinc-500",children:"Name"}),e.jsxs("div",{className:"flex justify-center items-center gap-1",children:[e.jsx(L,{className:"text-green-600 text-sm"}),e.jsx("span",{className:" text-green-600",children:"Valid"})]})]}),e.jsxs("div",{className:"flex relative mx-auto w-full",children:[e.jsx(de,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-lg md:text-xl"}),e.jsx("input",{disabled:!0,type:"text",className:"border-2 w-full rounded-md   placeholder-text-black placeholder-gray-900 py-2 px-4 md:py-3 md:px-5",placeholder:n==null?void 0:n.username})]})]}),e.jsxs("div",{className:"flex flex-col w-[350px] mx-auto",children:[e.jsxs("div",{className:"flex justify-between px-5",children:[e.jsx("span",{className:"text-zinc-500",children:"Email"}),e.jsxs("div",{className:"flex justify-center items-center gap-1",children:[e.jsx(L,{className:"text-green-600 text-sm"}),e.jsx("span",{className:" text-green-600",children:"Valid"})]})]}),e.jsxs("div",{className:"flex relative mx-auto w-full",children:[e.jsx(de,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-lg md:text-xl"}),e.jsx("input",{disabled:!0,type:"text",className:"border-2 w-full rounded-md   placeholder-text-black placeholder-gray-900 py-2 px-4 md:py-3 md:px-5",placeholder:n==null?void 0:n.email})]})]}),e.jsxs("div",{className:"flex flex-col w-[350px] mx-auto",children:[e.jsxs("div",{className:"flex justify-between px-5",children:[e.jsx("span",{className:"text-zinc-500",children:"Address"}),e.jsxs("div",{className:"flex justify-center items-center gap-1",children:[e.jsx(L,{className:"text-green-600 text-sm"}),e.jsx("span",{className:" text-green-600",children:"Valid"})]})]}),e.jsxs("div",{className:"flex relative mx-auto w-full",children:[e.jsx(de,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-lg md:text-xl"}),e.jsx("input",{disabled:!0,type:"text",className:"border-2 w-full rounded-md   placeholder-text-black placeholder-gray-900 py-2 px-4 md:py-3 md:px-5",placeholder:n&&(n==null?void 0:n.address)})]})]}),e.jsxs("div",{className:"flex flex-col w-[350px] mx-auto",children:[e.jsxs("div",{className:"flex justify-between px-5",children:[e.jsx("span",{className:"text-zinc-500",children:"Phone"}),e.jsxs("div",{className:"flex justify-center items-center gap-1",children:[e.jsx(L,{className:"text-green-600 text-sm"}),e.jsx("span",{className:" text-green-600",children:"Valid"})]})]}),e.jsxs("div",{className:"flex relative mx-auto w-full",children:[e.jsx(de,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-lg md:text-xl"}),e.jsx("input",{disabled:!0,type:"text",className:"border-2 w-full rounded-md   placeholder-text-black placeholder-gray-900 py-2 px-4 md:py-3 md:px-5",placeholder:`${n==null?void 0:n.phone}`})]})]}),e.jsxs("div",{className:"flex flex-col w-[350px] mx-auto",children:[e.jsxs("div",{className:"flex justify-between px-5",children:[e.jsx("span",{className:"text-zinc-500",children:"State"}),e.jsxs("div",{className:"flex justify-center items-center gap-1",children:[e.jsx(L,{className:"text-green-600 text-sm"}),e.jsx("span",{className:" text-green-600",children:"Valid"})]})]}),e.jsxs("div",{className:"flex relative mx-auto w-full",children:[e.jsx(de,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-lg md:text-xl"}),e.jsx("input",{disabled:!0,type:"text",className:"border-2 w-full rounded-md   placeholder-text-black placeholder-gray-900 py-2 px-4 md:py-3 md:px-5",placeholder:n==null?void 0:n.state})]})]}),e.jsxs("div",{className:"flex flex-col w-[350px] mx-auto",children:[e.jsxs("div",{className:"flex justify-between px-5",children:[e.jsx("span",{className:"text-zinc-500",children:"City"}),e.jsxs("div",{className:"flex justify-center items-center gap-1",children:[e.jsx(L,{className:"text-green-600 text-sm"}),e.jsx("span",{className:" text-green-600",children:"Valid"})]})]}),e.jsxs("div",{className:"flex relative mx-auto w-full",children:[e.jsx(de,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-lg md:text-xl"}),e.jsx("input",{disabled:!0,type:"text",className:"border-2 w-full rounded-md   placeholder-text-black placeholder-gray-900 py-2 px-4 md:py-3 md:px-5",placeholder:n==null?void 0:n.city})]})]}),e.jsxs("div",{className:"flex flex-col w-[350px] mx-auto",children:[e.jsxs("div",{className:"flex justify-between px-5",children:[e.jsx("span",{className:"text-zinc-500",children:"Landmark"}),e.jsxs("div",{className:"flex justify-center items-center gap-1",children:[e.jsx(L,{className:"text-green-600 text-sm"}),e.jsx("span",{className:" text-green-600",children:"Valid"})]})]}),e.jsxs("div",{className:"flex relative mx-auto w-full",children:[e.jsx(de,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-lg md:text-xl"}),e.jsx("input",{disabled:!0,type:"text",className:"border-2 w-full rounded-md   placeholder-text-black placeholder-gray-900 py-2 px-4 md:py-3 md:px-5",placeholder:n==null?void 0:n.landmark})]})]}),e.jsxs("div",{className:"flex flex-col w-[350px] mx-auto",children:[e.jsxs("div",{className:"flex justify-between px-5",children:[e.jsx("span",{className:"text-zinc-500",children:"Pincode"}),e.jsxs("div",{className:"flex justify-center items-center gap-1",children:[e.jsx(L,{className:"text-green-600 text-sm"}),e.jsx("span",{className:" text-green-600",children:"Valid"})]})]}),e.jsxs("div",{className:"flex relative mx-auto w-full",children:[e.jsx(de,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-lg md:text-xl"}),e.jsx("input",{disabled:!0,type:"text",className:"border-2 w-full rounded-md   placeholder-text-black placeholder-gray-900 py-2 px-4 md:py-3 md:px-5",placeholder:n==null?void 0:n.pincode})]})]})]}),e.jsxs("div",{className:"flex flex-col p-5  px-5",children:[e.jsxs("div",{className:"flex justify-between border-2 rounded py-5 px-20",children:[e.jsx("h1",{className:"rounded-full py-1 font-bold text-lg md:text-xl",children:"All Visitors"}),e.jsxs("select",{value:h,id:"userTypeSelect",className:"bg-sky-500 text-white rounded-full md:py-1 md:px-5",onChange:i=>c(i.target.value),children:[e.jsx("option",{value:"All",children:"All Visitors"}),e.jsx("option",{value:"Verified",children:"Verified Visitors"}),e.jsx("option",{value:"Unverified",children:"Unverified Visitors"}),e.jsx("option",{value:"Unknown",children:"Unknown Visitors"})]})]}),e.jsxs("table",{className:"w-full text-left p-5 mt-4 text-xs md:text-sm lg:text-lg ",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-2 border-b",children:"ID"}),e.jsx("th",{className:"p-2 border-b",children:"Visited at"}),e.jsx("th",{className:"p-2 border-b",children:"NAME"}),e.jsx("th",{className:"p-2 border-b",children:"PURPOSE"}),e.jsx("th",{className:"p-2 border-b",children:"PHONE"})]})}),e.jsx("tbody",{children:f&&f.length>0?f.map(i=>{var v;return e.jsxs("tr",{children:[e.jsxs("td",{className:"p-2 border-b",children:["#",(v=i._id)==null?void 0:v.substring(0,5)]}),e.jsx("td",{className:"p-2 border-b",children:N(i.createdAt)}),e.jsx("td",{className:"p-2 border-b",children:i.username}),e.jsx("td",{className:"p-2 border-b",children:i.purpose}),e.jsx("td",{className:"p-2 border-b",children:i.phone!==0?i.phone:"Unknown"})]})}):e.jsx("div",{className:"flex justify-center text-4xl p-6 font-bold",children:"No users visited"})})]})]})]})]})]})},Ga=()=>{const[s,t]=a.useState(!0);return e.jsxs("div",{className:"flex w-screen",children:[e.jsx(Me,{navShowSet:t}),e.jsx("div",{className:`transition-all duration-300 ${s?"w-[250px]":"w-[60px]"}`}),e.jsx("div",{className:"flex-1",children:e.jsx(Ya,{})})]})},Ha=()=>{const[s,t]=a.useState({}),[o,n]=a.useState({}),[x,h]=a.useState({}),[c,f]=a.useState({}),[u,j]=a.useState([]),y=a.useRef({}),N=(p,i)=>{p.target.files&&p.target.files[0]&&C(p.target.files[0],i)},C=async(p,i)=>{if(!p){P("No file available to upload.");return}try{const v=fe(ge),r=new Date().getTime()+"_"+p.name,A=Ne(v,r),d=we(A,p);h(w=>({...w,[i]:!0})),d.on("state_changed",w=>{const l=w.bytesTransferred/w.totalBytes*100;t(_=>({..._,[i]:l}))},w=>{console.log(w),t(l=>({...l,[i]:null})),h(l=>({...l,[i]:!1}))},()=>{be(d.snapshot.ref).then(w=>{t(l=>({...l,[i]:null})),n(l=>({...l,[i]:w})),h(l=>({...l,[i]:!1})),P("Image uploaded successfully.")})})}catch{t(r=>({...r,[i]:null})),h(r=>({...r,[i]:!1})),P("Failed to upload image.")}},b=async p=>{if(!o[p]){P("No new image available.");return}try{const i=await W.post("/superAdmin/add_new_poster",{id:p,imageUrl:o[p]});console.log(i),P("Poster saved successfully."),E(),f(v=>({...v,[p]:!1}))}catch(i){console.log(i),P("Failed to save poster.")}},E=async()=>{try{const p=await W.get("/superAdmin/get_posters");j(p.data)}catch(p){console.log(p),P("Failed to fetch posters.")}};return a.useEffect(()=>{E()},[]),e.jsx("div",{className:"container mx-auto",children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h1",{className:"text-4xl font-bold py-5",children:"Posters"}),e.jsxs("div",{className:"flex flex-col gap-2 border-2 rounded p-4",children:[e.jsx("div",{className:"flex justify-center border-2 rounded p-5",children:e.jsx("div",{className:"flex justify-center items-center h-4",children:e.jsx("h1",{className:"font-bold text-2xl",children:"CURRENT POSTERS"})})}),e.jsx("div",{className:"flex flex-col gap-5",children:u.map(p=>e.jsxs("div",{className:"flex justify-between items-center px-10 border-2 rounded",children:[e.jsxs("div",{className:"relative",children:[o[p._id]?e.jsx("img",{src:o[p._id],className:"w-36 md:w-96",alt:"Poster"}):e.jsx("img",{src:p.imageUrl,className:"w-36 md:w-96",alt:"Poster"}),e.jsx("input",{type:"file",onChange:i=>N(i,p._id),ref:i=>y.current[p._id]=i,className:"hidden"}),x[p._id]&&s[p._id]!==null&&e.jsxs("div",{className:"progress-bar",children:["Upload progress: ",s[p._id],"%"]})]}),e.jsx("div",{className:"flex flex-col justify-center items-center md:flex-row gap-3 my-auto",children:c[p._id]?e.jsxs(e.Fragment,{children:[e.jsx(zt,{className:" text-3xl md:text-5xl text-gray-600 hover:text-gray-800",onClick:()=>{var i;return(i=y.current[p._id])==null?void 0:i.click()}}),e.jsx("button",{className:"text-white text-xs md:text-sm bg-green-500 px-3 py-1 rounded hover:bg-green-700",onClick:()=>b(p._id),children:"Save"}),e.jsx("button",{className:"text-white text-xs md:text-sm bg-green-500 px-3 py-1 rounded hover:bg-green-700",onClick:()=>f(i=>({...i,[p._id]:!1})),children:"Cancel"})]}):e.jsx("button",{className:"text-white text-xs md:text-sm bg-sky-500 px-3 py-1 rounded hover:bg-sky-700",onClick:()=>f(i=>({...i,[p._id]:!0})),children:"Edit"})})]},p._id))})]})]})})})},Qa=()=>{const[s,t]=a.useState(!0);return e.jsxs("div",{className:"flex w-screen",children:[e.jsx(Me,{navShowSet:t}),e.jsx("div",{className:`transition-all duration-300 ${s?"w-[250px]":"w-[60px]"}`}),e.jsx("div",{className:"flex-1",children:e.jsx(Ha,{})})]})},Ja=()=>{const{currentSuperAdmin:s}=J(t=>t.superAdmin);return s?e.jsx(qe,{}):e.jsx(Ye,{to:"/super_admin_login"})},Ka="modulepreload",Za=function(s){return"/"+s},os={},Xa=function(t,o,n){let x=Promise.resolve();if(o&&o.length>0){document.getElementsByTagName("link");const h=document.querySelector("meta[property=csp-nonce]"),c=(h==null?void 0:h.nonce)||(h==null?void 0:h.getAttribute("nonce"));x=Promise.all(o.map(f=>{if(f=Za(f),f in os)return;os[f]=!0;const u=f.endsWith(".css"),j=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${j}`))return;const y=document.createElement("link");if(y.rel=u?"stylesheet":Ka,u||(y.as="script",y.crossOrigin=""),y.href=f,c&&y.setAttribute("nonce",c),document.head.appendChild(y),u)return new Promise((N,C)=>{y.addEventListener("load",N),y.addEventListener("error",()=>C(new Error(`Unable to preload CSS for ${f}`)))})}))}return x.then(()=>t()).catch(h=>{const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=h,window.dispatchEvent(c),!c.defaultPrevented)throw h})},el=a.lazy(()=>Xa(()=>import("./AdminAllCallListSection--k4NoG62.js"),__vite__mapDeps([0,1,2]))),sl=()=>{const[s,t]=a.useState(!0);return e.jsxs("div",{className:"flex w-screen",children:[e.jsx(ue,{navShowSet:t}),e.jsx("div",{className:`transition-all duration-300 ${s?"w-[250px]":"w-[60px]"}`}),e.jsx("div",{className:"flex-1",children:e.jsx(a.Suspense,{fallback:e.jsx("div",{className:"flex justify-center items-center h-full",children:e.jsx(je,{type:"spin",color:"#000"})}),children:e.jsx(el,{})})})]})},tl=()=>(a.useEffect(()=>{De();const s=zs();return()=>{s.then(()=>{}).catch(t=>console.log("failed "+t))}},[]),e.jsxs("div",{className:"",children:[e.jsx(Vs,{}),e.jsx(Xt,{children:e.jsx(Bt,{children:e.jsxs(Wt,{children:[e.jsx(q,{path:"/",element:e.jsx(ea,{})}),e.jsx(q,{path:"/service",element:e.jsx(ra,{})}),e.jsx(q,{path:"/login",element:e.jsx(la,{})}),e.jsx(q,{path:"/signup",element:e.jsx(na,{})}),e.jsx(q,{path:"/verify_otp_page/:ph",element:e.jsx(oa,{})}),e.jsxs(q,{element:e.jsx(ua,{}),children:[e.jsx(q,{path:"/admin-data",element:e.jsx(ca,{})}),e.jsx(q,{path:"/profile",element:e.jsx(da,{})}),e.jsx(q,{path:"/editprofile",element:e.jsx(ma,{})}),e.jsx(q,{path:"/dashboard",element:e.jsx(fa,{})}),e.jsx(q,{path:"/qrcodes",element:e.jsx(Oa,{})}),e.jsx(q,{path:"/visitors",element:e.jsx(Ta,{})}),e.jsx(q,{path:"/generate_qr",element:e.jsx(ja,{})}),e.jsx(q,{path:"/chat_list",element:e.jsx(Na,{})}),e.jsx(q,{path:"/admin_chat",element:e.jsx(ba,{})}),e.jsx(q,{path:"/admin_call_List",element:e.jsx(sl,{})}),e.jsx(q,{path:"/call_admin_page",element:e.jsx(Ea,{})})]}),e.jsx(q,{path:"/new_user",element:e.jsx(Sa,{})}),e.jsx(q,{path:"/user_verify_otp_page/:id",element:e.jsx(Ca,{})}),e.jsxs(q,{element:e.jsx(_a,{}),children:[e.jsx(q,{path:"/chat_user",element:e.jsx(Aa,{})}),e.jsx(q,{path:"/call_page_user",element:e.jsx(Ia,{})})]}),e.jsx(q,{path:"/super_admin_login",element:e.jsx(Da,{})}),e.jsxs(q,{element:e.jsx(Ja,{}),children:[e.jsx(q,{path:"/super_admin_dashboard",element:e.jsx(Ba,{})}),e.jsx(q,{path:"/super_admin_registered_admin_list",element:e.jsx(qa,{})}),e.jsx(q,{path:"/super_admin_registered_admin_profile",element:e.jsx(Ga,{})}),e.jsx(q,{path:"/super_admin_poster_page",element:e.jsx(Qa,{})})]})]})})})]})),ss={key:"root",storage:Gt,version:1},al=es(ss,aa),ll=es(ss,ka),rl=es(ss,La),Js=qt({reducer:{admin:al,user:ll,superAdmin:rl},middleware:s=>s({serializableCheck:!1})}),nl=Yt(Js);"Notification"in window||(console.log("This browser does not support desktop notification"),alert("This browser does not support desktop notification"));"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/firebase-messaging-sw.js").then(s=>{console.log("Service Worker registered with scope push notification:",s.scope)}).catch(s=>{console.error("Service Worker registration failed:",s)})});"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/service-worker.js").then(s=>{console.log("Service Worker registered with scope pwa:",s.scope)}).catch(s=>{console.log("Service Worker registration failed:",s)})});Ht.createRoot(document.getElementById("root")).render(e.jsx(Qt.StrictMode,{children:e.jsx(Jt,{persistor:nl,children:e.jsx(Kt,{store:Js,children:e.jsx(tl,{})})})}));export{xe as u};
