const __vite__fileDeps=["assets/AdminAllCallListSection-CwKMfQg2.js","assets/vendor-tgZ2SDwj.js","assets/vendor-kbKtIrwV.css"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{j as e,R as Zs,F as Xs,C as et,a as st,b as tt,i as at,g as lt,c as he,d as rt,o as nt,e as ot,r as a,l as ct,u as K,f as q,_ as P,L as W,H as Ce,I as it,h as Fe,k as xe,m as ae,n as dt,G as xt,s as mt,B as V,p as _e,q as ze,t as Be,P as cs,v as Re,w as $e,x as is,y as ds,z as xs,A as ms,D as ye,E as Ne,J as be,K as we,M as us,N as ut,O as ie,Q as ps,T as pt,S as ht,U as ft,V as gt,W as hs,X as jt,Y as fs,Z as Ue,$ as yt,a0 as gs,a1 as js,a2 as Oe,a3 as pe,a4 as qe,a5 as Ye,a6 as We,a7 as He,a8 as Ge,a9 as ys,aa as Ns,ab as Qe,ac as Je,ad as Ke,ae as bs,af as as,ag as ls,ah as Ze,ai as Nt,aj as bt,ak as ws,al as wt,am as vs,an as vt,ao as ks,ap as Ss,aq as kt,ar as St,as as ge,at as Cs,au as Ct,av as _t,aw as Me,ax as _s,ay as Is,az as Es,aA as It,aB as As,aC as Ps,aD as Ts,aE as oe,aF as Le,aG as Et,aH as Us,aI as Os,aJ as Rs,aK as $s,aL as Ls,aM as At,aN as Pt,aO as ce,aP as Tt,aQ as Ut,aR as je,aS as Ot,aT as Rt,aU as $t,aV as Lt,aW as Vt,aX as Dt,aY as Mt,aZ as Vs,a_ as Ds,a$ as Ft,b0 as zt,b1 as Bt,b2 as Y,b3 as qt,b4 as Yt,b5 as Xe,b6 as Wt,b7 as Ht,b8 as Gt,b9 as Qt,ba as Jt}from"./vendor-tgZ2SDwj.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const x of document.querySelectorAll('link[rel="modulepreload"]'))r(x);new MutationObserver(x=>{for(const h of x)if(h.type==="childList")for(const c of h.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function n(x){const h={};return x.integrity&&(h.integrity=x.integrity),x.referrerPolicy&&(h.referrerPolicy=x.referrerPolicy),x.crossOrigin==="use-credentials"?h.credentials="include":x.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function r(x){if(x.ep)return;x.ep=!0;const h=n(x);fetch(x.href,h)}})();const Ms=()=>e.jsxs("div",{className:"grid grid-cols-1  pt-16 pb-20 md:grid-cols-3 mt-10 md:pb-40 bg-slate-800 md:h-72  text-white lg:gap-10",children:[e.jsxs("div",{className:"flex flex-col justify-center items-center px-11 gap-5",children:[e.jsx("h2",{className:"self-start md:text-sm lg:text-2xl",children:"Company"}),e.jsx("span",{className:"self-start md:text-xs ",children:"About Us"}),e.jsx("span",{className:"self-start md:text-xs ",children:"Blog"}),e.jsx("span",{className:"self-start md:text-xs ",children:"Contact Us"}),e.jsx("span",{className:"self-start md:text-xs ",children:"Testamonials"})]}),e.jsxs("div",{className:"flex flex-col justify-center items-center px-11 gap-5",children:[e.jsx("h2",{className:"self-start md:text-sm lg:text-2xl",children:"Support"}),e.jsx("span",{className:"self-start md:text-xs ",children:"Help Center"}),e.jsx("span",{className:"self-start md:text-xs ",children:"Terms and Services"}),e.jsx("span",{className:"self-start md:text-xs ",children:"Legal"}),e.jsx("span",{className:"self-start md:text-xs ",children:"Privacy Policy"})]}),e.jsxs("div",{className:"flex flex-col justify-center items-center px-11 gap-5",children:[e.jsx("h2",{className:"self-start text-sm lg:text-2xl",children:"Stay up to date"}),e.jsxs("div",{className:"self-start flex gap-1",children:[e.jsx("input",{type:"email",placeholder:"Your email address",className:"rounded-md w-28 h-8 px-1 py-1 border border-gray-700 focus:outline-none focus:ring-1 focus:ring-inset focus:ring-blue-500 lg:w-40"}),e.jsx("button",{className:"bg-sky-500 w-16 text-xs text-white px-1 py-1 rounded-md hover:bg-blue-700",children:"Subscribe"})]}),e.jsxs("span",{className:"self-start flex gap-5 text-lg ",children:[e.jsx(Zs,{}),e.jsx(Xs,{}),e.jsx(et,{}),e.jsx(st,{}),e.jsx(tt,{})]}),e.jsx("span",{className:"self-start text-slate-400 text-sm lg:text-lg ",children:"copyright @ 2024"}),e.jsx("span",{className:"self-start text-slate-400 text-sm lg:text-lg",children:"Powered by Elite Mediator pvt ltd"})]})]}),Kt={apiKey:"AIzaSyDiKMgXAyxHTNe37A9mq7CbflZCV_G080E",authDomain:"elite-mediator.firebaseapp.com",projectId:"elite-mediator",storageBucket:"elite-mediator.appspot.com",messagingSenderId:"144513732823",appId:"1:144513732823:web:33a6a583a38005f582e092",measurementId:"G-K8GD4K1D70"},fe=at(Kt),ne=lt(fe);he(fe);const Fs=rt(fe),Ve=async()=>{console.log("Requesting User Permission");try{if(await Notification.requestPermission()==="granted"){console.log("Notification user Permission granted");const t=await ot(Fs,{vapidKey:"BMdWK8g4O2jKMUfZYX9Fy4l1-UER7qO0j57o6usOpcmHyux1QiJ61PiIbek-T93ES5nDid_3uPebdBPPq45gMco"});if(t)return console.log("Client Token:   ",t),t;console.log("Failed to generate the app registration token.")}else console.log("User Permission Denied.")}catch(s){console.log("An error occurred when requesting to receive token. ",s)}},zs=()=>new Promise(s=>{nt(Fs,t=>{console.log(t),s(t)})});zs();const Bs=a.createContext(void 0),Zt=({children:s})=>{const t=ct("https://elitemediator.shop"),[n,r]=a.useState(),[x,h]=a.useState(),[c,g]=a.useState(!1),[i,y]=a.useState(""),{currentAdmin:_}=K(N=>N.admin);return a.useEffect(()=>{_&&t.emit("notify",_._id)},[]),e.jsx(Bs.Provider,{value:{socket:t,callConnected:c,setCallConnected:g,setIsVideoCall:r,isVideoCall:n,notificationCount:x,setNotificationCount:h,token:i,setToken:y},children:s})},de=()=>{const s=a.useContext(Bs);if(s===void 0)throw new Error("useSocket must be used within a SocketProvider");return s},Xt=()=>{var h,c,g,i,y,_,N,k,w,S,m,p;const{setToken:s}=de(),[t,n]=a.useState([]),r=async()=>{const C=await Ve();s(C)};a.useEffect(()=>{r(),x()},[]);const x=async()=>{try{const C=await q.get("/superAdmin/get_posters");n(C.data)}catch(C){console.log(C),P("Failed to fetch posters.")}};return console.log(t),e.jsxs("div",{className:"relative bg-white  overflow-hidden p-8 md:p-10 lg:p-0",children:[e.jsx("div",{className:"absolute rounded-2xl top-0 left-1/4 transform -translate-x-1/2 -translate-y-1/2 bg-blue-100 w-40 h-40 lg:w-72 lg:h-72 rotate-45"}),e.jsx("div",{className:"absolute rounded-2xl -top-14  sm:ml-30 md:ml-28 lg:left-64 transform translate-x-1/2 -translate-y-1/2 bg-neutral-500 w-40 h-40 lg:w-72 lg:h-72 rotate-45"}),e.jsxs("div",{className:"relative flex flex-col lg:flex-row items-center justify-between space-y-8 lg:space-y-0 mt-40",children:[e.jsxs("div",{className:"lg:w-1/2 flex flex-col space-y-4 lg:p-16",children:[e.jsx("h1",{className:"text-3xl lg:text-5xl font-bold text-zinc-600",children:"DON'T MISS ANYONE..."}),e.jsx("h2",{className:"text-xl lg:text-2xl font-semibold text-sky-500",children:"WHO TRY TO REACH YOU"}),e.jsx("p",{className:"text-gray-600 text-sm lg:text-base",children:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua."}),e.jsx(W,{to:"/service",children:e.jsx("button",{className:"bg-sky-500 hover:bg-sky-600 text-white px-4 py-2 rounded self-start",children:"SERVICES"})})]}),e.jsx("div",{className:"lg:w-1/2 flex justify-center lg:justify-end",children:e.jsx("img",{src:t.length>0&&((h=t[0])!=null&&h.imageUrl)?(c=t[0])==null?void 0:c.imageUrl:"https://firebasestorage.googleapis.com/v0/b/elite-mediator.appspot.com/o/1721058856452_Capture.PNG?alt=media&token=8e4ddf1c-00a3-4077-b2be-36bea2bbdb04",alt:"Illustration",className:"max-w-full h-auto"})})]}),e.jsxs("div",{className:"flex flex-col items-center justify-center p-6 bg-white md:p-12 ",children:[e.jsxs("div",{className:"relative w-full",children:[e.jsx("div",{className:"bg-sky-500 h-14 w-16 absolute -left-24 -top-3 rounded-xl md:h-18 md:-left-28 md:h-20  md:-top-5 lg:-left-20"}),e.jsx("h2",{className:"text-2xl font-bold text-zinc-600 text-center md:text-4xl",children:"BE ALWAYS AVAILABLE FOR EVERYONE"})]}),e.jsx("p",{className:"mt-2 text-center text-gray-600",children:"Manage your property from anywhere in this world"}),e.jsxs("div",{className:"",children:[e.jsxs("div",{className:"flex flex-col justify-between mt-6 space-y-6 md:flex-row md:space-y-0 md:space-x-12 md:text-sm  lg:text-lg",children:[e.jsxs("div",{className:"flex flex-col items-center p-10 space-y-4 text-center bg-gray-100  rounded-lg md:w-1/3",children:[e.jsx("div",{className:"flex items-center justify-center w-12 h-12 bg-sky-500 rounded-2xl relative",children:e.jsx(Ce,{className:"text-4xl absolute -left-2 bottom-0"})}),e.jsx("h3",{className:"text-xl font-semibold",children:"Domestic"}),e.jsx("p",{className:"text-gray-600",children:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed adibced sit amet justo ipsum. Sed accumsan quam vitae est varius."})]}),e.jsxs("div",{className:"flex flex-col items-center p-10 space-y-4 text-center bg-gray-100 rounded-lg md:w-1/3",children:[e.jsx("div",{className:"flex items-center justify-center w-12 h-12 bg-sky-500 rounded-2xl relative",children:e.jsx(it,{className:"text-4xl absolute -left-2 bottom-0"})}),e.jsx("h3",{className:"text-xl font-semibold",children:"Business"}),e.jsx("p",{className:"text-gray-600",children:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed adibced sit amet justo ipsum. Sed accumsan quam vitae est varius."})]})]}),e.jsx("div",{className:"flex justify-center p-2 md:p-0 lg:p-0",children:e.jsx(W,{to:"/service",children:e.jsx("button",{className:"mt-auto px-4 h-11 font-semibold text-white bg-sky-500 rounded  hover:bg-sky-600 ",children:"SERVICES"})})})]})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row lg:justify-between",children:[e.jsx("div",{className:"",children:e.jsx("img",{src:t.length>0&&((g=t[0])!=null&&g.imageUrl)?(i=t[1])==null?void 0:i.imageUrl:"https://firebasestorage.googleapis.com/v0/b/elite-mediator.appspot.com/o/1721057073374_landingpage2.png?alt=media&token=ad06005d-e2de-4981-8c44-dc3016d7caa9",alt:"",className:"h-auto w-90 md:h-72 md:60"})}),e.jsxs("div",{className:"flex flex-col justify-center gap-5",children:[e.jsxs("div",{className:"relative w-full mt-7",children:[e.jsx("div",{className:"bg-sky-500 h-14 w-16 absolute -right-24 -top-3 rounded-xl md:h-18 md:-right-16 md:h-20  md:top-0 lg:-right-7"}),e.jsx("h2",{className:"text-xl font-bold text-zinc-600 md:text-4xl text-start",children:"CONNECT WITH ANYONE SEAMLESSLY"}),e.jsx("h2",{className:"text-xl font-semibold text-sky-500 md:text-4xl text-start",children:"KEEPING YOUR DATA'S PRIVATE"})]}),e.jsx("div",{className:"h-40 w-[900px] pr-40",children:e.jsx("p",{className:"",children:"Lorem ipsum dolor sit amet consectetur adipisicing elit. Minus eveniet labore, adipisci vitae doloremque eligendi qui magnam eaque nihil? Quasi ipsum, saepe consectetur aspernatur consequuntur numquam alias culpa, incidunt hic ad eligendi iusto repellendus accusamus voluptates amet molestias laudantium, molestiae ab earum quia minima repellat dolor. Praesentium ab vero totam!"})}),e.jsx("div",{className:"text-start",children:e.jsx("button",{className:"bg-sky-500 text-white px-4 py-2 rounded-md self-start",children:"Leran more.."})})]})]}),e.jsxs("div",{className:"flex flex-col rounded-xl items-center justify-center gap-8  lg:justify-between mt-9 lg:flex-row bg-zinc-300 h-[400px]",children:[e.jsxs("div",{className:"relative w-1/2",children:[e.jsx("div",{className:"bg-sky-500 h-14 w-16 absolute -left-44 top-9 rounded-xl sm:-left-80 md:h-18 md:-left-60 md:h-20  md:-top-2 lg:-left-8"}),e.jsxs("div",{className:"flex flex-col lg:w-[700px] justify-center mt-12 text-center md:text-start md:mt-0",children:[e.jsx("h2",{className:"text-xl mt-70 font-bold text-zinc-600 text-center lg:text-4xl ",children:"YOUR VIRITUAL DOORMAN"}),e.jsx("h2",{className:"text-center w-full text-sm font-bold text-sky-500 ml-5  lg:text-2xl lg:ml-8 self-start ",children:"CONNECT WTH VISITORS FROM ANYWHERE"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-16 w-1/2 p-6 ",children:[e.jsx(Ce,{className:"text-3xl lg:text-5xl text-slate-500"}),e.jsx(Ce,{className:"text-3xl lg:text-5xl text-slate-500"}),e.jsx(Ce,{className:"text-3xl lg:text-5xl text-slate-500"}),e.jsx(Ce,{className:"text-3xl lg:text-5xl text-slate-500"})]})]}),e.jsxs("div",{className:"mt-8 mb-32 flex flex-col lg:flex-row lg:justify-between",children:[e.jsx("div",{className:"",children:e.jsx("img",{src:t.length>0&&((y=t[0])!=null&&y.imageUrl)?(_=t[2])==null?void 0:_.imageUrl:"https://firebasestorage.googleapis.com/v0/b/elite-mediator.appspot.com/o/1721057084411_landingpage3.png?alt=media&token=91cb7b6e-3c32-4f9f-b07b-7094f1fb4869",alt:"",className:"h-auto w-90 md:h-72 md:60"})}),e.jsxs("div",{className:"flex flex-col justify-center gap-5",children:[e.jsxs("div",{className:"relative w-full mt-7",children:[e.jsx("div",{className:"bg-sky-500 h-14 w-16 absolute -right-24 -top-3 rounded-xl md:h-18 md:-right-16 md:h-20  md:top-0 lg:-right-7"}),e.jsx("h2",{className:"text-xl font-bold text-zinc-600 md:text-4xl text-start",children:"WE MAKE YOUR DATA SAFE AND SECURE"}),e.jsx("h2",{className:"text-xl font-semibold text-sky-500 md:text-4xl text-start",children:"YOUR PRIVACY IS OUT TOP CONCER"})]}),e.jsx("div",{className:"h-40 w-[900px] pr-40",children:e.jsx("p",{className:"",children:"Lorem ipsum dolor sit amet consectetur adipisicing elit. Minus eveniet labore, adipisci vitae doloremque eligendi qui magnam eaque nihil? Quasi ipsum, saepe consectetur aspernatur consequuntur numquam alias culpa, incidunt hic ad eligendi iusto repellendus accusamus voluptates amet molestias laudantium, molestiae ab earum quia minima repellat dolor. Praesentium ab vero totam! Lorem ipsum dolor sit amet consectetur adipisicing elit. Beatae illo, totam exercitationem officia quod reiciendis perferendis quis, sequi, esse neque minus recusandae reprehenderit molestias debitis! Non quo eaque consequatur, consequuntur veniam ut. Error, quos debitis? Lorem ipsum dolor sit amet consectetur, adipisicing elit. Labore officiis odio ex porro sit omnis quo. Dolore modi earum illum natus iusto exercitationem commodi voluptatem, ipsa delectus! Cupiditate molestias nam aspernatur nostrum sint reiciendis eligendi facere architecto doloremque, repudiandae omnis."})})]})]}),e.jsxs("div",{className:"flex flex-col mt-11 items-center justify-center p-6 bg-white md:p-12 ",children:[e.jsxs("div",{className:"relative w-full mb-9",children:[e.jsx("div",{className:"bg-sky-500 h-14 w-16 absolute -left-24 -top-3 rounded-xl md:h-18 md:-left-20 md:h-20  md:-top-5"}),e.jsx("h2",{className:"text-2xl font-bold text-zinc-600 text-center md:text-4xl",children:"STAY IN THE LOOP: VISITOR COMMUNICATION MADE EASY"})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-3",children:[e.jsx("div",{className:" bg-blue-100 rounded-xl md:w-90 md:h-72 overflow-hidden",children:e.jsx("img",{src:t.length>0&&((N=t[0])!=null&&N.imageUrl)?(k=t[3])==null?void 0:k.imageUrl:"https://firebasestorage.googleapis.com/v0/b/elite-mediator.appspot.com/o/1721057095865_landingPageImg1.avif?alt=media&token=ded48002-ad32-4146-ac94-7390cbb472d2",alt:"",className:"object-cover w-full h-full"})}),e.jsx("div",{className:" bg-blue-100 rounded-xl  md:w-90 md:h-72 ",children:e.jsx("h2",{className:"py-24 px-7 text-2xl font-bold text-slate-600 uppercase",children:"Welcome All the Guests, No matter where you are"})}),e.jsx("div",{className:" bg-blue-100 rounded-xl md:w-90 md:h-72 overflow-hidden",children:e.jsx("img",{src:t.length>0&&((w=t[0])!=null&&w.imageUrl)?(S=t[4])==null?void 0:S.imageUrl:"https://firebasestorage.googleapis.com/v0/b/elite-mediator.appspot.com/o/1721057116338_landingPageImg2.avif?alt=media&token=315fa014-7816-4406-85a3-d1c46e1ad53a",alt:"",className:"object-cover w-full h-full"})}),e.jsx("div",{className:" bg-blue-100 rounded-xl  md:w-90 md:h-72 ",children:e.jsx("h2",{className:"py-24 px-7 text-2xl font-bold text-slate-600 uppercase",children:"Peace of Mind: Chat with Visitors Even When You're Out"})}),e.jsx("div",{className:" bg-blue-100 rounded-xl md:w-90 md:h-72 overflow-hidden",children:e.jsx("img",{src:t.length>0&&((m=t[0])!=null&&m.imageUrl)?(p=t[5])==null?void 0:p.imageUrl:"https://firebasestorage.googleapis.com/v0/b/elite-mediator.appspot.com/o/1721057130775_landingPageImg3.avif?alt=media&token=e6b97baa-1d3b-4b6d-b961-d93f66388d25",alt:"",className:"object-cover w-full h-full"})}),e.jsx("div",{className:" bg-blue-100 rounded-xl  md:w-90 md:h-72 ",children:e.jsx("h2",{className:"py-24 px-7 text-2xl font-bold text-slate-600 uppercase",children:"Have a live interaction with the visitors keeping your privacy ahead"})})]})]}),e.jsxs("div",{className:"flex flex-col justify-center items-center mt-10 mb-10",children:[e.jsx("h1",{className:"mt-2 text-sm md:mt-8  md:text-5xl font-bold text-slate-600",children:"SMART VISITORS MANAGMENT CONNECT FROM"}),e.jsx("h1",{className:"mt-2 text-sm md:mt-8  md:text-5xl font-semibold text-sky-500",children:"ANYWHERE"}),e.jsx("button",{className:"mt-8 bg-sky-500  text-white px-4 py-2  rounded self-center",children:"Register"})]}),e.jsx(Ms,{})]})},ea={currentAdmin:null,error:null,loading:!1,conversation:[]},qs=Fe({name:"admin",initialState:ea,reducers:{signInStart:s=>{s.loading=!0,s.error=null},signInSuccess:(s,t)=>{s.currentAdmin=t.payload,s.loading=!1,s.error=null},signInFailure:(s,t)=>{s.loading=!1,s.error=t.payload},setConversation:(s,t)=>{s.conversation=Array.isArray(t.payload)?t.payload:[]},signoutSuccess:s=>{s.currentAdmin=null,s.error=null,s.loading=!1}}}),{signInSuccess:Ie,signInStart:sa,signInFailure:ol,setConversation:cl,signoutSuccess:rs}=qs.actions,ta=qs.reducer,Ys=()=>{const s=xe(),t=ae(),n=async()=>{try{const r=new xt;r.setCustomParameters({prompt:"select_account"});const x=await mt(ne,r);console.log(x);const h=await fetch("/api/google_oauth",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:x.user.displayName,email:x.user.email,image:x.user.photoURL,phone:91e10,password:"12345678"})}),c=await h.json();h.ok&&(c!=null&&c.address?(console.log(c),s(Ie(c)),t("/profile"),P("Succesfully logged In")):(console.log(c),s(Ie(c)),t("/admin-data"),P("Succesfully logged In")))}catch(r){console.log(r)}};return e.jsx("div",{className:"flex justify-center",children:e.jsxs("button",{onClick:n,className:"relative flex items-center justify-center bg-white w-full max-w-sm rounded-full py-2 px-4 text-gray-600 hover:bg-gray-100 hover:shadow-md transition duration-300 ease-in-out border border-gray-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500",children:[e.jsx(dt,{className:"w-6 h-6 mr-3"}),e.jsx("span",{className:"font-medium",children:"Sign in with Google"})]})})},aa=()=>{const[s,t]=a.useState(""),[n,r]=a.useState(""),[x,h]=a.useState(!0),[c,g]=a.useState(!0),[i,y]=a.useState(""),[_,N]=a.useState(!1),{currentAdmin:k}=K(f=>f.admin),w=xe(),S=ae(),[m,p]=a.useState([]),C=async()=>{try{const f=await q.get("/superAdmin/get_posters");p(f.data)}catch(f){console.log(f),P("Failed to fetch posters.")}};a.useEffect(()=>{C(),k&&k.address?S("/profile"):k&&!k.address&&S("/admin-data")},[]);const l=f=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(f),A=f=>f.length>=6,d=async()=>{const f=l(s),o=A(n);if(h(f),g(o),!(!f||!o)){w(sa());try{const E=await fetch("/api/admin_login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:s,password:n})});if(E.ok){const u=await E.json();console.log(u),console.log("Login successful:",u),u==="Invalid credentials"&&P(u),u!=="Invalid credentials"&&(u&&!(u!=null&&u.address)?(S("/admin-data"),w(Ie(u))):u&&(u!=null&&u.address)&&(w(Ie(u)),S("/profile")))}else{const u=await E.json();y(u.message||"Login failed. Please try again.")}}catch(E){y("An error occurred. Please try again."),console.log("Error logging in:",E)}}};return e.jsxs("div",{className:"flex justify-center h-[700px] w-full",children:[e.jsx("div",{className:"hidden sm:flex sm:flex-1 sm:h-full",children:e.jsx("img",{src:m.length>0?m[9].imageUrl:"https://firebasestorage.googleapis.com/v0/b/elite-mediator.appspot.com/o/login.jpg?alt=media&token=23fd7400-7426-40c8-87c3-dc4c1eabc8c9",alt:"Dummy",className:"h-full object-cover w-full"})}),e.jsx("div",{className:"w-full lg:flex-1 h-full bg-sky-100 p-5",children:e.jsxs("div",{className:"bg-white h-full flex flex-col justify-center items-center",children:[e.jsx("h1",{className:"text-2xl lg:text-3xl",children:"Login"}),e.jsxs("div",{className:"flex flex-col pt-5",children:[e.jsxs("div",{className:"flex justify-between px-5 py-1",children:[e.jsx("span",{className:"text-xs text-zinc-500",children:"Email"}),e.jsxs("div",{className:"flex justify-between gap-1",children:[s&&(x?e.jsx(V,{className:"text-green-600 text-xs"}):e.jsx(_e,{className:"text-red-600 text-xs"})),e.jsx("span",{className:`text-xs text-center ${x?"text-green-500":"text-red-500"}`,children:s.length>0&&(x?"Valid":"Invalid")})]})]}),e.jsx("input",{type:"text",className:`w-[300px] border rounded py-1 px-5 ${x?"":"border-red-500"}`,placeholder:"Enter your email",value:s,onChange:f=>t(f.target.value)})]}),e.jsxs("div",{className:"flex flex-col pt-5",children:[e.jsxs("div",{className:"flex justify-between px-5 py-1",children:[e.jsx("span",{className:"text-xs text-zinc-500",children:"Password"}),e.jsxs("div",{className:"flex justify-between gap-1",children:[n&&(c?e.jsx(V,{className:"text-green-600 text-xs"}):e.jsx(_e,{className:"text-red-600 text-xs"})),e.jsx("span",{className:`text-xs text-center ${c?"text-green-500":"text-red-500"}`,children:n.length>0&&(c?"Valid":"Invalid")})]})]}),e.jsxs("div",{className:" relative ",children:[e.jsx("input",{type:`${_?"text":"password"}`,className:`w-[300px] border rounded py-1 px-5${c?"":"border-red-500"}`,placeholder:"Enter your password",value:n,onChange:f=>r(f.target.value)}),_?e.jsx(ze,{className:"absolute top-2 right-3",onClick:()=>N(!1)}):e.jsx(Be,{className:"absolute top-2 right-3",onClick:()=>N(!0)})]})]}),i&&e.jsx("div",{className:"text-red-500 text-sm mt-2",children:i}),e.jsx("div",{className:"w-[300px] mt-6",children:e.jsx("button",{onClick:d,className:"bg-sky-500 w-full rounded py-1 px-5 text-white hover:bg-sky-600",children:"Login"})}),e.jsx("div",{className:"mt-5 mb-5 text-sm",children:e.jsx(W,{to:"/forgot-password",children:"Forgot password?"})}),e.jsx("div",{className:"mt-5 mb-5 text-blue-700 text-sm",children:e.jsx(W,{to:"/signup",children:"Click here to sign up"})}),e.jsxs("div",{className:"flex items-center mt-5",children:[e.jsx("span",{className:"border-t border-gray-300 flex-grow mr-3"}),e.jsx("span",{className:"text-gray-400",children:"or continue with"}),e.jsx("span",{className:"border-t border-gray-300 flex-grow ml-3"})]}),e.jsx("div",{className:"w-[300px] mt-6",children:e.jsx(Ys,{})})]})})]})},la=()=>{const[s,t]=a.useState([]);a.useEffect(()=>{n()},[]);const n=async()=>{try{const r=await q.get("/superAdmin/get_posters");t(r.data)}catch(r){console.log(r),P("Failed to fetch posters.")}};return e.jsxs("div",{className:"relative bg-white  overflow-hidden p-8 md:p-10 lg:p-0",children:[e.jsx("div",{className:"absolute rounded-2xl top-0 left-1/4 transform -translate-x-1/2 -translate-y-1/2 bg-blue-100 w-40 h-40 lg:w-72 lg:h-72 rotate-45"}),e.jsx("div",{className:"absolute rounded-2xl -top-14  sm:ml-30 md:ml-28 lg:left-64 transform translate-x-1/2 -translate-y-1/2 bg-neutral-500 w-40 h-40 lg:w-72 lg:h-72 rotate-45"}),e.jsxs("div",{className:"relative mb-10 flex flex-col lg:flex-row items-center justify-between space-y-8 lg:space-y-0 mt-40",children:[e.jsx("div",{className:"lg:w-1/2 flex justify-center lg:justify-end",children:e.jsx("img",{src:s.length>0?s[6].imageUrl:"https://firebasestorage.googleapis.com/v0/b/elite-mediator.appspot.com/o/1721057219908_Domestic.jpg?alt=media&token=8ba48abf-8c4e-432b-a892-f42d86190fa2",alt:"Illustration",className:"max-w-full mt-10 h-auto"})}),e.jsxs("div",{className:"lg:w-1/2 flex flex-col space-y-4 lg:p-16",children:[e.jsx(W,{to:"/signup",children:e.jsx("button",{className:"bg-sky-500 text-white px-4 py-2 rounded self-end",children:"Register now"})}),e.jsx("h1",{className:"text-3xl lg:text-5xl font-bold text-zinc-600",children:"DOMESTIC"}),e.jsx("p",{className:" text-zinc-700 text-sm  lg:text-lg z-20",children:"Acting as the perfect mediator, our service helps visitors reach you through a generated QR code when you're not at home, ensuring a seamless experience while keeping your personal data private."}),e.jsx("p",{className:"text-slate-300 text-sm lg:text-lg z-20",children:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Lorem ipsum dolor sit amet"}),e.jsx("div",{className:"absolute rounded-2xl -right-20 -bottom-32  sm:ml-30 md:ml-28  transform translate-x-1/2 -translate-y-1/2 bg-sky-500 w-40 h-40 md:-right-20 md:-bottom-20 lg:w-72 lg:h-60 rotate-45 lg:-bottom-40 lg:-right-6"})]})]}),e.jsxs("div",{className:"flex flex-col gap-8 justify-between lg:flex-row lg:p-10",children:[e.jsx("div",{className:"w-1/2",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"bg-sky-500 h-14 w-16 absolute -left-16 -top-3 rounded-xl md:h-18 md:-left-16 md:h-20  md:-top-4"}),e.jsxs("div",{className:"pl-5",children:[e.jsx("h1",{className:"text-3xl lg:text-5xl font-bold text-zinc-600 uppercase",children:"Business"}),e.jsx("p",{className:"w-[800px] text-sm mt-5  text-zinc-700 lg:text-lg",children:"Acting as the perfect mediator, our services facilitate renting and selling your properties seamlessly. Users can reach you through a generated QR code, ensuring your private phone number remains confidential. Enjoy a seamless experience with our app, designed for effortless and secure transactions."})]})]})}),e.jsx("div",{className:"w-1/2 flex justify-center items-center ml-14",children:e.jsx("img",{src:s.length>0?s[7].imageUrl:"https://firebasestorage.googleapis.com/v0/b/elite-mediator.appspot.com/o/1721057233070_Bussiness.jpg?alt=media&token=e378a80b-11bc-473d-888e-9c91419e74c2",alt:"",className:""})})]}),e.jsxs("div",{className:"mt-16  mb-32 flex flex-col gap-5 lg:flex-row lg:justify-between",children:[e.jsx("div",{className:"",children:e.jsx("img",{src:s.length>0?s[8].imageUrl:"https://firebasestorage.googleapis.com/v0/b/elite-mediator.appspot.com/o/1721057243593_visitors.webp?alt=media&token=7bd7a863-f40f-4c4e-9272-8172284648fc",alt:""})}),e.jsxs("div",{className:"flex flex-col justify-center gap-5",children:[e.jsxs("div",{className:"relative w-full mt-7",children:[e.jsx("div",{className:"bg-sky-500 h-14 w-16 absolute -right-16 -top-3 rounded-xl md:h-18 lg:-right-7 md:h-20  md:-top-7 "}),e.jsx("h2",{className:"text-xl font-bold text-zinc-600 md:text-4xl text-start uppercase",children:"Ensure your visitor leave happy"})]}),e.jsx("div",{className:"h-40 w-[600px] lg:w-[900px] pr-40 mr-10",children:e.jsx("p",{className:"pr-10 text-sm text-zinc-700 lg:text-lg",children:"Experience a seamless user interface with our web app, offering integrated chat, voice call, and video call functionalities. Effortlessly communicate in real-time, whether you prefer texting, talking, or face-to-face interactions. Our platform ensures smooth and uninterrupted connectivity, enhancing your online communication experience."})})]})]}),e.jsx(Ms,{})]})},ra=()=>{const[s,t]=a.useState(""),[n,r]=a.useState(""),[x,h]=a.useState(""),[c,g]=a.useState(""),[i,y]=a.useState({}),[_,N]=a.useState(null),[k,w]=a.useState(!1),[S,m]=a.useState([]),p=ae(),C=()=>{let f={},o=!0;return s||(o=!1,f.username="Username is required"),n?/\S+@\S+\.\S+/.test(n)||(o=!1,f.email="Email is invalid"):(o=!1,f.email="Email is required"),x||(o=!1,f.phone="Phone number is required"),c||(o=!1,f.password="Password is required"),y(f),o},l=async f=>{try{const o=await fetch("/api/signup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:s,email:n,password:c,phone:x,firebaseConfirm:f.verificationId})});if(o.ok){const E=await o.json();if(E==="Credantials already exisit")return P(E);P("Verification message sucessfully send to your mobile"),p(`/verify_otp_page/${x}`)}}catch(o){console.log(o)}},A=async()=>{if(C())try{const f=new Re(ne,"recaptcha",{}),o=await $e(ne,x,f);o?(N(o),l(o)):console.log("Error confirming the captcha.")}catch(f){console.log(f)}else return},d=async()=>{try{const f=await q.get("/superAdmin/get_posters");m(f.data)}catch(f){console.log(f),P("Failed to fetch posters.")}};return a.useEffect(()=>{d()},[]),console.log(_),e.jsxs("div",{className:"flex justify-center h-[700px] w-full",children:[e.jsx("div",{className:"hidden sm:flex sm:flex-1 sm:h-full",children:e.jsx("img",{src:S.length>0?S[9].imageUrl:"https://firebasestorage.googleapis.com/v0/b/elite-mediator.appspot.com/o/login.jpg?alt=media&token=23fd7400-7426-40c8-87c3-dc4c1eabc8c9",alt:"Dummy",className:"h-full object-cover w-full"})}),e.jsx("div",{className:"w-full lg:flex-1 h-full bg-sky-100 p-5",children:e.jsxs("div",{className:"bg-white h-full flex flex-col justify-center items-center",children:[e.jsx("h1",{className:"text-2xl lg:text-3xl",children:"Create an account"}),e.jsx("p",{className:"text-xs",children:"Enter your email to sign up for this app"}),e.jsxs("div",{className:"flex flex-col pt-5",children:[e.jsxs("div",{className:"flex justify-between px-5 py-1",children:[e.jsx("span",{className:"text-xs text-zinc-500",children:"Username"}),e.jsx("div",{className:"flex justify-between gap-1",children:s&&e.jsxs(e.Fragment,{children:[e.jsx(V,{className:"text-green-600 text-xs"}),e.jsx("span",{className:"text-xs text-green-500 text-center",children:"Valid"})]})})]}),e.jsx("input",{type:"text",className:"w-[300px] border rounded py-1 px-5",placeholder:"Enter your username",value:s,onChange:f=>t(f.target.value)}),i.username&&e.jsx("span",{className:"text-red-500 text-xs",children:i.username})]}),e.jsxs("div",{className:"flex flex-col pt-5",children:[e.jsxs("div",{className:"flex justify-between px-5 py-1",children:[e.jsx("span",{className:"text-xs text-zinc-500",children:"Email"}),e.jsx("div",{className:"flex justify-between gap-1",children:n&&e.jsxs(e.Fragment,{children:[e.jsx(V,{className:"text-green-600 text-xs"}),e.jsx("span",{className:"text-xs text-green-500 text-center",children:"Valid"})]})})]}),e.jsx("input",{type:"text",className:"w-[300px] border rounded py-1 px-5",placeholder:"Enter your email",value:n,onChange:f=>r(f.target.value)}),i.email&&e.jsx("span",{className:"text-red-500 text-xs",children:i.email})]}),e.jsxs("div",{className:"flex flex-col pt-5",children:[e.jsxs("div",{className:"flex justify-between px-5 py-1",children:[e.jsx("span",{className:"text-xs text-zinc-500",children:"Phone"}),e.jsx("div",{className:"flex justify-between gap-1",children:x&&e.jsxs(e.Fragment,{children:[e.jsx(V,{className:"text-green-600 text-xs"}),e.jsx("span",{className:"text-xs text-green-500 text-center",children:"Valid"})]})})]}),e.jsx(cs,{country:"in",value:x,onChange:f=>h("+"+f)}),i.phone&&e.jsx("span",{className:"text-red-500 text-xs",children:i.phone})]}),e.jsxs("div",{className:"flex flex-col pt-5",children:[e.jsxs("div",{className:"flex justify-between px-5 py-1",children:[e.jsx("span",{className:"text-xs text-zinc-500",children:"Password"}),e.jsx("div",{className:"flex justify-between gap-1 relative",children:c&&e.jsxs(e.Fragment,{children:[e.jsx(V,{className:"text-green-600 text-xs"}),e.jsx("span",{className:"text-xs text-green-500 text-center",children:"Valid"})]})})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:`${k?"text":"password"}`,className:"w-[300px] border rounded py-1 px-5",placeholder:"Enter your password",value:c,onChange:f=>g(f.target.value)}),k?e.jsx(ze,{className:"absolute top-2 right-3",onClick:()=>w(!1)}):e.jsx(Be,{className:"absolute top-2 right-3",onClick:()=>w(!0)})]}),i.password&&e.jsx("span",{className:"text-red-500 text-xs",children:i.password})]}),e.jsx("div",{className:"w-[300px] mt-6",children:e.jsx("button",{className:"bg-sky-500 w-full rounded py-1 px-5 text-white hover:bg-sky-600",onClick:A,children:"Signup"})}),e.jsx("div",{className:"w-[300px] mt-6",id:"recaptcha"}),e.jsx("div",{className:"mt-5 mb-5 text-sm",children:e.jsx(W,{to:"/login",children:"Already have an account"})}),e.jsxs("div",{className:"flex",children:[e.jsx("span",{className:"text-slate-200",children:"_____________"}),e.jsx("span",{className:"text-slate-300",children:"or continue with"}),e.jsx("span",{className:"text-slate-200",children:"_____________"})]}),e.jsx("div",{className:"w-[300px] mt-6",children:e.jsx(Ys,{})})]})})]})},na=()=>{const[s,t]=a.useState(new Array(6).fill("")),[n,r]=a.useState(30),[x,h]=a.useState({}),c=is(),g=ae();a.useEffect(()=>{if(n>0){const N=setTimeout(()=>r(n-1),1e3);return()=>clearTimeout(N)}},[n]),a.useEffect(()=>{(async()=>{try{const k=await fetch(`/api/unverified_admin/${c.ph}`);if(k.ok){const w=await k.json();h(w)}else console.log("Error fetching user data:",k.status)}catch(k){console.log("Error fetching user data:",k)}})()},[c.ph]);const i=(N,k)=>{if(isNaN(Number(N.value)))return;const w=[...s];w[k]=N.value,t(w),N.nextSibling&&N.value!==""&&N.nextSibling.focus()},y=async()=>{r(60);try{const N=new Re(ne,"recaptcha",{}),k=await $e(ne,"+"+(x==null?void 0:x.phone),N);if(console.log(k),k){const w=await fetch("/api/update_firebase_verify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({firebaseConfirm:k.verificationId,phone:x.phone})});if(w.ok){const S=await w.json();h(S),P("otp resended sucessfully")}else console.log("Error updating firebase verification:",w.status)}else console.log("Error confirming the captcha.")}catch(N){console.log("Error resending OTP:",N)}},_=async()=>{const N=s.join(""),k=x.firebaseConfirm;if(!k){console.log("Verification ID is missing.");return}try{const w=ds.credential(k,N),S=await xs(ne,w);console.log("Verification result:",S),P("OTP verification successful!"),g("/login")}catch(w){w.code==="auth/code-expired"?P("The OTP has expired. Please request a new one."):w.code==="auth/invalid-verification-code"?P("The OTP entered is invalid. Please try again."):alert("Error verifying OTP. Please try again."),console.log("Error verifying OTP:",w)}};return e.jsx("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gray-100 p-4",children:e.jsxs("div",{className:"bg-white shadow-lg rounded-lg p-8 max-w-sm w-full",children:[e.jsx("div",{className:"flex justify-center mb-6",children:e.jsx("img",{src:"/public/otpverify.jpg",alt:"OTP Icon",className:"w-50 h-60 object-cover"})}),e.jsx("h2",{className:"text-center text-lg font-semibold mb-4",children:"Enter the OTP sent to your mobile"}),e.jsx("div",{className:"flex justify-center mb-4 space-x-2",children:s.map((N,k)=>e.jsx("input",{type:"text",name:"otp",maxLength:1,className:"w-12 h-12 text-center text-lg border border-gray-300 rounded-md focus:ring-2 focus:ring-sky-500 focus:border-transparent",value:N,onChange:w=>i(w.target,k),onFocus:w=>w.target.select()},k))}),e.jsx("button",{onClick:_,className:"w-full py-2 bg-sky-500 text-white font-semibold rounded-md hover:bg-sky-600 transition duration-300",children:"Verify"}),e.jsx("div",{className:"mt-4 flex justify-center",children:e.jsx("button",{disabled:n!==0,onClick:y,className:"text-sky-500 underline",children:n===0?"Resend OTP":`Resend OTP in ${n} seconds`})}),e.jsx("div",{className:"",id:"recaptcha"})]})})},oa=()=>{const s=ae(),{currentAdmin:t}=K(m=>m.admin),[n,r]=a.useState(null),[x,h]=a.useState(null),[c,g]=a.useState({address:"",state:"",city:"",pincode:"",landmark:"",image:(t==null?void 0:t.image)||""});console.log(c),console.log(t._id);const[i,y]=a.useState({address:!1,state:!1,city:!1,pincode:!1,landmark:!1,image:!1}),_=(m,p)=>m==="pincode"?/^\d{6}$/.test(p):p.trim()!=="",N=m=>{m.target.files&&m.target.files[0]&&k(m.target.files[0])},k=async m=>{if(!m){h("Please select an image");return}try{h(null);const p=he(fe),C=new Date().getTime()+"_"+m.name,l=ye(p,C),A=Ne(l,m);A.on("state_changed",d=>{const f=d.bytesTransferred/d.totalBytes*100;r(f)},d=>{h("Image upload failed: "+d.message),r(null)},()=>{be(A.snapshot.ref).then(d=>{r(null),h(null),g(f=>({...f,image:d}))})})}catch{h("Image upload failed"),r(null)}},w=m=>p=>{const C=p.target.value;g(l=>({...l,[m]:C})),y(l=>({...l,[m]:!_(m,C)}))},S=async()=>{if(!Object.entries(c).every(([p,C])=>_(p,C))){y({address:!_("address",c.address),state:!_("state",c.state),city:!_("city",c.city),pincode:!_("pincode",c.pincode),landmark:!_("landmark",c.landmark),image:!_("image",c.image)});return}try{const p=await fetch(`/api/update_admin/${t._id}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)}),C=await p.json();p.ok&&C.updated?s("/profile"):console.log("Error updating the profile")}catch(p){console.error("Error updating admin:",p)}};return e.jsxs("div",{children:[e.jsx("div",{className:"absolute z-0 rounded-2xl -top-14 sm:ml-30 md:ml-28 lg:left-64 transform translate-x-1/2 -translate-y-1/2 bg-zinc-300 w-40 h-40 lg:w-72 lg:h-72 rotate-45"}),e.jsx("h1",{className:"relative font-semibold text-2xl z-10 flex justify-center items-center mt-8 text-center md:text-5xl",children:"WE KEEP YOUR DATA SAFE IN OUR HANDS"}),e.jsx("div",{className:"p-10 z-10",children:e.jsxs("div",{className:"flex flex-col justify-center items-center border-2 relative rounded-md z-10 px-8",children:[e.jsxs("div",{className:"mb-6 md:mb-0 relative mt-9 P-3",children:[e.jsx("label",{htmlFor:"profile-image",className:"cursor-pointer",children:e.jsxs("div",{className:"relative h-24 w-24 md:h-32 md:w-32 lg:h-48 lg:w-48",children:[n!==null&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx(ms,{value:n,text:`${Math.round(n)}%`,strokeWidth:5,styles:{root:{width:"100%",height:"100%"},path:{stroke:`rgba(62, 152, 199, ${n/100})`}}})}),e.jsx("img",{src:c.image,alt:"user",className:`h-full w-full rounded-full border-2 object-cover ${n!==null&&n<100&&"opacity-60"}`})]})}),e.jsx("input",{type:"file",accept:"image/*",id:"profile-image",className:"hidden",onChange:N}),e.jsx("h1",{className:"text-center p-3 text-zinc-500",children:"Upload Profile Image"})]}),x&&e.jsx("div",{className:"text-red-500 mt-2",children:x}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-10 mb-20",children:Object.keys(c).map(m=>{if(m!=="image"){const p=i[m];return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between px-2",children:[e.jsx("span",{className:"text-zinc-500 md:text-xl",children:m.charAt(0).toUpperCase()+m.slice(1)}),e.jsxs("div",{className:"flex justify-between gap-1",children:[c[m]&&(p?e.jsx(_e,{className:"text-red-600 text-xs"}):e.jsx(V,{className:"text-green-600 text-xs"})),e.jsx("span",{className:`text-xs text-center ${p?"text-red-500":"text-green-500"}`,children:c[m].length>0&&(p?"Invalid":"Valid")})]})]}),e.jsx("input",{type:"text",className:`w-[300px] border-2 px-4 py-3 rounded-lg lg:w-[400px] ${p?"border-red-500":""}`,placeholder:`Enter your ${m.charAt(0).toUpperCase()+m.slice(1)}`,value:c[m],onChange:w(m)})]},m)}return null})}),e.jsx("button",{onClick:S,className:"px-10 py-3 bg-sky-500 text-white font-semibold rounded-md hover:bg-sky-600 transition duration-300 mb-10",children:"PROCEED"})]})})]})},me=({navShowSet:s})=>{const[t,n]=a.useState(!0),{currentAdmin:r}=K(m=>m.admin),[x,h]=a.useState(!1),c=xe(),g=ae(),{socket:i}=de(),y=we(),{notificationCount:_,setNotificationCount:N}=de();console.log("side navbar rendering 💕💕💕💕💕💕"),a.useEffect(()=>{s(t)},[s,t]);const k=async()=>{try{(await q.get(`/api/get_admin/${r._id}`)).data.blocked&&(c(rs()),P("You are blocked by the super Admin"))}catch(m){console.log(m)}},w=m=>{console.log(m),N(m),P(`You have ${m} unread messages`,{duration:900})};a.useEffect(()=>(k(),r&&r._id&&(i.emit("join room",r._id),i.on("join room",m=>{console.log(m),console.log("socket connected 📀🔥💕💕💕💕")}),y.pathname!=="/chat_list"&&y.pathname!=="/admin_chat"&&i.on("notify",w)),i.on("incoming-call",m=>{y.pathname!==`/admin_chat?conId=${m.conId}`&&(console.log("emitted on side nave bar....🤷‍♂️🤷‍♂️🤷‍♂️💕💕🔥🔥🔥🔥"),g(`/call_admin_page?conId=${m.conId}&incommingId=${m.incommingId}&callerId=${m.callerId}`))}),()=>{i.off("notify",w)}),[r]),a.useEffect(()=>{const m=()=>{n(window.innerWidth>=768)};return m(),window.addEventListener("resize",m),()=>{window.removeEventListener("resize",m)}},[]);const S=async()=>{const p=await(await fetch("/api/admin_logout")).json();console.log(p),p.message==="success"?c(rs()):P("sigout failed token not cleared")};return e.jsxs("div",{className:"fixed z-20 bg-sky-50 h-full",children:[e.jsxs("div",{className:`flex p-1 gap-1 transition-all duration-300 ${t?"bg-sky-50 w-[250px]":"w-[60px]"}`,children:[e.jsx("img",{className:" rounded bg-sky-500 font-sans w-14 text-center",src:"https://firebasestorage.googleapis.com/v0/b/elite-mediator.appspot.com/o/logo.png?alt=media&token=d632f87d-5330-4f8d-bf5c-67780c74798d",alt:""}),e.jsx("span",{className:`flex justify-center items-center text-2xl transition-all duration-300 whitespace-nowrap ${t?"opacity-100":"opacity-0"}`,children:"ELITE MEDIATOR"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"hidden md:flex justify-center items-center bg-sky-500 rounded-full w-7 h-7 absolute -right-2 cursor-pointer",onClick:()=>n(!t),children:t?e.jsx(us,{className:"text-3xl"}):e.jsx(ut,{className:"text-xs"})}),e.jsx("br",{}),e.jsx("br",{}),e.jsxs("div",{className:"flex flex-col gap-10 items-center justify-center",children:[e.jsxs(W,{to:"/profile",className:`flex gap-5 ${y.pathname==="/profile"||y.pathname==="/editprofile"?"text-black":"text-sky-500"} self-start px-5 hover:text-black cursor-pointer items-center text-xl`,children:[e.jsx("span",{children:e.jsx(ie,{})}),e.jsx("span",{className:`text-sm transition-opacity duration-300 ${t?"opacity-100":"opacity-0 hidden"}`,children:"PROFILE"})]}),e.jsxs(W,{to:"/dashboard",className:`flex gap-5 self-start ${y.pathname==="/dashboard"?"text-black":"text-sky-500"} px-5 hover:text-black cursor-pointer items-center text-xl`,children:[e.jsx("span",{children:e.jsx(ps,{})}),e.jsx("span",{className:`text-sm transition-opacity duration-300 ${t?"opacity-100":"opacity-0 hidden"}`,children:"DASHBOARD"})]}),e.jsxs(W,{to:"/visitors",className:`flex gap-5 self-start px-5 hover:text-black cursor-pointer  items-center text-xl ${y.pathname==="/visitors"?"text-black":"text-sky-500"}`,children:[e.jsx("span",{children:e.jsx(pt,{})}),e.jsx("span",{className:`text-sm transition-opacity duration-300 ${t?"opacity-100":"opacity-0 hidden"}`,children:"ALL USERS"})]}),e.jsxs(W,{to:"/chat_list",onMouseEnter:()=>h(!0),onMouseLeave:()=>h(!1),className:`relative flex gap-5 self-start px-5 hover:text-black cursor-pointer ${y.pathname==="/chat_list"?"text-black":"text-sky-500"} items-center text-xl`,children:[e.jsxs("span",{className:"flex relative",children:[e.jsx(ht,{}),_>0&&e.jsx("span",{className:"absolute -top-2 -right-2 text-white bg-sky-500 rounded-full w-5 h-5 text-sm flex justify-center items-center",children:_})]}),e.jsx("span",{className:`text-sm transition-opacity duration-300 ${t?"opacity-100":"opacity-0 hidden"}`,children:"CHATS"}),_>0&&x&&e.jsxs("span",{className:"absolute w-40 left-12 bottom-12 bg-slate-800 text-white text-xs md:text-sm   rounded-lg py-3 px-5 z-10",children:["You have ",_," unread messages"]})]}),e.jsxs(W,{to:"/qrCodes",className:`flex gap-5 self-start px-5 hover:text-black cursor-pointer ${y.pathname==="/qrCodes"||y.pathname==="/generate_qr"?"text-black":"text-sky-500"} items-center text-xl`,children:[e.jsx("span",{children:e.jsx(ft,{})}),e.jsx("span",{className:`text-sm transition-opacity duration-300 ${t?"opacity-100":"opacity-0 hidden"}`,children:"QR CODE'S"})]}),e.jsxs("div",{className:"flex gap-5 self-start px-5 hover:text-black cursor-pointer text-sky-500 items-center text-xl",onClick:S,children:[e.jsx("span",{children:e.jsx(gt,{})}),e.jsx("span",{className:`text-sm transition-opacity duration-300 ${t?"opacity-100":"opacity-0 hidden"}`,children:"LOGOUT"})]})]})]})]})},ca=()=>{const{currentAdmin:s}=K(h=>h.admin),[t,n]=a.useState(),r=xe(),x=async()=>{const h=await Ve(),g=await(await fetch("/api/admin_add_or_get_fcmtoken",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:h,adminId:s._id})})).json();console.log(g),console.log("fcm updated succesfully ❤️❤️❤️❤️❤️❤️❤️❤️❤️❤️❤️"),g&&r(Ie(g))};return a.useEffect(()=>{x(),(async()=>{const c=await fetch(`/api/get_admin/${s._id}`);if(c.ok){const g=await c.json();console.log(g),n(g)}else console.log("Error fetching admin data")})()},[]),console.log(t),e.jsxs("div",{className:"w-full h-screen flex flex-col relative z-10 overflow-x-hidden",children:[e.jsx("div",{className:"p-6 bg-white shadow-sm",children:e.jsx("h1",{className:"text-3xl font-bold",children:"Account Information"})}),e.jsxs("div",{className:"flex flex-col items-center p-6 overflow-y-auto bg-gray-100 relative z-20",children:[e.jsx("div",{className:"absolute z-0 rounded-2xl -top-14 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-zinc-300 w-40 h-40 lg:w-72 lg:h-72 rotate-45"}),e.jsx("div",{className:"absolute z-0 rounded-2xl left-1/2 lg:-right-10 lg:top-96 transform -translate-x-1/2 -translate-y-1/2 bg-sky-500 w-40 h-40 lg:w-72 lg:h-72 rotate-45"}),e.jsxs("div",{className:"flex flex-col justify-center relative z-20 items-center w-full bg-white rounded-md shadow-md p-6 md:p-8 lg:p-10",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center w-full mb-10 px-10",children:[e.jsx("div",{className:"mb-6 md:mb-0",children:e.jsx("img",{src:t==null?void 0:t.image,alt:"User Icon",className:"h-24 w-24 rounded-full  border-2 md:h-32 md:w-32 lg:h-48 lg:w-48  object-cover"})}),e.jsx(W,{to:"/editprofile",children:e.jsx("div",{className:"flex flex-col md:flex-row text-zinc-400 items-center md:items-end justify-end w-full text-center md:text-right cursor-pointer hover:text-zinc-800",children:e.jsxs("button",{className:"bg-sky-500 text-white px-4 flex py-1 gap-1 rounded lg:py-2 lg:px-4 lg:gap-2",children:[e.jsx("span",{className:"",children:"Edit"}),e.jsx(hs,{className:"self-center"})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-3 xl:grid-cols-2 w-full",children:[e.jsxs("div",{className:"flex flex-col w-full px-2 py-3 md:px-3 md:py-4 lg:px-5 lg:py-5 rounded-md shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 px-2",children:[e.jsx("span",{className:"text-gray-500 text-lg md:text-xl",children:"Name"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(V,{className:"text-green-600 text-sm"}),e.jsx("span",{className:"text-xs text-green-500",children:"Valid"})]})]}),e.jsxs("div",{className:"flex relative",children:[e.jsx(jt,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-lg md:text-xl"}),e.jsx("input",{type:"text",className:"border-2 w-full rounded-md placeholder:text-black placeholder-gray-400 py-2 px-4 md:py-3 md:px-5",placeholder:t&&(t==null?void 0:t.username),disabled:!0})]})]}),e.jsxs("div",{className:"flex flex-col w-full px-2 py-3 md:px-3 md:py-4 lg:px-5 lg:py-5 rounded-md shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 px-2",children:[e.jsx("span",{className:"text-gray-500 text-lg md:text-xl",children:"Email"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(V,{className:"text-green-600 text-sm"}),e.jsx("span",{className:"text-xs text-green-500",children:"Valid"})]})]}),e.jsxs("div",{className:"flex relative",children:[e.jsx(fs,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-lg md:text-xl"}),e.jsx("input",{type:"text",className:"border-2 w-full rounded-md placeholder:text-black placeholder-gray-400 py-2 px-4 md:py-3 md:px-5",placeholder:t&&(t==null?void 0:t.email),disabled:!0})]})]}),e.jsxs("div",{className:"flex flex-col w-full px-2 py-3 md:px-3 md:py-4 lg:px-5 lg:py-5 rounded-md shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 px-2",children:[e.jsx("span",{className:"text-gray-500 text-lg md:text-xl",children:"Address"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(V,{className:"text-green-600 text-sm"}),e.jsx("span",{className:"text-xs text-green-500",children:"Valid"})]})]}),e.jsxs("div",{className:"flex relative",children:[e.jsx(Ue,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-lg md:text-xl"}),e.jsx("input",{type:"text",className:"border-2 w-full rounded-md placeholder:text-black placeholder-gray-400 py-2 px-4 md:py-3 md:px-5",placeholder:t&&(t==null?void 0:t.address),disabled:!0})]})]}),e.jsxs("div",{className:"flex flex-col w-full px-2 py-3 md:px-3 md:py-4 lg:px-5 lg:py-5 rounded-md shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 px-2",children:[e.jsx("span",{className:"text-gray-500 text-lg md:text-xl",children:"Phone"}),e.jsx("div",{className:"flex items-center gap-2",children:t&&(t==null?void 0:t.phone)===91e10?e.jsxs(e.Fragment,{children:[e.jsx(yt,{className:"text-red-600 text-sm"}),e.jsx("span",{className:"text-xs text-red-500",children:"Invalid"})]}):e.jsxs(e.Fragment,{children:[e.jsx(V,{className:"text-green-600 text-sm"}),e.jsx("span",{className:"text-xs text-green-500",children:"Valid"})]})})]}),e.jsxs("div",{className:"flex relative",children:[e.jsx(gs,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-lg md:text-xl"}),e.jsx("input",{type:"text",className:"border-2 w-full rounded-md placeholder:text-black placeholder-gray-400 py-2 px-4 md:py-3 md:px-5",placeholder:t&&(t==null?void 0:t.phone),disabled:!0})]})]}),e.jsxs("div",{className:"flex flex-col w-full px-2 py-3 md:px-3 md:py-4 lg:px-5 lg:py-5 rounded-md shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 px-2",children:[e.jsx("span",{className:"text-gray-500 text-lg md:text-xl",children:"State"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(V,{className:"text-green-600 text-sm"}),e.jsx("span",{className:"text-xs text-green-500",children:"Valid"})]})]}),e.jsxs("div",{className:"flex relative",children:[e.jsx(js,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-lg md:text-xl"}),e.jsx("input",{type:"text",className:"border-2 w-full rounded-md placeholder:text-black placeholder-gray-400 py-2 px-4 md:py-3 md:px-5",placeholder:t&&(t==null?void 0:t.state),disabled:!0})]})]}),e.jsxs("div",{className:"flex flex-col w-full px-2 py-3 md:px-3 md:py-4 lg:px-5 lg:py-5 rounded-md shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 px-2",children:[e.jsx("span",{className:"text-gray-500 text-lg md:text-xl",children:"City"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(V,{className:"text-green-600 text-sm"}),e.jsx("span",{className:"text-xs text-green-500",children:"Valid"})]})]}),e.jsxs("div",{className:"flex relative",children:[e.jsx(Oe,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-lg md:text-xl"}),e.jsx("input",{type:"text",className:"border-2 w-full rounded-md placeholder:text-black placeholder-gray-400 py-2 px-4 md:py-3 md:px-5",placeholder:t&&(t==null?void 0:t.city),disabled:!0})]})]}),e.jsxs("div",{className:"flex flex-col w-full px-2 py-3 md:px-3 md:py-4 lg:px-5 lg:py-5 rounded-md shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 px-2",children:[e.jsx("span",{className:"text-gray-500 text-lg md:text-xl",children:"Landmark"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(V,{className:"text-green-600 text-sm"}),e.jsx("span",{className:"text-xs text-green-500",children:"Valid"})]})]}),e.jsxs("div",{className:"flex relative",children:[e.jsx(Oe,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-lg md:text-xl"}),e.jsx("input",{type:"text",className:"border-2 w-full rounded-md placeholder:text-black placeholder-gray-400 py-2 px-4 md:py-3 md:px-5",placeholder:t&&(t==null?void 0:t.landmark),disabled:!0})]})]}),e.jsxs("div",{className:"flex flex-col w-full px-2 py-3 md:px-3 md:py-4 lg:px-5 lg:py-5 rounded-md shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 px-2",children:[e.jsx("span",{className:"text-gray-500 text-lg md:text-xl",children:"Pincode"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(V,{className:"text-green-600 text-sm"}),e.jsx("span",{className:"text-xs text-green-500",children:"Valid"})]})]}),e.jsxs("div",{className:"flex relative",children:[e.jsx(Oe,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-lg md:text-xl"}),e.jsx("input",{type:"text",className:"border-2 w-full rounded-md placeholder:text-black placeholder-gray-400 py-2 px-4 md:py-3 md:px-5",placeholder:t&&(t==null?void 0:t.pincode),disabled:!0})]})]})]})]})]})]})},ia=()=>{const[s,t]=a.useState(!0);return e.jsxs("div",{className:"flex w-screen",children:[e.jsx(me,{navShowSet:t}),e.jsx("div",{className:`transition-all duration-300 ${s?"w-[250px]":"w-[60px]"}`}),e.jsx("div",{className:"flex-1",children:e.jsx(ca,{})})]})},da=()=>{const[s,t]=a.useState({username:"",email:"",address:"",phone:"",state:"",city:"",image:"",landmark:"",pincode:""}),[n,r]=a.useState(null),{currentAdmin:x}=K(d=>d.admin),h=ae(),c=d=>{d.target.files&&d.target.files[0]&&g(d.target.files[0])},g=async d=>{if(!d){P("No file available to upload.");return}try{const f=he(fe),o=new Date().getTime()+"_"+d.name,E=ye(f,o),u=Ne(E,d);u.on("state_changed",U=>{const G=U.bytesTransferred/U.totalBytes*100;r(G)},U=>{console.log(U),r(null)},()=>{be(u.snapshot.ref).then(U=>{r(null),t(G=>({...G,image:U}))})})}catch{r(null)}};a.useEffect(()=>{(async()=>{const f=await fetch(`/api/get_admin/${x._id}`);if(f.ok){const o=await f.json();t({username:o.username,email:o.email,address:o.address,phone:o.phone,state:o.state,city:o.city,image:o.image,landmark:o.landmark,pincode:o.pincode})}else console.log("Error fetching admin data")})()},[x._id]);const[i,y]=a.useState({username:!0,email:!0,address:!0,phone:!0,state:!0,city:!0,image:!0,landmark:!0,pincode:!0}),_=d=>/\S+@\S+\.\S+/.test(d),N=d=>d.trim()!=="",k=d=>d.trim()!=="",w=d=>/^[0-9]{10}$/.test(d),S=d=>d.trim()!=="",m=d=>d.trim()!=="",p=d=>d.trim()!=="",C=d=>d.length===6,l=(d,f)=>{const o=d.target.value;t({...s,[f]:o});let E=!1;switch(f){case"email":E=_(o);break;case"username":E=N(o);break;case"address":E=k(o);break;case"phone":E=w(o);break;case"state":E=m(o);break;case"city":E=S(o);break;case"landmark":E=p(o);break;case"pincode":E=C(o);break;default:E=o.trim()!==""}y({...i,[f]:E})};console.log(s);const A=async()=>{try{const d=await fetch(`/api/update_admin/${x._id}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}),f=await d.json();d.ok&&f.updated?(h("/profile"),P("Profile data's updated successfully..")):console.log("error updating the profile")}catch(d){console.error("Error updating admin:",d)}};return e.jsxs("div",{className:"w-full h-screen flex flex-col relative z-10",children:[e.jsx("div",{className:"p-6 bg-white shadow-sm",children:e.jsx("h1",{className:"text-xl",children:"Edit Profile"})}),e.jsxs("div",{className:"flex-1 flex flex-col items-center p-6 overflow-y-auto bg-gray-100 relative z-20",children:[e.jsx("div",{className:"absolute z-0 rounded-2xl -top-14 sm:ml-30 md:ml-28 lg:left-20 transform translate-x-1/2 -translate-y-1/2 bg-sky-500 w-40 h-40 lg:w-72 lg:h-72 rotate-45"}),e.jsxs("div",{className:"flex flex-col justify-center items-center w-full bg-white rounded-md shadow-md p-6 md:p-8 lg:p-10 relative z-20",children:[e.jsx("div",{className:"flex flex-col  md:flex-row justify-between items-center w-full mb-10 px-10",children:e.jsxs("div",{className:"mb-6 md:mb-0 relative",children:[e.jsx("label",{htmlFor:"profile-image",className:"cursor-pointer",children:e.jsxs("div",{className:"relative h-24 w-24 md:h-32 md:w-32 lg:h-48 lg:w-48",children:[e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:n&&e.jsx(ms,{value:n,text:`${n}%`,strokeWidth:5,styles:{root:{width:"100%",height:"100%"},path:{stroke:`rgba(62, 152, 199, ${n/100})`}}})}),e.jsx("img",{src:s.image&&s.image,alt:"admin",className:`h-full w-full rounded-full  border-2 object-cover ${n&&n<100&&"opacity-60"}`})]})}),e.jsx("input",{type:"file",accept:"image/*",id:"profile-image",className:"hidden",onChange:c})]})}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 xl:grid-cols-2 w-full",children:[e.jsxs("div",{className:"flex flex-col w-full px-2 py-3 md:px-3 md:py-4 lg:px-5 lg:py-5 rounded-md shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 px-2",children:[e.jsx("span",{className:"text-gray-500 text-lg md:text-xl",children:" Name "}),e.jsxs("div",{className:"flex items-center gap-2",children:[i.username?e.jsx(V,{className:"text-green-600 text-sm"}):e.jsx(pe,{className:"text-red-600 text-sm"}),e.jsxs("span",{className:`text-xs ${i.username?"text-green-500":"text-red-600"}`,children:[" ",i.username?"Valid":"Required"]})]})]}),e.jsxs("div",{className:"flex relative",children:[e.jsx(ie,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-lg md:text-xl"}),e.jsx("input",{type:"text",className:"border-2 w-full rounded-md   placeholder-text-black placeholder-gray-400 py-2 px-4 md:py-3 md:px-5",placeholder:"Enter your username",value:s.username,onChange:d=>l(d,"username")})]})]}),e.jsxs("div",{className:"flex flex-col w-full px-2 py-3 md:px-3 md:py-4 lg:px-5 lg:py-5 rounded-md shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 px-2",children:[e.jsxs("span",{className:"text-gray-500 text-lg md:text-xl",children:[" ","Email"," "]}),e.jsxs("div",{className:"flex items-center gap-2",children:[i.email?e.jsx(V,{className:"text-green-600 text-sm"}):e.jsx(pe,{className:"text-red-600 text-sm"}),e.jsxs("span",{className:`text-xs ${i.email?"text-green-500":"text-red-600"}`,children:[" ",i.email?"Valid":"Required"]})]})]}),e.jsxs("div",{className:"flex relative",children:[e.jsx(fs,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-lg md:text-xl"}),e.jsx("input",{type:"email",className:"border-2 w-full rounded-md placeholder-text-black placeholder-gray-400 py-2 px-4 md:py-3 md:px-5",placeholder:"Enter your email",value:s.email,onChange:d=>l(d,"email")})]})]}),e.jsxs("div",{className:"flex flex-col w-full px-2 py-3 md:px-3 md:py-4 lg:px-5 lg:py-5 rounded-md shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 px-2",children:[e.jsxs("span",{className:"text-gray-500 text-lg md:text-xl",children:[" ","Address"," "]}),e.jsxs("div",{className:"flex items-center gap-2",children:[i.address?e.jsx(V,{className:"text-green-600 text-sm"}):e.jsx(pe,{className:"text-red-600 text-sm"}),e.jsxs("span",{className:`text-xs ${i.address?"text-green-500":"text-red-600"}`,children:[" ",i.address?"Valid":"Required"]})]})]}),e.jsxs("div",{className:"flex relative",children:[e.jsx(js,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-lg md:text-xl"}),e.jsx("input",{type:"text",className:"border-2 w-full rounded-md placeholder-text-black placeholder-gray-400 py-2 px-4 md:py-3 md:px-5",placeholder:"Enter your address",value:s.address,onChange:d=>l(d,"address")})]})]}),e.jsxs("div",{className:"flex flex-col w-full px-2 py-3 md:px-3 md:py-4 lg:px-5 lg:py-5 rounded-md shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 px-2",children:[e.jsxs("span",{className:"text-gray-500 text-lg md:text-xl",children:[" ","Phone"," "]}),e.jsxs("div",{className:"flex items-center gap-2",children:[i.phone?e.jsx(V,{className:"text-green-600 text-sm"}):e.jsx(pe,{className:"text-red-600 text-sm"}),e.jsxs("span",{className:`text-xs ${i.phone?"text-green-500":"text-red-600"}`,children:[" ",i.phone?"Valid":"Required"]})]})]}),e.jsxs("div",{className:"flex relative",children:[e.jsx(gs,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-lg md:text-xl"}),e.jsx("input",{type:"tel",className:"border-2 w-full rounded-md placeholder-text-black placeholder-gray-400 py-2 px-4 md:py-3 md:px-5",placeholder:"Enter your phone number",value:s.phone,onChange:d=>l(d,"phone")})]})]}),e.jsxs("div",{className:"flex flex-col w-full px-2 py-3 md:px-3 md:py-4 lg:px-5 lg:py-5 rounded-md shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 px-2",children:[e.jsxs("span",{className:"text-gray-500 text-lg md:text-xl",children:[" ","State"," "]}),e.jsxs("div",{className:"flex items-center gap-2",children:[i.state?e.jsx(V,{className:"text-green-600 text-sm"}):e.jsx(pe,{className:"text-red-600 text-sm"}),e.jsxs("span",{className:`text-xs ${i.state?"text-green-500":"text-red-600"}`,children:[" ",i.state?"Valid":"Required"]})]})]}),e.jsxs("div",{className:"flex relative",children:[e.jsx(Oe,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-lg md:text-xl"}),e.jsx("input",{type:"text",className:"border-2 w-full rounded-md placeholder-text-black placeholder-gray-400 py-2 px-4 md:py-3 md:px-5",placeholder:"Enter your state",value:s.state,onChange:d=>l(d,"state")})]})]}),e.jsxs("div",{className:"flex flex-col w-full px-2 py-3 md:px-3 md:py-4 lg:px-5 lg:py-5 rounded-md shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 px-2",children:[e.jsx("span",{className:"text-gray-500 text-lg md:text-xl",children:" City "}),e.jsxs("div",{className:"flex items-center gap-2",children:[i.city?e.jsx(V,{className:"text-green-600 text-sm"}):e.jsx(pe,{className:"text-red-600 text-sm"}),e.jsxs("span",{className:`text-xs ${i.city?"text-green-500":"text-red-600"}`,children:[" ",i.city?"Valid":"Required"]})]})]}),e.jsxs("div",{className:"flex relative",children:[e.jsx(Ue,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-lg md:text-xl"}),e.jsx("input",{type:"text",className:"border-2 w-full rounded-md placeholder-text-black placeholder-gray-400 py-2 px-4 md:py-3 md:px-5",placeholder:"Enter your city",value:s.city,onChange:d=>l(d,"city")})]})]}),e.jsxs("div",{className:"flex flex-col w-full px-2 py-3 md:px-3 md:py-4 lg:px-5 lg:py-5 rounded-md shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 px-2",children:[e.jsxs("span",{className:"text-gray-500 text-lg md:text-xl",children:[" ","Pincode"," "]}),e.jsxs("div",{className:"flex items-center gap-2",children:[i.city?e.jsx(V,{className:"text-green-600 text-sm"}):e.jsx(pe,{className:"text-red-600 text-sm"}),e.jsxs("span",{className:`text-xs ${i.pincode?"text-green-500":"text-red-600"}`,children:[" ",i.pincode?"Valid":"Required"]})]})]}),e.jsxs("div",{className:"flex relative",children:[e.jsx(Ue,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-lg md:text-xl"}),e.jsx("input",{type:"text",className:"border-2 w-full rounded-md placeholder-text-black placeholder-gray-400 py-2 px-4 md:py-3 md:px-5",placeholder:"Enter your pincode",value:s.pincode,onChange:d=>l(d,"pincode")})]})]}),e.jsxs("div",{className:"flex flex-col w-full px-2 py-3 md:px-3 md:py-4 lg:px-5 lg:py-5 rounded-md shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 px-2",children:[e.jsxs("span",{className:"text-gray-500 text-lg md:text-xl",children:[" ","Landmark"," "]}),e.jsxs("div",{className:"flex items-center gap-2",children:[i.landmark?e.jsx(V,{className:"text-green-600 text-sm"}):e.jsx(pe,{className:"text-red-600 text-sm"}),e.jsxs("span",{className:`text-xs ${i.landmark?"text-green-500":"text-red-600"}`,children:[" ",i.landmark?"Valid":"Required"]})]})]}),e.jsxs("div",{className:"flex relative",children:[e.jsx(Ue,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-lg md:text-xl"}),e.jsx("input",{type:"text",className:"border-2 w-full rounded-md placeholder-text-black placeholder-gray-400 py-2 px-4 md:py-3 md:px-5",placeholder:"Enter your landmark",value:s.landmark,onChange:d=>l(d,"landmark")})]})]})]}),e.jsx("div",{className:"w-full flex justify-center mt-10",children:e.jsx("button",{onClick:A,className:"bg-sky-500 text-white py-2 px-9 rounded-md",children:"Save"})})]})]})]})},xa=()=>{const[s,t]=a.useState(!0);return e.jsxs("div",{className:"flex w-screen",children:[e.jsx(me,{navShowSet:t}),e.jsx("div",{className:`transition-all duration-300 ${s?"w-[250px]":"w-[60px]"}`}),e.jsx("div",{className:"flex-1",children:e.jsx(da,{})})]})},ma=()=>{const{currentAdmin:s}=K(t=>t.admin);return console.log("💕💕💕💕💕💕💕 private route admin "),s?e.jsx(qe,{}):e.jsx(Ye,{to:"/login"})};We.register(He,Ge,ys,Ns,Qe,Je,Ke);const ua=({data:s})=>{const t={labels:["All Users","Verified Users","Unverified Users","Unknown Users"],datasets:[{label:"User Statistics",data:[s.All,s.verified,s.unVerified,s.unknown],borderColor:"rgb(14 165 233)",backgroundColor:"rgba(75, 192, 192, 0.2)",fill:!1,tension:.1}]},n={responsive:!0,scales:{x:{beginAtZero:!0}},plugins:{legend:{display:!0,position:"top"},title:{display:!0,text:"User Statistics Chart"}}};return e.jsx("div",{children:e.jsx(bs,{data:t,options:n})})};function pa(){const[s,t]=a.useState({}),{currentAdmin:n}=K(l=>l.admin),[r,x]=a.useState(),[h,c]=a.useState(),{socket:g,setIsVideoCall:i}=de(),[y,_]=a.useState(),[N,k]=a.useState(),w=async()=>{try{const A=await(await fetch(`/api/get_calls/${n._id}/1`)).json();console.log(A),A&&(x(A.calls),_(A.totalCalls))}catch(l){console.log(l)}},S=async()=>{try{const l=await q.get("/api/get_users_list",{params:{adminId:n._id}});l.data!=="Empty list"&&c(l.data)}catch(l){l instanceof Error?console.error(`Fetch error: ${l.message}`):console.error("An unknown error occurred")}},m=async()=>{try{const l=await q.get(`/api/admin_dash_graph/${n._id}`);k(l.data)}catch(l){console.log(l)}},p=async(l=!1,A,d,f)=>{try{i(l);const E=await(await fetch("/api/start_call",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({callData:{conversationId:A,callerId:n._id,adminId:n._id,userId:d,caller:"Admin",callType:l?"video":"audio",receiver:"User"},username:n.username,token:f})})).json();E._id&&(console.log("emitted for calling 💕💕💕💕💕💕💕💕💕💕💕💕💕💕💕💕💕💕💕💕"),g.emit("incoming-call",{conId:A,incommingId:n._id,adminId:n._id,callerId:E._id}))}catch(o){console.error("Error starting call:",o)}};console.log(r);function C(l){const A=Math.floor(l/1e3%60),d=Math.floor(l/(1e3*60)%60),f=Math.floor(l/(1e3*60*60)%24),o=A<10?`0${A}`:A.toString(),E=d<10?`0${d}`:d.toString(),u=f<10?`0${f}`:f.toString();return f===0?`${E}:${o}`:`${u}:${E}:${o}`}return a.useEffect(()=>{m(),S(),w(),(async()=>{const A=await fetch(`/api/get_admin/${n._id}`);if(A.ok){const d=await A.json();console.log(d),t(d)}else console.log("Error fetching admin data")})()},[]),e.jsxs("div",{className:"container mx-auto p-4",children:[e.jsx("div",{className:"mb-5",children:e.jsx("h1",{className:"text-3xl font-bold",children:"Dashboard"})}),e.jsxs("div",{className:"flex flex-col gap-5 xl:flex-row",children:[e.jsxs("div",{className:"p-4 w-full lg:w-1/3 border-2 rounded-lg",children:[e.jsx("div",{className:"flex justify-end p-2 cursor-pointer",children:e.jsx(W,{to:"/editprofile",children:e.jsx(hs,{className:"text-xl text-sky-500 hover:text-sky-700"})})}),e.jsx("div",{className:"flex justify-center",children:e.jsx("img",{src:`${s!=null&&s.image?s==null?void 0:s.image:"public/userIcon.webp"}`,alt:"User Icon",className:"rounded-full w-36 h-36 object-cover"})}),e.jsxs("div",{className:"flex flex-col items-center mt-3",children:[e.jsx("h1",{className:"text-xl",children:s==null?void 0:s.username}),e.jsx("p",{className:"text-xs text-zinc-400",children:s==null?void 0:s.email})]}),e.jsx("hr",{className:"w-full mt-4"}),e.jsx("div",{className:"flex justify-start items-center py-3",children:e.jsxs("p",{children:["Address: ",e.jsx("span",{className:"text-xs text-zinc-400",children:s==null?void 0:s.address})]})}),e.jsx("div",{className:"flex justify-start items-center py-3",children:e.jsxs("p",{children:["City: ",e.jsx("span",{className:"text-xs text-zinc-400",children:s==null?void 0:s.city})]})}),e.jsx("div",{className:"flex justify-start items-center py-3",children:e.jsxs("p",{children:["Phone: ",e.jsx("span",{className:"text-xs text-zinc-400",children:s==null?void 0:s.phone})]})})]}),e.jsxs("div",{className:"flex-1 w-full p-4 border-2 rounded-lg lg:w-2/3",children:[e.jsx("div",{className:"mb-3",children:e.jsx("h2",{className:"text-xl font-bold",children:"Your Activity"})}),N&&e.jsx(ua,{data:N})]})]}),e.jsxs("div",{className:"flex flex-col gap-5 mt-5 lg:flex-row",children:[e.jsxs("div",{className:"p-4 w-full lg:w-1/3 border-2 rounded-lg shadow-lg bg-white",children:[e.jsxs("div",{className:"flex justify-between items-center px-5 py-2 border-b cursor-pointer",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Recent Calls"}),e.jsx(W,{to:"/admin_call_List",children:e.jsxs("h3",{className:"text-sky-500 font-bold",children:["(",y&&y,") All"]})})]}),e.jsx("div",{className:"overflow-y-scroll max-h-96",children:r&&r.map(l=>{var A;return e.jsxs("div",{className:"flex items-center h-[70px] rounded-lg justify-between border-b mt-2 p-2 hover:bg-gray-100",children:[e.jsxs("div",{className:"flex flex-col w-2/3",children:[e.jsx("span",{className:"text-xs md:text-sm text-gray-500",children:new Date(l.createdAt).toLocaleString()}),e.jsx("span",{className:"text-sm md:text-lg font-semibold",children:(A=l==null?void 0:l.userId)==null?void 0:A.username}),e.jsxs("div",{className:"flex items-center gap-3 text-xs md:text-sm text-gray-500",children:[l.caller==="Admin"?e.jsx(as,{className:"text-blue-500"}):e.jsx(ls,{className:"text-green-500"}),e.jsx("span",{children:l.caller==="Admin"?"Outgoing":"Incoming"}),e.jsx("span",{children:(l==null?void 0:l.callDuration)&&e.jsxs(e.Fragment,{children:[" Call Duration: ",C(l==null?void 0:l.callDuration)," "]})})]})]}),e.jsxs("div",{className:"flex flex-col items-center gap-1 w-1/3",children:[e.jsx("div",{className:"flex items-center gap-2",children:l.callType==="video"?e.jsx(Ze,{onClick:()=>p(!0,l.conversationId,l.userId._id,l.userId.fcmToken),className:"cursor-pointer text-red-500"}):e.jsx(as,{onClick:()=>p(!1,l.conversationId,l.userId._id,l.userId.fcmToken),className:"cursor-pointer text-green-500"})}),e.jsxs("div",{className:"flex items-center gap-2",children:[l.callStatus==="answered"&&e.jsx(Nt,{className:"text-green-500"}),l.callStatus==="declined"&&e.jsx(bt,{className:"text-red-500"}),l.callStatus!=="answered"&&l.callStatus!=="declined"&&e.jsx(ls,{className:"text-yellow-500"}),e.jsx("span",{className:"text-xs md:text-sm",children:l.callStatus==="answered"?"Answered":l.callStatus==="declined"?"Declined":"Missed"})]})]})]},l._id)})})]}),e.jsxs("div",{className:"flex-1 p-4 border-2 rounded-lg bg-white shadow-lg",children:[e.jsxs("div",{className:"flex justify-between items-center px-5 py-2",children:[e.jsx("h2",{className:"text-lg font-bold lg:text-2xl",children:"Recent Visitors"}),e.jsx(W,{to:"/visitors",children:e.jsxs("p",{className:"text-sky-500 text-sm font-bold hover:bg-sky-500 hover:rounded-full hover:p-2 hover:text-white",children:["(",(h==null?void 0:h.length)||0,") All"]})})]}),e.jsx("hr",{className:"w-full mt-4"}),e.jsx("div",{className:"overflow-y-scroll max-h-96 mt-4",children:h&&h.map(l=>e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 border p-3 rounded-lg gap-4 mb-4 bg-gray-50 shadow-sm",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold",children:"Date"}),e.jsx("p",{children:new Date(l==null?void 0:l.createdAt).toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold",children:"Time"}),e.jsx("p",{children:new Date(l==null?void 0:l.createdAt).toLocaleTimeString()})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold",children:"Name"}),e.jsx("p",{children:l==null?void 0:l.username}),e.jsx("h3",{className:"font-bold mt-2",children:"Purpose"}),e.jsx("p",{children:l==null?void 0:l.purpose}),e.jsx("h3",{className:"font-bold mt-2",children:"Phone"}),e.jsx("p",{children:(l==null?void 0:l.phone)===0?"unknown":l==null?void 0:l.phone})]}),e.jsxs("div",{className:"flex justify-end items-center text-xl p-1 cursor-pointer hover:text-slate-500",children:[e.jsx(ws,{className:"mr-2"}),e.jsx("span",{children:"Delete"})]})]},l._id))})]})]})]})}const ha=()=>{const[s,t]=a.useState(!0);return e.jsxs("div",{className:"flex w-screen",children:[e.jsx(me,{navShowSet:t}),e.jsx("div",{className:`transition-all duration-300 ${s?"w-[250px]":"w-[60px]"}`}),e.jsx("div",{className:"flex-1",children:e.jsx(pa,{})})]})},fa=()=>{const{currentAdmin:s}=K(S=>S.admin),t=ae(),n=s._id+Date.now(),[r,x]=a.useState(),h=window.location.protocol,c=window.location.host,g=`${h}//${c}/new_user?adminId=${s._id}&propId=${n}`,[i,y]=a.useState({adminId:s._id,propId:"",propertyName:"",propertyAddress:"",allowVedioCalls:!1,userType:"Verified",url:"",code:""}),_=async()=>{try{y({...i,url:g,propId:n});const S=await fetch(`/api/generate_code/${s._id}/${n}`);if(S.ok){const m=await S.json();x(m.qrCodeUrl),y(p=>({...p,code:m.qrCodeUrl}))}}catch(S){console.log(S)}},N=S=>{const{name:m,value:p,type:C,checked:l}=S.target;y(A=>({...A,[m]:C==="checkbox"?l:p}))},k=async S=>{S.preventDefault();try{(await fetch("/api/save_property_data",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})).ok&&(console.log("Data saved successfully"),w(),P.success("Property data saved successfully."),t("/qrCodes"))}catch(m){console.log(m)}};console.log(i);const w=()=>{const S=document.createElement("a");S.href=r||"",S.download="qr_code.png",S.click()};return e.jsxs("div",{className:"flex flex-col p-5 bg-gray-50 min-h-screen",children:[e.jsx("div",{className:"flex mt-10 ml-5",children:e.jsx("h1",{className:"text-lg font-bold lg:text-3xl",children:"Generate New Code"})}),e.jsx("div",{className:"flex flex-col border-2 rounded p-5 bg-white shadow-lg mt-5",children:e.jsxs("form",{onSubmit:k,children:[e.jsxs("div",{className:"flex flex-col px-7 pt-10",children:[e.jsx("label",{className:"font-medium",children:"Property Name"}),e.jsx("input",{type:"text",className:"w-full border-2 py-2 px-4 rounded-lg lg:py-3 lg:px-5 focus:outline-none focus:ring-2 focus:ring-sky-500",placeholder:"Enter your property name",name:"propertyName",value:i==null?void 0:i.propertyName,onChange:N,required:!0})]}),e.jsxs("div",{className:"flex flex-col px-7 pt-5",children:[e.jsx("label",{className:"font-medium",children:"Property Address"}),e.jsx("input",{type:"text",className:"w-full border-2 py-2 px-4 rounded-lg lg:py-3 lg:px-5 focus:outline-none focus:ring-2 focus:ring-sky-500",placeholder:"Enter your property address",name:"propertyAddress",value:i==null?void 0:i.propertyAddress,onChange:N,required:!0})]}),e.jsxs("div",{className:"flex justify-between px-7 pt-5 gap-4 flex-col lg:flex-row",children:[e.jsxs("div",{className:"flex flex-col w-full lg:w-1/2",children:[e.jsx("label",{className:"font-medium",children:"User Type"}),e.jsxs("select",{name:"userType",value:i.userType,onChange:N,className:"border-2 rounded-lg py-2 px-4 focus:outline-none focus:ring-2 focus:ring-sky-500",children:[e.jsx("option",{value:"Verified",children:"Verified"}),e.jsx("option",{value:"Unverified",children:"Unverified"}),e.jsx("option",{value:"Unknown",children:"Unknown"})]})]}),e.jsxs("div",{className:"flex flex-col w-full lg:w-1/2",children:[e.jsx("label",{className:"font-medium",children:"Allow Video Calls"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"allowVedioCalls",value:"true",checked:i.allowVedioCalls===!0,onChange:()=>y({...i,allowVedioCalls:!0}),className:"mr-2"}),"Yes"]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"allowVedioCalls",value:"false",checked:i.allowVedioCalls===!1,onChange:()=>y({...i,allowVedioCalls:!1}),className:"mr-2"}),"No"]})]})]})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row justify-evenly items-center px-7 py-7 gap-4",children:[e.jsxs("div",{className:"relative p-3 border-2 rounded-lg",children:[r&&e.jsx("img",{src:r,alt:"QR Code",className:"w-36 h-36"}),e.jsx("label",{htmlFor:"fileInput",className:"absolute inset-0 bg-gray-200 opacity-0 hover:opacity-50 cursor-pointer flex items-center justify-center text-gray-700",children:"Upload QR"})]}),e.jsxs("div",{className:"flex flex-col gap-8 mt-10 lg:mt-0",children:[e.jsx("button",{type:"button",onClick:_,className:"bg-sky-500 text-white text-xs px-2 py-1 gap-1 rounded-lg hover:bg-sky-600 lg:text-lg lg:py-2 lg:px-4 lg:gap-2 flex items-center",children:"GENERATE QR CODE"}),e.jsxs("div",{className:"flex gap-4 lg:gap-8",children:[e.jsx(W,{to:"/qrCodes",type:"button",className:"bg-sky-500 text-white text-xs px-2 py-1 gap-1 rounded-lg hover:bg-sky-600 lg:text-lg lg:py-2 lg:px-8 lg:gap-2 flex items-center",children:"CANCEL"}),e.jsxs("button",{type:"submit",className:"bg-sky-500 text-white text-xs px-2 py-1 gap-1 rounded-lg hover:bg-sky-600 lg:text-lg lg:py-2 lg:px-8 lg:gap-2 flex items-center",children:["SAVE & DOWNLOAD ",e.jsx(wt,{className:"ml-2"})]})]})]})]})]})})]})},ga=()=>{const[s,t]=a.useState(!0);return e.jsxs("div",{className:"flex w-screen",children:[e.jsx(me,{navShowSet:t}),e.jsx("div",{className:`transition-all duration-300 ${s?"w-[250px]":"w-[60px]"}`}),e.jsx("div",{className:"flex-1",children:e.jsx(fa,{})})]})},ja=()=>{const[s,t]=a.useState([]),[n,r]=a.useState(1),[x,h]=a.useState(1),[c,g]=a.useState(""),{currentAdmin:i}=K(j=>j.admin),{setNotificationCount:y,socket:_}=de(),[N,k]=a.useState([]),[w,S]=a.useState(""),[m,p]=a.useState(""),[C,l]=a.useState(""),A=async()=>{try{const j=await q.get("/api/get_conversations_list",{params:{adminId:i._id,page:n,propertyFilter:w,startDate:m,endDate:C}}),I=j.data.conversations;t(I),console.log(s),h(j.data.totalPages);let T=0;I.forEach(M=>{T+=M.lastMessage.unread}),y(T)}catch(j){console.error("Error fetching conversations:",j)}},d=async()=>{try{const I=await(await fetch(`/api/get_admin_property_data_filtering/${i._id}`)).json();console.log(I),k(I)}catch(j){console.log("Error fetching admin properties:",j)}};a.useEffect(()=>{A(),d()},[n,w]),a.useEffect(()=>(_.on("connect",()=>{console.log("Connected to socket server with ID:",_.id)}),_.on("chat message",async(j,I,T)=>{console.log(`Message received in room ${I}: ${j}`);try{await q.put(`/api/conversations/${j.conversationId}`,{lastMessage:{text:j.text,time:j.createdAt}}),_.emit("chat message",j,I,i._id),_.emit("update conversation",T)}catch(M){console.error("Error updating conversation:",M)}}),_.on("update conversation",()=>{A(),console.log("updated the conversation 💕💕💕💕💕💕💕🤷‍♂️🤷‍♂️🤷‍♂️📀📀📀📀📀📀📀📀")}),()=>{_.off("connect"),_.off("chat message"),_.off("update conversation")}),[n,w,m,C]);const f=()=>{r(j=>Math.max(j-1,1))},o=()=>{r(j=>Math.min(j+1,x))},E=j=>{g(j.target.value)},u=s.filter(j=>{var I;return(I=j==null?void 0:j.userId)==null?void 0:I.username.toLowerCase().includes(c.toLowerCase())}),U=j=>{g(""),l(""),p(""),S(j)},G=j=>{let I="",T="";switch(j){case"Unknown":I="bg-gray-600",T="Unknown";break;case"Unverified":I="bg-yellow-500",T="Unverified";break;default:I="bg-green-600",T="Verified";break}return e.jsx("span",{className:`absolute top-0 left-0  ${I} text-white   text-xs font-semibold p-0.5 rounded`,children:T})},D=j=>{const I=j.target.value;new Date(I)>new Date(C)?P.error("Start date cannot be later than end date."):p(I)},$=j=>{const I=j.target.value;new Date(m)>new Date(I)?P.error("End date cannot be earlier than start date."):l(I)},F=()=>{m&&C?(A(),d()):P.error("please select the dates..")};return e.jsxs("div",{className:"bg-gray-50 max-h-screen p-1",children:[e.jsx("div",{className:"absolute z-0 rounded-2xl -top-64 left-1/2 transform -translate-x-1/2 bg-zinc-300 w-60 h-40 lg:h-96 rotate-45"}),e.jsx("div",{className:"relative z-10 flex justify-between items-center p-3",children:e.jsx("h1",{className:"text-2xl font-bold",children:"Chats"})}),e.jsx("div",{className:"relative z-10 p-2 flex flex-col justify-between border-2 rounded bg-white shadow-lg h-full overflow-hidden",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row justify-between bg-sky-500 p-4 rounded",children:[e.jsxs("div",{className:"flex gap-16 lg:gap-16 justify-center items-center px-2 lg:px-5",children:[e.jsx("button",{onClick:()=>U("All"),className:"py-3 bg-white px-4 lg:px-8 text-xs rounded-full hover:bg-sky-300",children:"All chats"}),e.jsx("div",{className:"flex relative",children:e.jsxs("select",{onChange:j=>U(j.target.value),className:"py-3 px-2 bg-white lg:px-16 text-xs rounded-full cursor-pointer",children:[e.jsx("option",{className:"font-bold",value:"",children:"All Properties"}),N&&N.map(j=>e.jsxs("option",{className:`${j.deleted?"text-red-500":"font-bold text-green-500"}`,value:j._id,children:[j.propertyName," ",j.deleted?" -  (Removed)":" -  (Active)"]},j._id))]})})]}),e.jsx("div",{className:"flex flex-col lg:flex-row gap-4 mt-4 lg:mt-0 bg-sky-300 rounded p-3",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center space-y-2 sm:space-y-0 sm:space-x-4",children:[e.jsxs("div",{className:"flex mr-12 pr-4 items-center space-x-2",children:[e.jsx("label",{htmlFor:"start-date",className:"text-xs",children:"Start Date:"}),e.jsx("input",{type:"date",id:"start-date",name:"start-date",value:m,onChange:D,className:"py-2 px-4 rounded-full border border-gray-300 cursor-pointer"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("label",{htmlFor:"end-date",className:"text-xs",children:"End Date:"}),e.jsx("input",{type:"date",id:"end-date",name:"end-date",value:C,onChange:$,className:"py-2 px-4 rounded-full border border-gray-300 cursor-pointer"}),e.jsx("button",{className:"bg-white text-xs p-3 rounded-full font-semibold hover:bg-sky-200 ",onClick:F,children:"Apply"})]})]})})]}),e.jsxs("div",{className:"flex relative",children:[e.jsx("input",{type:"text",className:"p-4 border-2 w-full rounded focus:outline-none focus:ring-2 focus:ring-sky-500",placeholder:"Search...",value:c,onChange:E}),e.jsx(vs,{className:"absolute top-1/2 transform -translate-y-1/2 text-xl right-8"})]}),e.jsx("div",{className:"flex flex-col gap-4 overflow-y-auto h-[380px]",children:u&&u.map(j=>{var I,T,M,Q,L,z,B,H,X;return e.jsx(W,{to:`/admin_chat?conId=${j._id}`,children:e.jsxs("div",{className:"flex items-center justify-between border-2 p-4 rounded hover:bg-gray-100 transition relative",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-full flex justify-center items-center",children:G((I=j==null?void 0:j.propertyId)==null?void 0:I.userType)}),e.jsxs("div",{className:"flex items-center gap-3 relative z-10 mt-3",children:[e.jsx("img",{src:"https://cdn-icons-png.flaticon.com/512/9385/9385289.png",alt:"User",className:"h-14 w-14 rounded-full"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("p",{className:"text-xs text-sky-500 md:text-sm",children:["(",(T=j==null?void 0:j.propertyId)==null?void 0:T.propertyName,")"]}),e.jsx("p",{className:"text-md text-gray-600 font-semibold md:text-xl",children:(M=j==null?void 0:j.userId)==null?void 0:M.username}),e.jsx("p",{className:"text-xs text-gray-400 md:text-sm",children:(L=(Q=j==null?void 0:j.lastMessage)==null?void 0:Q.text)!=null&&L.startsWith("https://")?e.jsxs("div",{className:"flex gap-1 justify-center items-center",children:[e.jsx(vt,{}),"Media"," "]}):(z=j==null?void 0:j.lastMessage)==null?void 0:z.text})]})]}),e.jsxs("div",{className:"flex flex-col justify-center items-center gap-1",children:[e.jsx("span",{className:"text-xs md:text-md",children:new Date((B=j==null?void 0:j.lastMessage)==null?void 0:B.time).toLocaleTimeString()}),((H=j==null?void 0:j.lastMessage)==null?void 0:H.unread)>0&&e.jsx("span",{className:"bg-sky-500 text-white w-6 h-6 rounded-full flex justify-center items-center",children:(X=j==null?void 0:j.lastMessage)==null?void 0:X.unread})]})]})},j._id)})}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("button",{className:"p-2 bg-sky-500 text-white rounded",onClick:f,disabled:n===1,children:e.jsx(ks,{})}),e.jsxs("span",{children:["Page ",n," of ",x]}),e.jsx("button",{className:"p-2 bg-sky-500 text-white rounded",onClick:o,disabled:n===x,children:e.jsx(Ss,{})})]})]})})]})},ya=()=>{const[s,t]=a.useState(!0);return e.jsxs("div",{className:"flex w-screen",children:[e.jsx(me,{navShowSet:t}),e.jsx("div",{className:`transition-all duration-300 ${s?"w-[250px]":"w-[60px]"}`}),e.jsx("div",{className:"flex-1",children:e.jsx(ja,{})})]})},Ws=({onRecordingComplete:s})=>{const[t,n]=a.useState(!1),r=a.useRef(null),x=a.useRef([]),h=()=>{r.current||navigator.mediaDevices.getUserMedia({audio:!0}).then(g=>{r.current=new MediaRecorder(g),r.current.ondataavailable=i=>{i.data.size>0&&(console.log(i.data),s(i.data),x.current.push(i.data))},r.current.start(),n(!0),console.log("Recording started")}).catch(g=>{console.error("Error accessing microphone:",g)})},c=()=>{if(r.current&&r.current.state==="recording"){r.current.stop(),r.current.stream.getTracks().forEach(i=>i.stop()),n(!1);const g=new Blob(x.current,{type:"audio/webm"});console.log("Blob size:",g.size),console.log("Blob:",g),x.current=[],r.current=null}};return e.jsx("div",{children:t?e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:c,children:e.jsx(St,{className:"text-2xl text-red-500"})}),e.jsx(ge,{type:"bars",className:"text-sky-500",height:30,width:30})]}):e.jsx("button",{onClick:h,children:e.jsx(kt,{className:"text-2xl text-sky-500"})})})},Na=()=>{var Z,Ae,ss,ts;const[s,t]=a.useState(null),[n,r]=a.useState([]),[x,h]=a.useState(!0),c=a.useRef(null),{currentAdmin:g}=K(v=>v==null?void 0:v.admin),i=ae(),{socket:y}=de(),[_,N]=a.useState(!1),[k,w]=a.useState(!1),[S,m]=a.useState(""),p=we(),l=new URLSearchParams(p.search).get("conId"),[A,d]=a.useState(),[f,o]=a.useState("text"),[E,u]=a.useState(null),[U,G]=a.useState(!1),[D,$]=a.useState(!1),[F,j]=a.useState({conversationId:l,senderId:g._id,senderModel:"Admin",type:"text",text:""}),I=a.useRef(null),T=v=>{j({...F,text:v.target.value})};a.useEffect(()=>{y.emit("join room",l);const v=R=>{console.log(R),R&&i(`/call_admin_page?conId=${R.conId}&incommingId=${R.incommingId}&callerId=${R.callerId}&videoCall=${R.videoCall}`)};return y.on("incoming-call",v),()=>{y.off("incoming-call",v)}},[l,i,y]);const M=async(v=!1)=>{try{const ee=await(await fetch("/api/start_call",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({callData:{conversationId:l,callerId:g._id,adminId:g._id,userId:s==null?void 0:s.userId._id,caller:"Admin",callType:v?"video":"audio",receiver:"User"},token:s==null?void 0:s.userId.fcmToken,username:g.username})})).json();ee._id&&(console.log("emitted for calling 💕💕💕💕💕💕💕💕💕💕💕💕💕💕💕💕💕💕💕💕"),console.log(ee),y.emit("incoming-call",{conId:l,incommingId:g._id,adminId:g._id,callerId:ee._id,videoCall:v}))}catch(R){console.error("Error starting call:",R)}},Q=async()=>{try{const v=await q.get(`/api/get_admin_messages/${l}`);r(v.data),h(!1),B()}catch(v){console.error("Error fetching messages:",v),h(!1)}},L=async()=>{try{const R=await(await fetch(`/api/selected_conversation/${l}`)).json();t(R),m(R.userId.username)}catch(v){console.error("Error fetching selected conversation:",v)}};a.useEffect(()=>{(async()=>{try{await fetch(`/api/update_conversation_unread_count/${l}`)}catch(ee){console.error("Error updating unread count:",ee)}})(),Q(),L();const R=ee=>{ee.conversationId===l&&r(Se=>[...Se,ee])};return y.emit("update conversation",g._id),y.on("recieve_message",R),()=>{y.off("recieve_message",R)}},[l,g._id,y]);const z=async()=>{var v;console.log(F);try{const R=await q.post("/api/admin_send_message",{messageData:F,token:(v=s==null?void 0:s.userId)==null?void 0:v.fcmToken,username:g.username});y.emit("chat message",R.data,l,g._id),o("text"),d(null),j({...F,type:"text",text:""}),B(),G(!1)}catch(R){console.error("Error sending message:",R)}},B=()=>{var v;(v=c.current)==null||v.scrollIntoView({behavior:"smooth"})},H=v=>{if(v.target.files&&v.target.files[0]){const R=v.target.files[0];if(console.log(v.target.files),R.type.startsWith("image/")||R.type.startsWith("video/")){console.log(R.type),o(R.type),d(R),X(R);return}return oe("Please select an Image or a Video..")}},X=async v=>{if(!v){oe("Please select a file");return}if(v.size>20971520){oe("Maximum limit of the file size you can share is 20MB"),oe("file size is too large select another file.."),o("text"),d(null);return}try{const ee=he(fe),Se=new Date().getTime()+"_"+v.name,Pe=ye(ee,Se),Te=Ne(Pe,v);G(!0),Te.on("state_changed",re=>{const te=re.bytesTransferred/re.totalBytes*100;u(te)},re=>{console.log(re),u(null)},()=>{be(Te.snapshot.ref).then(re=>{u(null),console.log(re),d(re),j(te=>({...te,type:v.type,text:re}))})})}catch{u(null)}};a.useEffect(()=>{B()},[n]);const se=async(v,R)=>{try{await(await fetch("/api/edit_unknown_username",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:v,username:R})})).json()&&(N(!1),L())}catch(ee){console.log(ee)}},b=v=>{const R={hour:"2-digit",minute:"2-digit",hour12:!0};return new Date(v).toLocaleTimeString([],R)},O=async()=>{Le({title:"Clear chat",message:"Do you want to delete all these conversations?",buttons:[{label:"Yes",onClick:async()=>{console.log("Clearing chat clicked"),(await(await fetch(`/api/clear_admin_chat/${l}`)).json()).success&&(Q(),w(!1),oe("All messages deleted successfully...",{autoClose:1e3}))}},{label:"No",onClick:()=>{w(!1)}}]})};console.log(s);const J=20*1024*1024,ue=async v=>{if(!v||v.size===0)return oe.error("Please select an audio file"),null;if(v instanceof File&&v.size>J)return oe.error("Maximum audio file size limit is 20MB"),null;try{$(!0);const R=he(),ee=new Date().getTime()+"_"+(v instanceof File?v.name:"audio.webm"),Se=ye(R,ee),Pe=Ne(Se,v);return G(!0),new Promise((Te,re)=>{Pe.on("state_changed",te=>{const Ks=te.bytesTransferred/te.totalBytes*100;console.log(`Upload is ${Ks}% done`)},te=>{console.error("Error uploading audio:",te),oe.error("Failed to upload audio"),re(te)},async()=>{try{const te=await be(Pe.snapshot.ref);console.log("File available at",te),Te(te)}catch(te){console.error("Error getting download URL:",te),oe.error("Failed to get audio download URL"),re(te)}})})}catch(R){return console.error("Error uploading audio:",R),oe.error("Failed to upload audio"),null}},ve=async v=>{try{const R=await ue(v);R&&(j({...F,text:R,type:v.type}),console.log("Audio URL:",R),o(v),console.log(v.type),d(R),$(!1))}catch(R){console.error("Error handling recording:",R)}},ke=async()=>{d(""),o("text"),j({...F,text:"",type:"text"}),G(!1)},le=v=>{const R=document.createElement("a");R.href=v||"",R.download="image.jpg",R.target="_blank",R.click()};return console.log(s),x?e.jsx("div",{className:"flex justify-center items-center h-full",children:e.jsx(ge,{type:"spin",color:"#000"})}):e.jsxs("div",{className:"h-screen bg-gray-50 flex flex-col",children:[e.jsx(Cs,{}),e.jsxs("div",{className:"border-2 flex flex-col h-full p-4 bg-white shadow-lg relative",children:[e.jsxs("div",{className:"flex justify-between items-center px-5 py-2 border-b-2",children:[e.jsxs("div",{className:"flex gap-5 items-center",children:[e.jsx(W,{to:"/chat_list",children:e.jsx(Ct,{className:"text-xl cursor-pointer"})}),e.jsx("img",{src:"https://cdn-icons-png.flaticon.com/512/9385/9385289.png",className:"w-10 h-10 rounded-full",alt:"User"}),e.jsx("span",{className:"text-xl font-bold flex",children:_?e.jsxs("div",{className:"flex justify-center items-center gap-1 md:gap-2",children:[e.jsx("input",{type:"text",value:S,className:"w-[150px] border-2 rounded md:w-[300px] md:p-1",onChange:v=>m(v.target.value)}),e.jsx("button",{className:"text-xs bg-sky-500 text-white px-1 py-1.5 rounded md:p-2 md:text-sm hover:bg-sky-600",onClick:()=>{var v;return se((v=s==null?void 0:s.userId)==null?void 0:v._id,S)},children:"Save"})]}):e.jsxs("div",{className:"flex justify-center gap-2 items-center text-lg md:text-2xl",children:[(Z=s==null?void 0:s.userId)==null?void 0:Z.username,((Ae=s==null?void 0:s.propertyId)==null?void 0:Ae.userType)==="Unknown"&&e.jsx(_t,{className:"cursor-pointer text-sky-500 hover:text-sky-800",onClick:()=>N(!0)})]})})]}),e.jsxs("div",{className:"flex gap-5 items-center text-lg md:text-2xl text-sky-500",children:[e.jsx(Me,{className:"cursor-pointer hover:text-sky-800",onClick:()=>M(!1)}),s&&s.propertyId.allowVedioCalls&&e.jsx(Ze,{className:"cursor-pointer hover:text-sky-800",onClick:()=>M(!0)}),e.jsx(_s,{className:"cursor-pointer hover:text-sky-800 hover:bg-slate-200 rounded-full hover:text-2xl hover:p-1 md:hover:text-3xl",onClick:()=>w(!k)})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto py-4",children:e.jsxs("div",{className:"flex flex-col gap-4 px-5",children:[n.map(v=>e.jsxs("div",{className:`flex ${v.senderModel==="Admin"?"justify-end":"justify-start"} gap-3`,children:[v.senderModel!=="Admin"&&e.jsx("img",{src:v.senderModel!=="User"?g==null?void 0:g.image:"https://cdn-icons-png.flaticon.com/512/9385/9385289.png",alt:"User",className:"w-10 h-10 rounded-full"}),e.jsxs("div",{className:"flex flex-col max-w-[300px] md:max-w-[350px] lg:max-w-[650px]",children:[e.jsxs("div",{className:"flex justify-between text-xs text-slate-400",children:[e.jsx("span",{children:b(v==null?void 0:v.createdAt)}),e.jsx("span",{children:v.senderModel==="Admin"?e.jsx("span",{className:"text-sky-500 font-bold",children:"You"}):e.jsx("span",{className:"text-sky-500 font-bold",children:s==null?void 0:s.userId.username})})]}),v.type==="text"?e.jsx("div",{className:"p-3 rounded-xl bg-sky-100 text-sm break-words",children:v.text}):e.jsx("div",{className:"p-3 rounded-xl bg-sky-100 text-sm break-words",children:v.type.startsWith("image/")?e.jsxs("div",{className:"relative",children:[e.jsx(Is,{onClick:()=>le(v.text),className:"text-sky-500 hover:text-sky-800 absolute top-0 left-0 text-3xl md:text-5xl cursor-pointer"}),e.jsx("img",{src:v.text,alt:"Shared file",className:"w-[200px] md:w-[500px]"})]}):v.type.startsWith("video/")?e.jsx("video",{className:"w-[200px] md:w-[500px]",controls:!0,children:e.jsx("source",{src:v.text,type:v.type})}):e.jsxs("audio",{className:"w-[200px] h-[60px] md:w-[500px] ",controls:!0,children:[e.jsx("source",{src:v.text,type:"audio/mpeg"}),"Your browser does not support the audio element."]})})]}),v.senderModel==="Admin"&&e.jsx("img",{src:"/public/userIcon.webp",alt:"User",className:"w-10 h-10 rounded-full"})]},v._id)),e.jsx("div",{ref:c})]})}),e.jsxs("div",{className:"flex justify-between items-center px-5 py-2 bg-sky-200 rounded-lg mt-2",children:[!U&&e.jsx(Ws,{onRecordingComplete:ve}),D&&e.jsx(ge,{type:"bubbles",className:"text-sky-500",color:"skyBlue",width:100}),f==="text"&&e.jsx("input",{type:"text",placeholder:"Write something...",className:"flex-1 mx-3 p-2 rounded-lg border bg-sky-100 border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-500",value:F.text,onChange:T,onKeyPress:v=>v.key==="Enter"&&z()}),e.jsxs("div",{className:"flex",children:[E&&E<100?e.jsx(ge,{type:"bubbles",className:"text-sky-500",color:"skyBlue",width:100}):A&&e.jsx(e.Fragment,{children:typeof f=="string"&&f.startsWith("image/")?e.jsx("div",{children:e.jsx("img",{src:A,alt:"Selected file",width:250})}):typeof f=="string"&&f.startsWith("video/")?e.jsx("video",{src:A,width:250,height:400,controls:!0}):e.jsxs("div",{className:"flex gap-1 justify-center items-center",children:[e.jsx("audio",{className:"rounded",src:A,controls:!0}),e.jsx("div",{className:"hover:bg-sky-100 p-3 rounded-full",onClick:ke,children:e.jsx(Es,{className:"text-sky-500 cursor-pointer"})})]})}),e.jsx("input",{type:"file",ref:I,name:"",id:"",onChange:H,hidden:!0}),!U&&e.jsx(It,{onClick:()=>{var v;return(v=I.current)==null?void 0:v.click()},className:"text-sky-500 text-2xl cursor-pointer"})]}),F&&F.text!==""&&e.jsx("div",{className:"p-2 rounded-full bg-sky-500 ml-3 cursor-pointer",onClick:z,children:e.jsx(As,{className:"text-white text-2xl"})})]}),k&&e.jsxs("div",{className:"w-34 h-39 absolute bg-slate-700 opacity-70 right-14 rounded top-12 flex flex-col p-3 gap-4 md:w-40",children:[(s==null?void 0:s.propertyId.userType)!=="Unknown"&&e.jsxs(e.Fragment,{children:[e.jsx("a",{href:`https://wa.me/${(ss=s==null?void 0:s.userId)==null?void 0:ss.phone}`,children:e.jsxs("div",{className:"flex justify-start gap-2  rounded items-center hover:p-1 hover:bg-slate-900 cursor-pointer text-white text-sm md:text-lg",children:[e.jsx(Ps,{className:"text-green-600"})," ",e.jsx("span",{className:"text-sm",children:" Whats app"})]})}),e.jsx("a",{href:`tel:${(ts=s==null?void 0:s.userId)==null?void 0:ts.phone}`,children:e.jsxs("div",{className:"flex justify-start gap-2  rounded items-center hover:p-1 hover:bg-slate-900 cursor-pointer text-white text-sm md:text-lg",children:[e.jsx(Me,{className:"text-green-600"})," ",e.jsx("span",{className:"text-sm",children:s==null?void 0:s.userId.phone})]})})]}),e.jsxs("div",{className:"flex justify-start gap-2  rounded items-center hover:p-1 hover:bg-slate-900 cursor-pointer text-white text-sm md:text-lg",onClick:O,children:[e.jsx(Ts,{className:"text-red-600"})," ",e.jsx("span",{className:"text-sm",children:"Clear chat"})]})]})]})]})},ba=()=>{const[s,t]=a.useState(!0);return e.jsxs("div",{className:"flex w-screen",children:[e.jsx("div",{className:"hidden md:block",children:e.jsx(me,{navShowSet:t})}),e.jsx("div",{className:`hidden md:block transition-all duration-300 ${s?"w-[250px]":"w-[60px]"}`}),e.jsx("div",{className:"flex-1",children:e.jsx(Na,{})})]})},wa={currentUser:null,error:null,loading:!1,messages:[]},Hs=Fe({name:"user",initialState:wa,reducers:{signInSuccess:(s,t)=>{s.currentUser=t.payload,s.loading=!1,s.error=null},setMessages:(s,t)=>{s.messages=Array.isArray(t.payload)?t.payload:[]},signoutSuccess:s=>{s.currentUser=null,s.error=null,s.loading=!1,s.messages=[]}}}),{signInSuccess:Ee,setMessages:ns,signoutSuccess:Gs}=Hs.actions,va=Hs.reducer,ka=()=>{const{currentUser:s}=K(o=>o.user),[t,n]=a.useState(),[r,x]=a.useState(""),h=ae(),c=xe(),i=new URLSearchParams(we().search),y=i.get("adminId"),_=i.get("propId"),[N,k]=a.useState({adminId:y||"",propId:(t==null?void 0:t._id)||"",username:"",purpose:"",phone:"",verified:!1,firebaseCode:""}),w=()=>{let o=localStorage.getItem("mac-id");return o||(o=Et(),localStorage.setItem("mac-id",o)),o},S=0,m=async o=>{try{const E=await fetch("/user/create_unknown_user_data",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({adminId:y,propId:o,username:"Unknown",purpose:"Unknown contact",phone:S,firebaseCode:"0000000000",verified:!0,macId:r})});if(E.ok){const u=await E.json();if(u)try{const U=await q.post("/user/start_conversation",{userId:u._id,adminId:u.adminId,propertyId:o});U.data&&(P("Successful!"),c(Ee(U.data.user)),h(`/chat_user?conId=${U.data.user.conversationId}`))}catch{}}else throw new Error("Failed to create unknown user")}catch{P.error("Failed to create unknown user. Please try again.")}};a.useEffect(()=>{const o=w();o&&x(o),(async()=>{try{const u=await fetch("/user/get_admins_property_data",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({propId:_,adminId:y})});if(u.ok){const U=await u.json();k({...N,propId:U._id}),n(U),s&&s.propId._id===U._id?(P("You have an old chat list here"),h(`/chat_user?conId=${s.conversationId}`)):(c(Gs()),U.userType==="Unknown"&&!U.deleted&&r!==""&&m(U._id))}else throw new Error("Failed to fetch property data")}catch{P.error("Failed to fetch property data. Please try again.")}})()},[r]);const p=o=>{const{name:E,value:u}=o.target;k(U=>({...U,[E]:u}))},C=o=>{k(E=>({...E,phone:o}))},l=()=>N.username&&N.purpose&&N.phone,A=async()=>{if(!l())return P.error("Please fill out all fields.");if((t==null?void 0:t.userType)==="Unverified"){console.log("unverified user clicked 🔥🔥🔥🔥");const o=await fetch("/user/create_unverified_user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(N)});if(!o.ok)throw new Error("Network response was not ok");const E=await o.json();if(E)try{const u=await q.post("/user/start_conversation",{userId:E._id,adminId:E.adminId._id,propertyId:t==null?void 0:t._id});u.data&&(P("successful!"),c(Ee(u.data.user)),h(`/chat_user?conId=${u.data.user.conversationId}`),console.log(u.data.user))}catch{}}else(t==null?void 0:t.userType)==="Verified"&&f()},d=async o=>{try{const E=await fetch("/user/create_verified_user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(!E.ok)throw new Error("Network response was not ok");const u=await E.json();console.log(u),u._id&&h(`/user_verify_otp_page/${u._id}`)}catch{P.error("Something went wrong. Please try again.")}},f=async()=>{if(!l())return P.error("Please fill out all fields.");try{const o=new Re(ne,"recaptcha",{}),E="+"+N.phone,u=await $e(ne,E,o);if(u){const U=N.phone+""+Date.now(),G={...N,userId:U,firebaseCode:u.verificationId};k(G),d(G)}}catch{P.error("Failed to send OTP. Please try again.")}};return console.log(N),console.log(t),e.jsxs("div",{className:"relative min-h-screen flex flex-col items-center justify-center bg-gray-100 p-4",children:[e.jsx("div",{className:"absolute z-0 rounded-2xl -top-40 left-1/2 transform -translate-x-1/2 bg-sky-500 w-60 h-40 lg:h-96 rotate-45"}),e.jsx("div",{className:"w-full flex justify-end p-4",children:e.jsx("button",{className:"bg-sky-500 py-2 px-3 rounded text-white hover:bg-sky-700",children:"Register"})}),e.jsx("div",{className:"w-full max-w-4xl mx-auto p-4 lg:px-16",children:e.jsxs("div",{className:"p-6 lg:p-10 flex flex-col justify-center items-center rounded relative z-10 border-2 bg-white gap-5 shadow-md",children:[e.jsx("h1",{className:"uppercase text-lg lg:text-2xl text-center font-bold tracking-wider",children:"Enter User Details"}),e.jsxs("div",{className:"flex flex-col gap-4 lg:gap-8",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex justify-between px-2 lg:px-10",children:[e.jsx("span",{children:"Name"}),(N==null?void 0:N.username)&&e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(V,{className:"text-green-600 text-xs"}),e.jsx("span",{children:"Valid"})]})]}),e.jsx("input",{type:"text",onChange:p,value:N==null?void 0:N.username,name:"username",className:"rounded border-2 w-full px-5 lg:w-[600px] py-3 placeholder:font-semibold placeholder:px-2 lg:placeholder:px-6",placeholder:"Enter your name"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex justify-between px-2 lg:px-10",children:[e.jsx("span",{children:"Purpose"}),(N==null?void 0:N.purpose)&&e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(V,{className:"text-green-600 text-xs"}),e.jsx("span",{children:"Valid"})]})]}),e.jsx("input",{type:"text",onChange:p,value:N==null?void 0:N.purpose,name:"purpose",className:"rounded border-2 w-full px-5 lg:w-[600px] py-3 placeholder:font-semibold placeholder:px-2 lg:placeholder:px-6",placeholder:"Enter purpose of contacting"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex justify-between px-2 lg:px-10",children:[e.jsx("span",{children:"Phone"}),N.phone&&e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(V,{className:"text-green-600 text-xs"}),e.jsx("span",{children:"Valid"})]})]}),e.jsx(cs,{country:"in",value:N==null?void 0:N.phone,onChange:C,containerClass:"rounded border-2 w-full px-5 lg:w-[600px] py-3 placeholder:font-semibold placeholder:px-2 lg:placeholder:px-6",inputClass:"w-full",placeholder:"Enter your phone"})]})]}),e.jsx("div",{id:"recaptcha",className:"recaptcha"}),e.jsx("div",{children:e.jsx("button",{className:"bg-sky-500 py-2 px-4 rounded text-white hover:bg-sky-700",onClick:A,disabled:!l(),children:"Proceed"})})]})})]})},Sa=()=>{const[s,t]=a.useState(new Array(6).fill("")),[n,r]=a.useState(30),[x,h]=a.useState(null),c=is(),g=ae(),i=xe();a.useEffect(()=>{if(n>0){const k=setTimeout(()=>r(n-1),1e3);return()=>clearTimeout(k)}},[n]),a.useEffect(()=>{(async()=>{try{const w=await fetch(`/user/get_user_by_id/${c.id}`);if(w.ok){const S=await w.json();h(S)}else console.log("Error fetching user data:",w.status)}catch(w){console.log("Error fetching user data:",w)}})()},[c.id]);const y=(k,w)=>{if(isNaN(Number(k.value)))return;const S=[...s];S[w]=k.value,t(S),k.nextSibling&&k.value!==""&&k.nextSibling.focus()},_=async()=>{r(60);try{const k=new Re(ne,"recaptcha",{}),w=await $e(ne,"+"+(x==null?void 0:x.phone),k);if(w){console.log(w);const S=await fetch("/user/user_update_firebase_verify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({firebaseConfirm:w.verificationId,phone:x==null?void 0:x.phone})});if(S.ok){const m=await S.json();h(m),P("OTP resended successfully")}else console.log("Error updating firebase verification:",S.status)}else console.log("Error confirming the captcha.")}catch(k){console.log("Error resending OTP:",k)}},N=async()=>{const k=s.join(""),w=x==null?void 0:x.firebaseCode;if(!w){console.log("Verification ID is missing.");return}try{const S=ds.credential(w,k),m=await xs(ne,S);if(console.log("Verification result:",m),m){P("OTP verification successful!");try{if(!(x!=null&&x._id)){console.log("User ID is missing.");return}const p=await fetch(`/user/user_update_verify/${x._id}`,{method:"POST"});if(p.ok){const C=await p.json();if(h(C),console.log("Verification update response data:",C),C)try{const l=await q.post("/user/start_conversation",{userId:C._id,adminId:C.adminId,propertyId:C.propId});l.data&&(console.log("Conversation created:",l.data),P("OTP verification successful!"),i(Ee(l.data.user)),g(`/chat_user?conId=${l.data.user.conversationId}`))}catch(l){console.error("Error starting conversation:",l)}else C!=null&&C.conversationId&&(i(Ee(C)),g(`/chat_user?conId=${C.conversationId}`))}else{const C=await p.text();console.log("Error updating verification status:",p.statusText,C),P("Error updating verification status")}}catch(p){console.log("Error during verification update:",p),P("Error during verification update")}}else return P("verification failed")}catch(S){S.code==="auth/code-expired"?P("The OTP has expired. Please request a new one."):S.code==="auth/invalid-verification-code"?P("The OTP entered is invalid. Please try again."):alert("Error verifying OTP. Please try again."),console.log("Error verifying OTP:",S)}};return console.log(s),e.jsx("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gray-100 p-4",children:e.jsxs("div",{className:"bg-white shadow-lg rounded-lg p-8 max-w-sm w-full",children:[e.jsx("div",{className:"flex justify-center mb-6",children:e.jsx("img",{src:"/public/otpverify.jpg",alt:"OTP Icon",className:"w-50 h-60 object-cover"})}),e.jsx("h2",{className:"text-center text-lg font-semibold mb-4",children:"Enter the OTP sent to your mobile"}),e.jsx("div",{className:"flex justify-center mb-4 space-x-2",children:s.map((k,w)=>e.jsx("input",{type:"text",name:"otp",maxLength:1,className:"w-12 h-12 text-center text-lg border border-gray-300 rounded-md focus:ring-2 focus:ring-sky-500 focus:border-transparent",value:k,onChange:S=>y(S.target,w),onFocus:S=>S.target.select()},w))}),e.jsx("button",{onClick:N,className:"w-full py-2 bg-sky-500 text-white font-semibold rounded-md hover:bg-sky-600 transition duration-300",children:"Verify"}),e.jsx("div",{className:"mt-4 flex justify-center",children:e.jsx("button",{disabled:n!==0,onClick:_,className:"text-sky-500 underline",children:n===0?"Resend OTP":`Resend OTP in ${n} seconds`})}),e.jsx("div",{id:"recaptcha"})]})})},Ca=()=>{const{currentUser:s}=K(t=>t.user);return s?e.jsx(qe,{}):e.jsx(Ye,{to:"/"})},_a=()=>{const{socket:s}=de(),t=ae();let n=a.useRef(),r=a.useRef();const{currentAdmin:x}=K(j=>j.admin),[h,c]=a.useState(""),g=we(),i=new URLSearchParams(g.search),y=i.get("conId"),_=i.get("incommingId"),N=i.get("callerId"),w=i.get("videoCall")==="true",[S,m]=a.useState(!1),[p,C]=a.useState(0),[l,A]=a.useState(!1),[d,f]=a.useState(!0);let o=a.useRef(null);a.useEffect(()=>{s.emit("join room",y);const j=setInterval(()=>{C(I=>I+1)},1e3);return()=>clearInterval(j)},[]);const E=j=>{const I=`0${j%60}`.slice(-2),M=`0${`${Math.floor(j/60)}`%60}`.slice(-2);return`${`0${Math.floor(j/3600)}`.slice(-2)}:${M}:${I}`},u=async()=>{try{const I=await(await fetch(`/api/selected_conversation/${y}`)).json();c(I.userId.username),console.log(I)}catch(j){console.log(j)}},U=()=>{if(n.current&&n.current.srcObject){const j=n.current.srcObject;console.log(j),j.getAudioTracks().forEach(I=>{I.enabled=!I.enabled}),m(I=>!I)}},G=async j=>{try{const I=await fetch(`/api/decline_call/${j}`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!I.ok)throw new Error(`HTTP error! status: ${I.status}`);const T=await I.json();console.log(T)}catch(I){console.error("Error updating call status:",I)}},D=async j=>{try{const I=await fetch(`/api/accept_call/${j}`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!I.ok)throw new Error(`HTTP error! status: ${I.status}`);const T=await I.json();console.log(T)}catch(I){console.error("Error updating call status:",I)}},$=async j=>{try{const I=await fetch(`/api/disconnect_call/${j}`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!I.ok)throw new Error(`HTTP error! status: ${I.status}`);const T=await I.json();console.log(T)}catch(I){console.error("Error updating call status:",I)}};a.useEffect(()=>{o.current||(o.current=new RTCPeerConnection({iceServers:[{urls:"stun:stun.l.google.com:19302"}]})),u(),s.emit("join room",y);const j=async()=>{var L,z;try{const B={audio:!0,video:w},H=await navigator.mediaDevices.getUserMedia(B);H.getTracks().forEach(se=>{var b;return(b=o==null?void 0:o.current)==null?void 0:b.addTrack(se,H)}),n.current&&(n.current.srcObject=H);const X=await((L=o==null?void 0:o.current)==null?void 0:L.createOffer());await((z=o==null?void 0:o.current)==null?void 0:z.setLocalDescription(X)),s.emit("webrtc-offer",{incommingId:x.username,room:y,isVideo:w,offer:X,callerId:N})}catch(B){console.error("Error creating offer:",B)}};console.log(_+"  "+x.username),_===x._id&&j();const I=async L=>{console.log("handling offer 💕💕💕💕💕💕"),L.incommingId!==x.username&&Le({title:"Incoming Call",message:`You have a call from ${L.incommingId}. Do you want to accept the call?`,buttons:[{label:"Yes",onClick:async()=>{var X,se,b;const z={audio:!0,video:L.isVideo},B=await navigator.mediaDevices.getUserMedia(z);B.getTracks().forEach(O=>{var J;return(J=o==null?void 0:o.current)==null?void 0:J.addTrack(O,B)}),n.current&&(n.current.srcObject=B),await((X=o==null?void 0:o.current)==null?void 0:X.setRemoteDescription(new RTCSessionDescription(L.offer)));const H=await((se=o==null?void 0:o.current)==null?void 0:se.createAnswer());await((b=o==null?void 0:o.current)==null?void 0:b.setLocalDescription(H)),s.emit("webrtc-answer",{room:y,answer:H,incommingId:x.username,callerId:N}),D(L.callerId)}},{label:"No",onClick:async()=>{s.emit("webrtc-disconnect",y,N),G(L.callerId)}}]})},T=async L=>{var H,X,se;console.log("handling answer 💕💕💕💕💕💕");const{incommingId:z,answer:B}=L;if(x.username!==z)if(((H=o==null?void 0:o.current)==null?void 0:H.signalingState)==="have-local-offer")try{await((X=o==null?void 0:o.current)==null?void 0:X.setRemoteDescription(new RTCSessionDescription(B)))}catch(b){console.error("Error setting remote description:",b)}else console.warn("Signaling state is not 'have-local-offer'. Current state: ",(se=o==null?void 0:o.current)==null?void 0:se.signalingState)},M=async L=>{var z;console.log("handling icecandidate 💕💕💕💕💕💕");try{await((z=o==null?void 0:o.current)==null?void 0:z.addIceCandidate(new RTCIceCandidate(L)))}catch(B){console.error("Error adding received ice candidate",B)}},Q=L=>{A(!1),n.current&&n.current.srcObject&&(n.current.srcObject.getTracks().forEach(B=>B.stop()),n.current.srcObject=null),o.current&&(o.current.getSenders().forEach(z=>z.track&&z.track.stop()),o.current.close(),o.current=new RTCPeerConnection({iceServers:[{urls:"stun:stun.l.google.com:19302"}]})),r.current&&(r.current.srcObject=null),s.off("webrtc-offer",I),s.off("webrtc-answer",T),s.off("webrtc-ice-candidate",M),t(`/admin_chat?conId=${L}`)};return s.on("webrtc-offer",I),s.on("webrtc-answer",T),s.on("webrtc-ice-candidate",M),s.on("webrtc-disconnect",Q),o.current.onicecandidate=L=>{L.candidate&&s.emit("webrtc-ice-candidate",{room:y,candidate:L.candidate})},o.current.ontrack=L=>{L.streams&&L.streams.length>0&&(f(!1),A(!0),r.current.srcObject=L.streams[0],console.log(n),console.log(r))},()=>{s.off("webrtc-offer"),s.off("webrtc-answer"),s.off("webrtc-ice-candidate"),s.off("webrtc-disconnect")}},[y,x.username,s]);const F=()=>{n.current&&n.current.srcObject&&(n.current.srcObject.getTracks().forEach(I=>I.stop()),n.current.srcObject=null),o.current&&(o.current.getSenders().forEach(j=>j.track&&j.track.stop()),o.current.close()),s.emit("webrtc-disconnect",y,N),s.off("webrtc-offer"),s.off("webrtc-answer"),s.off("webrtc-ice-candidate"),r.current&&(r.current.srcObject=null),t(`/admin_chat?conId=${y}`),$(N)};return e.jsxs("div",{className:"flex flex-col gap-y-5 p-9",children:[e.jsxs("div",{className:"flex flex-col gap-5 mb-10",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("h3",{className:"text-2xl font-bold",children:"Connected"})}),e.jsx("div",{className:"flex justify-center",children:w?e.jsxs("div",{className:"flex flex-col justify-center items-center relative",children:[e.jsx("video",{ref:n,autoPlay:!0,muted:!0,className:"w-1/4 absolute bottom-4 z-10 right-4 md:right-16 md:bottom-4 md:w-[250px] border-2 border-white"}),e.jsx("video",{ref:r,autoPlay:!0,className:"w-full h-full md:w-[900px] md:h-[700px] border-2 border-white"})]}):e.jsxs("div",{className:"flex flex-col justify-center items-center",children:[e.jsx("div",{className:`w-52 h-52 rounded-full flex justify-center items-center ${l&&" bg-green-300"}`,children:e.jsx("div",{className:"w-48 h-48 bg-sky-500 rounded-full flex justify-center items-center",children:e.jsx(Us,{className:"text-white text-9xl p-2"})})}),e.jsxs("div",{className:"w-[50px] h-[50px]",children:[e.jsx("video",{ref:n,autoPlay:!0,muted:!0}),e.jsx("video",{ref:r,autoPlay:!0})]})]})}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("h2",{className:"font-bold text-3xl text-sky-500",children:h}),d&&d?e.jsx("p",{children:"Calling...."}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-green-600",children:"Connected"}),e.jsxs("p",{children:["Call Duration: ",l?E(p):"00:00:00"]})]})]})})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("div",{className:"flex justify-center px-16",children:e.jsx("button",{className:"flex justify-center p-2 items-center hover:rounded-full hover:bg-slate-100",onClick:U,children:S?e.jsx(Os,{className:"text-zinc-500 text-6xl"}):e.jsx(Rs,{className:"text-zinc-500 text-6xl"})})}),e.jsx("div",{className:"flex justify-center mt-4",children:e.jsx("button",{onClick:F,className:"flex justify-center items-center w-20 h-20 bg-red-400 rounded-full hover:bg-red-800",children:e.jsx($s,{className:"text-white text-5xl"})})})]})]})},Ia=()=>{const s=ae(),{currentUser:t}=K(D=>D.user),n=we(),r=new URLSearchParams(n.search),x=r.get("conId"),h=r.get("incommingId"),c=r.get("callerId"),i=r.get("videoCall")==="true",{socket:y}=de(),[_,N]=a.useState(!1),[k,w]=a.useState(0),[S,m]=a.useState(!1),[p,C]=a.useState(!0),l=a.useRef(null),A=a.useRef(null);let d=a.useRef(null);a.useEffect(()=>{const D=setInterval(()=>{w($=>$+1)},1e3);return()=>clearInterval(D)},[]);const f=D=>{const $=`0${D%60}`.slice(-2),j=`0${`${Math.floor(D/60)}`%60}`.slice(-2);return`${`0${Math.floor(D/3600)}`.slice(-2)}:${j}:${$}`},o=()=>{if(console.log("localVideoRef.current:",l.current),l.current){const D=l.current.srcObject;if(D){const $=D.getAudioTracks();$.length>0?($.forEach(F=>{F.enabled=!F.enabled}),N(F=>!F),console.log("Mute toggled:",!_)):console.log("No audio tracks found in local stream")}else console.log("localStream is null or undefined")}else console.log("localVideoRef is null or undefined")};a.useEffect(()=>{d.current||(d.current=new RTCPeerConnection({iceServers:[{urls:"stun:stun.l.google.com:19302"}]})),y.emit("join room",x);const D=async()=>{var T,M;try{const Q={audio:!0,video:i},L=await navigator.mediaDevices.getUserMedia(Q);L.getTracks().forEach(B=>{var H;return(H=d==null?void 0:d.current)==null?void 0:H.addTrack(B,L)}),l.current&&(l.current.srcObject=L,console.log("Stream assigned to localVideoRef"));const z=await((T=d==null?void 0:d.current)==null?void 0:T.createOffer());await((M=d==null?void 0:d.current)==null?void 0:M.setLocalDescription(z)),y.emit("webrtc-offer",{incommingId:t.username,room:x,isVideo:i,offer:z,callerId:c})}catch(Q){console.error("Error creating offer:",Q)}};h===t._id&&D();const $=async T=>{console.log(T),T.incommingId!==t.username&&Le({title:"Incoming Call",message:`You have a call from ${T.incommingId}. Do you want to accept the call?`,buttons:[{label:"Yes",onClick:async()=>{var M,Q,L;try{u(T.callerId);const z={audio:!0,video:T.isVideo},B=await navigator.mediaDevices.getUserMedia(z);B.getTracks().forEach(X=>{var se;return(se=d==null?void 0:d.current)==null?void 0:se.addTrack(X,B)}),l.current&&(l.current.srcObject=B,console.log("Stream assigned to localVideoRef on offer acceptance")),console.log(l),await((M=d==null?void 0:d.current)==null?void 0:M.setRemoteDescription(new RTCSessionDescription(T.offer)));const H=await((Q=d==null?void 0:d.current)==null?void 0:Q.createAnswer());await((L=d==null?void 0:d.current)==null?void 0:L.setLocalDescription(H)),y.emit("webrtc-answer",{room:x,answer:H,incommingId:t.username,callerId:T.callerId})}catch(z){console.error("Error handling offer acceptance:",z)}}},{label:"No",onClick:()=>{try{s(`/chat_user?conId=${x}`),E(T.callerId),y.emit("webrtc-disconnect",x,T.callerId)}catch(M){console.error("Error handling offer rejection:",M)}}}]})},F=async T=>{var L,z,B;const{incommingId:M,answer:Q}=T;if(t.username!==M)if(((L=d==null?void 0:d.current)==null?void 0:L.signalingState)==="have-local-offer")try{await((z=d==null?void 0:d.current)==null?void 0:z.setRemoteDescription(new RTCSessionDescription(Q)))}catch(H){console.error("Error setting remote description:",H)}else console.warn("Signaling state is not 'have-local-offer'. Current state: ",(B=d==null?void 0:d.current)==null?void 0:B.signalingState)},j=async T=>{var M;try{await((M=d==null?void 0:d.current)==null?void 0:M.addIceCandidate(new RTCIceCandidate(T))),console.log(l),console.log(A)}catch(Q){console.error("Error adding received ice candidate",Q)}},I=T=>{l.current&&l.current.srcObject&&(l.current.srcObject.getTracks().forEach(Q=>Q.stop()),l.current.srcObject=null),d.current&&(d.current.getSenders().forEach(M=>M.track&&M.track.stop()),d.current.close(),d.current=new RTCPeerConnection({iceServers:[{urls:"stun:stun.l.google.com:19302"}]})),A.current&&(A.current.srcObject=null),y.off("webrtc-offer",$),y.off("webrtc-answer",F),y.off("webrtc-ice-candidate",j),s(`/chat_user?conId=${T}`)};return y.on("webrtc-offer",$),y.on("webrtc-answer",F),y.on("webrtc-ice-candidate",j),y.on("webrtc-disconnect",I),d.current.onicecandidate=T=>{T.candidate&&y.emit("webrtc-ice-candidate",{room:x,candidate:T.candidate})},d.current.ontrack=T=>{T.streams&&T.streams.length>0&&(C(!1),m(!0),A.current.srcObject=T.streams[0])},()=>{y.off("webrtc-offer",$),y.off("webrtc-answer",F),y.off("webrtc-ice-candidate",j),y.off("webrtc-disconnect",I)}},[x,t.username,i]);const E=async D=>{try{const $=await fetch(`/api/decline_call/${D}`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!$.ok)throw new Error(`HTTP error! status: ${$.status}`);const F=await $.json();console.log(F)}catch($){console.error("Error updating call status:",$)}},u=async D=>{try{const $=await fetch(`/api/accept_call/${D}`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!$.ok)throw new Error(`HTTP error! status: ${$.status}`);const F=await $.json();console.log(F)}catch($){console.error("Error updating call status:",$)}},U=async D=>{try{const $=await fetch(`/api/disconnect_call/${D}`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!$.ok)throw new Error(`HTTP error! status: ${$.status}`);const F=await $.json();console.log(F)}catch($){console.error("Error updating call status:",$)}},G=()=>{l.current&&l.current.srcObject&&(l.current.srcObject.getTracks().forEach($=>$.stop()),l.current.srcObject=null),d.current&&(d.current.getSenders().forEach(D=>D.track&&D.track.stop()),d.current.close()),y.emit("webrtc-disconnect",x,c),y.off("webrtc-offer"),y.off("webrtc-answer"),y.off("webrtc-ice-candidate"),A.current&&(A.current.srcObject=null),s(`/chat_user?conId=${x}`),U(c)};return e.jsxs("div",{children:[e.jsx(Cs,{}),e.jsxs("div",{className:"flex flex-col gap-y-16 p-9",children:[e.jsxs("div",{className:"flex flex-col gap-5 mb-10",children:[e.jsx("div",{className:"flex justify-center",children:p&&p?e.jsx("h3",{className:"text-2xl font-bold",children:"Calling...."}):e.jsx("h3",{className:"text-2xl font-bold",children:"Connected"})}),e.jsx("div",{className:"flex justify-center",children:i?e.jsxs("div",{className:"flex flex-col justify-center items-center relative",children:[e.jsx("video",{ref:l,autoPlay:!0,muted:!0,className:"w-1/4 absolute bottom-4 z-10 right-4 md:right-16 md:bottom-4 md:w-[250px] border-2 border-white"}),e.jsx("video",{ref:A,autoPlay:!0,className:"w-full h-full md:w-[900px] md:h-[700px] border-2 border-white"})]}):e.jsxs("div",{className:"flex flex-col justify-center items-center",children:[e.jsx("div",{className:`w-52 h-52 rounded-full flex justify-center items-center ${S&&" bg-green-300"}`,children:e.jsx("div",{className:"w-48 h-48 bg-sky-500 rounded-full flex justify-center items-center",children:e.jsx(Us,{className:"text-white text-9xl p-2"})})}),e.jsxs("div",{className:"w-[50px] h-[50px]",children:[e.jsx("video",{ref:l,autoPlay:!0,muted:!0}),e.jsx("video",{ref:A,autoPlay:!0})]})]})}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("h2",{className:"font-bold text-3xl text-sky-500",children:"Arjun Kumar VS"}),p&&p?e.jsx("p",{children:"Calling...."}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-green-600",children:"Connected"}),e.jsxs("p",{children:["Call Duration: ",S?f(k):"00:00:00"]})]})]})})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("div",{className:"flex justify-center px-16",children:e.jsx("button",{className:"flex justify-center p-2 items-center hover:rounded-full hover:bg-slate-100",onClick:o,children:_?e.jsx(Os,{className:"text-zinc-500 text-6xl"}):e.jsx(Rs,{className:"text-zinc-500 text-6xl"})})}),e.jsx("div",{className:"flex justify-center mt-4",children:e.jsx("button",{onClick:G,className:"flex justify-center items-center w-20 h-20 bg-red-400 rounded-full hover:bg-red-800",children:e.jsx($s,{className:"text-white text-5xl"})})})]})]})]})},Ea=()=>{var se;const s=a.useRef(null),{currentUser:t,messages:n}=K(b=>b.user),{socket:r}=de(),x=xe(),h=ae(),c=we(),i=new URLSearchParams(c.search).get("conId"),[y,_]=a.useState(!1),[N,k]=a.useState(null),[w,S]=a.useState(!1),[m,p]=a.useState(),[C,l]=a.useState("text"),[A,d]=a.useState(!1),[f,o]=a.useState({conversationId:i,senderId:t._id,senderModel:"User",type:"text",text:""}),E=a.useRef(null),u=async()=>{const b=await Ve(),J=await(await fetch("/user/user_add_or_get_fcmtoken",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:b,userId:t._id})})).json();console.log(J),console.log("fcm updated succesfully ❤️❤️❤️❤️❤️❤️❤️❤️❤️❤️❤️"),J&&x(Ee(J))},U=b=>{if(b.target.files&&b.target.files[0]){const O=b.target.files[0];if(console.log(b.target.files),O.type.startsWith("image/")||O.type.startsWith("video/")){console.log(O.type),l(O.type),p(O),G(O);return}return ce("Please select an Image or a Video..")}},G=async b=>{if(!b){ce("Please select a file");return}if(b.size>20971520){ce("Maximum limit of the file size you can share is 20MB"),ce("file size is too large select another file.."),l("text"),p(null);return}try{const J=he(fe),ue=new Date().getTime()+"_"+b.name,ve=ye(J,ue),ke=Ne(ve,b);S(!0),ke.on("state_changed",le=>{const Z=le.bytesTransferred/le.totalBytes*100;k(Z)},le=>{console.log(le),k(null)},()=>{be(ke.snapshot.ref).then(le=>{k(null),console.log(le),p(le),o(Z=>({...Z,type:b.type,text:le}))})})}catch{k(null)}};a.useEffect(()=>{u(),r.emit("join room",i);const b=O=>{console.log(O),O.callerId&&h(`/call_page_user?conId=${O.conId}&incommingId=${O.incommingId}&callerId=${O.callerId}&videoCall=${O.videoCall}`)};return r.on("incoming-call",b),()=>{r.off("incoming-call",b)}},[i,t.username,h]);const D=async(b=!1)=>{try{const J=await(await fetch("/user/start_call",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({callData:{conversationId:t.conversationId,adminId:t.adminId._id,userId:t._id,caller:"User",callType:b?"video":"audio",receiver:"Admin"},token:t.adminId.fcmToken,username:t.username})})).json();console.log(J),J&&r.emit("incoming-call",{conId:i,incommingId:t._id,adminId:t.adminId,callerId:J._id,videoCall:b})}catch(O){console.error("Error starting call:",O)}};console.log(t),a.useEffect(()=>(r.on("recieve_message",b=>{b.conversationId===i&&x(ns([...n,b]))}),()=>{r.off("recieve_message")}),[n,x,i]);const $=async()=>{try{const b=await q.get(`/user/get_user_messages/${i}`);console.log(b),console.log(b.data),x(ns(b.data))}catch(b){console.error("Error fetching messages:",b)}};a.useEffect(()=>{i&&(r.emit("join room",i),$()),h(t?`/chat_user?conId=${i}`:"/")},[t,i,h]);const F=async()=>{var b;console.log("sending message");try{const O=await q.post("/user/user_send_message_to_admin",{messageData:f,token:(b=t==null?void 0:t.adminId)==null?void 0:b.fcmToken,username:t.username});r.emit("chat message",O.data,i,t.adminId),r.emit("update conversation",t.adminId),r.emit("notify",t.adminId),l("text"),p(null),o({...f,type:"text",text:""}),j(),S(!1)}catch(O){console.error("Error sending message:",O)}},j=()=>{var b;(b=s.current)==null||b.scrollIntoView({behavior:"smooth"})};a.useEffect(()=>{j()},[n]);const I=()=>{x(Gs()),h("/")},T=b=>{const O={hour:"2-digit",minute:"2-digit",hour12:!0};return new Date(b).toLocaleTimeString([],O)},M=async()=>{Le({title:"Clear Chat",message:"Do you want to delete all this conversations ?",buttons:[{label:"Yes",onClick:async()=>{console.log("clearing chat clicked"),(await(await fetch(`/user/clear_user_chat/${i}`)).json()).success&&($(),_(!1),ce("All messages deleted sucessfully...",{duration:1e3}))}},{label:"No",onClick:()=>{_(!1)}}]})},Q=b=>{o({...f,text:b.target.value})},L=20*1024*1024,z=async b=>{if(!b||b.size===0)return ce.error("Please select an audio file"),null;if(b instanceof File&&b.size>L)return ce.error("Maximum audio file size limit is 20MB"),null;try{d(!0);const O=he(),J=new Date().getTime()+"_"+(b instanceof File?b.name:"audio.webm"),ue=ye(O,J),ve=Ne(ue,b);return S(!0),new Promise((ke,le)=>{ve.on("state_changed",Z=>{const Ae=Z.bytesTransferred/Z.totalBytes*100;console.log(`Upload is ${Ae}% done`)},Z=>{console.error("Error uploading audio:",Z),ce.error("Failed to upload audio"),le(Z)},async()=>{try{const Z=await be(ve.snapshot.ref);console.log("File available at",Z),ke(Z)}catch(Z){console.error("Error getting download URL:",Z),ce.error("Failed to get audio download URL"),le(Z)}})})}catch(O){return console.error("Error uploading audio:",O),ce.error("Failed to upload audio"),null}},B=async b=>{try{const O=await z(b);O&&(o({...f,text:O,type:b.type}),console.log("Audio URL:",O),l(b),console.log(b.type),p(O),d(!1))}catch(O){console.error("Error handling recording:",O)}},H=async()=>{p(""),l("text"),o({...f,text:"",type:"text"}),S(!1)},X=b=>{const O=document.createElement("a");O.href=b||"",O.download="image.jpg",O.target="_blank",O.click()};return e.jsxs("div",{className:"pt-1 h-screen bg-gray-50 flex flex-col",children:[e.jsx(Ls,{}),e.jsxs("div",{className:"border-2 flex flex-col h-full p-4 bg-white shadow-lg",children:[e.jsxs("div",{className:"flex justify-between items-center px-5 py-3 border-b-2",children:[e.jsxs("div",{className:"flex gap-5 items-center",children:[e.jsx("img",{src:t.adminId.image||"https://cdn-icons-png.flaticon.com/512/9385/9385289.png",className:"w-10 h-10 rounded-full",alt:"User"}),t&&e.jsx("span",{className:"text-xl font-bold",children:(se=t==null?void 0:t.adminId)==null?void 0:se.username})]}),e.jsxs("div",{className:"flex gap-5 items-center text-lg md:text-2xl text-sky-500",children:[e.jsx(Me,{className:"cursor-pointer hover:text-sky-800",onClick:()=>D(!1)}),t.propId.allowVedioCalls&&e.jsx(Ze,{className:"cursor-pointer hover:text-sky-800",onClick:()=>D(!0)}),e.jsx(_s,{className:"cursor-pointer hover:text-sky-800 hover:bg-slate-200 rounded-full hover:text-2xl hover:p-1 md:hover:text-3xl",onClick:()=>_(!y)}),e.jsx(At,{className:"cursor-pointer ",onClick:I})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto py-4",children:e.jsxs("div",{className:"flex flex-col gap-4 px-5",children:[(n==null?void 0:n.length)>0&&n.map(b=>{var O,J,ue;return e.jsxs("div",{className:`flex ${b.senderModel==="User"?"justify-end":"justify-start"} gap-3`,children:[b.senderModel!=="User"&&e.jsx("img",{src:b.senderModel==="User"?"https://cdn-icons-png.flaticon.com/512/9385/9385289.png":(O=t==null?void 0:t.adminId)==null?void 0:O.image,alt:"User",className:"w-10 h-10 rounded-full"}),e.jsxs("div",{className:"flex flex-col max-w-[300px] md:max-w-[350px] lg:max-w-[650px]",children:[e.jsxs("div",{className:"flex justify-between text-xs text-slate-400",children:[e.jsx("span",{children:T(b.createdAt)}),e.jsx("span",{children:b.senderModel==="User"?e.jsx("span",{className:"text-sky-500 font-bold",children:"You"}):e.jsx("span",{className:"text-sky-500 font-bold",children:t.adminId.username})||"Admin"})]}),b.type==="text"?e.jsx("div",{className:"p-3 rounded-xl bg-sky-100 text-sm break-words",children:b.text}):e.jsx("div",{className:"p-2 rounded-xl bg-sky-100 text-sm break-words",children:b!=null&&b.type&&((J=b==null?void 0:b.type)!=null&&J.startsWith("image/"))?e.jsxs("div",{className:"relative",children:[e.jsx(Is,{onClick:()=>X(b.text),className:"text-sky-500 hover:text-sky-800 absolute top-0 left-0 text-3xl  md:text-5xl cursor-pointer"}),e.jsx("img",{src:b.text,alt:"Shared file",className:"w-[200px] md:w-[500px]"})]}):(ue=b==null?void 0:b.type)!=null&&ue.startsWith("video/")?e.jsx("video",{className:"w-[200px] md:w-[500px]",controls:!0,children:e.jsx("source",{src:b.text,type:b.type})}):e.jsxs("audio",{className:"w-[200px] h-[60px] md:w-[500px] ",controls:!0,children:[e.jsx("source",{src:b.text,type:"audio/mpeg"}),"Your browser does not support the audio element."]})})]}),b.senderModel==="User"&&e.jsx("img",{src:"/public/userIcon.webp",alt:"User",className:"w-10 h-10 rounded-full"})]},b._id)}),e.jsx("div",{ref:s})]})}),e.jsxs("div",{className:"flex justify-between items-center px-5 py-2 bg-sky-200 rounded-lg mt-2",children:[!w&&e.jsx(Ws,{onRecordingComplete:B}),A&&e.jsx(ge,{type:"bubbles",className:"text-sky-500",color:"skyBlue",width:100}),C==="text"&&e.jsx("input",{type:"text",placeholder:"Write something...",className:"flex-1 mx-3 p-2 rounded-lg border bg-sky-100 border-sky-400 focus:outline-none focus:ring-2 focus:ring-sky-500",value:f.text,onChange:Q,onKeyPress:b=>b.key==="Enter"&&F()}),e.jsxs("div",{className:"flex",children:[N&&N<100?e.jsx(ge,{type:"bubbles",className:"text-sky-500",color:"skyBlue",width:100}):m&&e.jsx(e.Fragment,{children:typeof C=="string"&&C.startsWith("image/")?e.jsx("img",{src:m,alt:"Selected file",width:250}):typeof C=="string"&&C.startsWith("video/")?e.jsx("video",{src:m,width:250,height:400,controls:!0}):e.jsxs("div",{className:"flex gap-1 justify-center items-center",children:[e.jsx("audio",{className:"rounded",src:m,controls:!0}),e.jsx("div",{className:"hover:bg-sky-100 p-3 rounded-full",onClick:H,children:e.jsx(Es,{className:"text-sky-500 cursor-pointer"})})]})}),e.jsx("input",{type:"file",ref:E,name:"",id:"",onChange:U,hidden:!0}),!w&&e.jsx(Pt,{onClick:()=>{var b;return(b=E.current)==null?void 0:b.click()},className:"text-sky-500 text-2xl cursor-pointer"})]}),f&&f.text!==""&&e.jsx("div",{className:"p-2 rounded-full bg-sky-500 ml-3 cursor-pointer",onClick:F,children:e.jsx(As,{className:"text-white text-2xl"})})]}),y&&e.jsx("div",{className:"w-34 h-39 absolute bg-slate-700 opacity-70 right-24 rounded top-16 flex flex-col p-3 gap-4 md:w-40",children:e.jsxs("div",{className:"flex justify-start gap-2  rounded items-center hover:p-1 hover:bg-slate-900 cursor-pointer text-white text-sm md:text-lg",onClick:M,children:[e.jsx(Ts,{className:"text-red-600"})," ",e.jsx("span",{className:"text-sm",children:"Clear chat"})]})})]})]})},Aa=()=>{const[s,t]=a.useState([]),{currentAdmin:n}=K(u=>u.admin),[r,x]=a.useState(""),[h,c]=a.useState(""),[g,i]=a.useState(""),[y,_]=a.useState(""),[N,k]=a.useState([]),[w,S]=a.useState("");a.useEffect(()=>{l(),C()},[n,g,y]);const m=async u=>{await(await fetch(`/api/admin_delete_user_data/${u}`)).json()==="deleted"&&C()},p=u=>{je.fire({title:"Are you sure?",text:"This users chat list and all messages will be remove",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(U=>{U.isConfirmed&&(m(u),je.fire("Deleted!","Your file has been deleted.","success"))})},C=async()=>{try{const u=await q.get("/api/get_users_list",{params:{adminId:n._id,startDate:r,endDate:h,propertyName:g,userType:y}});u.data!=="Empty list"?t(u.data):(t([]),P("Filtered user list empty"))}catch(u){console.error("Error fetching users list:",u)}},l=async()=>{try{const U=await(await fetch(`/api/get_admin_property_data_filtering/${n._id}`)).json();k(U)}catch(u){console.log("Error fetching admin properties:",u)}},A=u=>{const U=u.target.value;new Date(U)>new Date(h)?P.error("Start date cannot be later than end date."):x(U)},d=u=>{const U=u.target.value;new Date(r)>new Date(U)?P.error("End date cannot be earlier than start date."):c(U)},f=u=>{S(u.target.value)},o=s.filter(u=>u.username.toLowerCase().includes(w.toLowerCase())),E=()=>{console.log("filtering by date"),r&&h?C():P.error("please select the dates..")};return console.log(o),e.jsx("div",{className:"p-4 h-screen",children:e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsx("h1",{className:"text-2xl font-bold p-4",children:"All Visitors"}),e.jsxs("div",{className:"flex flex-col border  p-4 rounded-lg gap-4 bg-white shadow-lg h-full",children:[e.jsxs("div",{className:"flex flex-col xl:flex-row justify-between bg-sky-500 p-4 rounded",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 lg:gap-16 justify-center items-center px-2 lg:px-5",children:[e.jsx("div",{className:"flex relative w-full lg:w-auto",children:e.jsxs("select",{onChange:u=>{_(u.target.value),i(""),c(""),x("")},className:"py-3 px-2 bg-white lg:px-16 text-xs rounded-full cursor-pointer w-full lg:w-auto",children:[e.jsx("option",{value:"",children:"All Users"}),e.jsx("option",{value:"Unknown",children:"Unknown"}),e.jsx("option",{value:"Unverified",children:"Unverified"}),e.jsx("option",{value:"Verified",children:"Verified"})]})}),e.jsx("div",{className:"flex relative w-full lg:w-auto mt-4 lg:mt-0",children:e.jsxs("select",{onChange:u=>{i(u.target.value),_(""),c(""),x("")},className:"py-3 px-1 bg-white lg:px-5 text-xs rounded-full cursor-pointer w-full lg:w-auto",children:[e.jsx("option",{value:"All",children:"All Properties"}),N&&N.map(u=>e.jsxs("option",{className:`${u.deleted?"text-red-500":"font-bold text-green-500"}`,value:u._id,children:[u.propertyName," ",u.deleted?" - (Deleted)":" -  (Active)"]},u._id))]})})]}),e.jsx("div",{className:"flex flex-col lg:flex-row gap-4 mt-4 lg:mt-0 bg-sky-300 rounded p-3 w-full lg:w-auto",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center space-y-2 sm:space-y-0 sm:space-x-4 w-full",children:[e.jsxs("div",{className:"flex items-center space-x-2 w-full lg:w-auto",children:[e.jsx("label",{htmlFor:"start-date",className:"text-xs",children:"Start Date:"}),e.jsx("input",{type:"date",id:"start-date",name:"start-date",value:r,onChange:A,className:"py-2 px-4 rounded-full border border-gray-300 cursor-pointer w-full lg:w-auto"})]}),e.jsxs("div",{className:"flex items-center space-x-2 w-full lg:w-auto mt-4 sm:mt-0",children:[e.jsx("label",{htmlFor:"end-date",className:"text-xs",children:"End Date:"}),e.jsx("input",{type:"date",id:"end-date",name:"end-date",value:h,onChange:d,className:"py-2 px-4 rounded-full border border-gray-300 cursor-pointer w-full lg:w-auto"}),e.jsx("button",{className:"bg-white text-xs p-3 rounded-full font-semibold hover:bg-sky-200 w-full lg:w-auto mt-4 sm:mt-0",onClick:E,children:"Apply"})]})]})})]}),e.jsxs("div",{className:"flex items-center border p-2 px-5 rounded-lg bg-gray-100 shadow-sm",children:[e.jsx("input",{type:"text",className:"flex-grow border-none focus:outline-none px-5 bg-transparent",placeholder:"Search...",value:w,onChange:f}),e.jsx(vs,{className:"text-gray-500"})]}),e.jsx("div",{className:"flex flex-col gap-4 overflow-y-auto flex-grow mt-4",children:o&&o.map(u=>{var U,G,D;return e.jsxs("div",{className:"flex flex-col border p-4 rounded-lg gap-4 shadow-sm bg-gray-50",children:[e.jsxs("div",{className:"flex justify-between items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-4 px-5 py-2 bg-white border rounded-lg shadow-sm flex-grow",children:[e.jsx("h3",{className:"text:xs md:text-lg font-semibold",children:"Visited on"}),e.jsxs("span",{className:"text:xs md:text-lg",children:[new Date(u==null?void 0:u.createdAt).toLocaleDateString()," ---"," ",new Date(u==null?void 0:u.createdAt).toLocaleTimeString()]})]}),e.jsx(W,{to:`/admin_chat?conId=${u==null?void 0:u.conversationId}`,children:e.jsxs("button",{className:"flex items-center gap-1 text-white bg-sky-500 px-4 py-2 rounded-lg shadow-sm w-24 justify-center",children:[e.jsx(Tt,{}),"Chats"]})})]}),e.jsxs("div",{className:"flex justify-between items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-4 px-5 py-2 bg-white border rounded-lg shadow-sm flex-grow",children:[e.jsx("h3",{className:"font-semibold text:xs md:text-lg",children:"Name"}),e.jsx("span",{className:"text:xs md:text-lg",children:u==null?void 0:u.username})]}),e.jsxs("button",{onClick:()=>p(u._id),className:"flex items-center gap-1 text-white bg-red-500 px-4 py-2 rounded-lg shadow-sm w-24 justify-center",children:[e.jsx(ws,{}),"Delete"]})]}),e.jsxs("div",{className:"flex justify-between items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-4 px-5 py-2 bg-white border rounded-lg shadow-sm flex-grow",children:[e.jsx("h3",{className:"font-semibold text:xs md:text-lg",children:"Purpose"}),e.jsx("span",{className:"text:xs md:text-lg",children:(u==null?void 0:u.purpose)!=="Unknown contact"?u==null?void 0:u.purpose:"Visited by an unknown user"})]}),((U=u==null?void 0:u.propId)==null?void 0:U.userType)!=="Unknown"&&e.jsxs("a",{className:"flex items-center gap-1 text-white text-xs bg-green-500 px-4 py-3 rounded-lg shadow-sm w-24 justify-center",target:"_blank",href:`https://wa.me/${u==null?void 0:u.phone}`,rel:"noopener noreferrer",children:[e.jsx(Ps,{className:"text-white"}),"Message"]})]}),((G=u==null?void 0:u.propId)==null?void 0:G.userType)!=="Unknown"&&e.jsxs("div",{className:"flex justify-between items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-4 px-5 py-2 bg-white border rounded-lg shadow-sm flex-grow",children:[e.jsx("h3",{className:"font-semibold text:xs md:text-lg",children:"Phone"}),e.jsx("span",{className:"text:xs md:text-lg",children:u==null?void 0:u.phone})]}),e.jsxs("a",{href:`tel:${u==null?void 0:u.phone}`,className:"flex items-center gap-1 text-white bg-sky-500 px-4 py-2 rounded-lg shadow-sm w-24 justify-center",children:[e.jsx(Ut,{}),"Call"]})]}),e.jsx("div",{className:"flex justify-between items-center gap-2",children:e.jsxs("div",{className:"flex items-center gap-4 px-5 py-2 bg-white border rounded-lg shadow-sm flex-grow",children:[e.jsx("h3",{className:"font-semibold text:xs md:text-lg",children:"Property"}),e.jsx("span",{className:"text:xs md:text-lg",children:(D=u==null?void 0:u.propId)==null?void 0:D.propertyName})]})})]},u==null?void 0:u._id)})})]})]})})},Pa=()=>{const[s,t]=a.useState(!0);return e.jsxs("div",{className:"flex w-screen",children:[e.jsx(me,{navShowSet:t}),e.jsx("div",{className:`transition-all duration-300 ${s?"w-[250px]":"w-[60px]"}`}),e.jsx("div",{className:"flex-1",children:e.jsx(Aa,{})})]})},Ta=()=>{const{currentAdmin:s}=K(g=>g.admin),[t,n]=a.useState([]),r=async()=>{try{const g=await q.get(`/api/get_admin_property_data/${s._id}`);if(g.status===200){const i=g.data;n(i)}}catch(g){console.error("Error fetching property data",g)}};a.useEffect(()=>{r()},[s._id]);const x=async g=>{try{const i=await q.get(`/api/delete_property/${g}`);console.log(i.data),i.data.success&&r()}catch(i){console.log(i)}},h=g=>{const i=document.createElement("a");i.href=g||"",i.download="qr_code.png",i.click()},c=g=>{je.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(i=>{i.isConfirmed&&(x(g),je.fire("Deleted!","Your file has been deleted.","success"))})};return e.jsxs("div",{className:"relative p-1",children:[e.jsx("div",{className:"absolute z-0 rounded-2xl -top-56 left-1/2 transform -translate-x-1/2 bg-zinc-300 w-60 h-40 lg:h-96 rotate-45"}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("h1",{className:"text-start text-xl font-bold mt-14 ml-2 md:text-3xl",children:"Your available QR Codes"}),e.jsx("div",{className:"flex justify-end mb-4",children:e.jsx(W,{to:"/generate_qr",children:e.jsx("button",{className:"bg-sky-500 text-white text-xs px-2 py-1 gap-1 rounded hover:bg-sky-600 lg:text-lg lg:py-2 lg:px-4 lg:gap-2 flex items-center",children:"GENERATE NEW CODE"})})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full rounded shadow",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"flex gap-2 justify-center items-center bg-zinc-300 text-xs font-bold lg:text-lg px-1 py-2 rounded lg:gap-16",children:[e.jsx("th",{className:"flex-1 text-left",children:"QR CODE"}),e.jsx("th",{className:"flex-1 text-left",children:"DOWNLOAD"}),e.jsx("th",{className:"flex-1 text-left",children:"VIDEO CALL"}),e.jsx("th",{className:"flex-1 text-left",children:"PROPERTY NAME"}),e.jsx("th",{className:"flex-1 text-left",children:"PROPERTY ADDRESS"}),e.jsx("th",{className:"flex-1 text-left",children:"DELETE"})]})}),e.jsx("tbody",{className:"text-white",children:t.length>0?t.map(g=>e.jsxs("tr",{className:"flex gap-5 justify-center items-center mt-5 bg-sky-500 text-xs lg:text-lg px-2 py-2 rounded lg:gap-x-28",children:[e.jsx("td",{className:"flex-1 text-left",children:e.jsx("img",{src:g.code,alt:"QR",className:"w-10 h-10 lg:w-16 lg:h-16"})}),e.jsx("td",{className:"flex-1 text-left cursor-pointer",children:e.jsx(Ot,{onClick:()=>h(g.code),className:"text-2xl hover:text-sky-800"})}),e.jsx("td",{className:"flex-1 text-left text-green-200",children:g.allowVedioCalls?"ALLOWED":"NOT ALLOWED"}),e.jsx("td",{className:"flex-1 text-left",children:g.propertyName}),e.jsx("td",{className:"flex-1 text-left",children:e.jsx("p",{children:g.propertyAddress})}),e.jsx("td",{className:"flex-1 text-left",children:e.jsx("button",{onClick:()=>c(g._id),className:"bg-red-500 text-white text-xs cursor-pointer rounded hover:bg-red-700 lg:text-sm lg:py-1 lg:px-2",children:"delete"})})]},g._id)):e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"text-center",children:"No Property data available"})})})]})})]})]})},Ua=()=>{const[s,t]=a.useState(!0);return e.jsxs("div",{className:"flex w-screen",children:[e.jsx(me,{navShowSet:t}),e.jsx("div",{className:`transition-all duration-300 ${s?"w-[250px]":"w-[60px]"}`}),e.jsx("div",{className:"flex-1",children:e.jsx(Ta,{})})]})},Oa={currentSuperAdmin:null,error:null,loading:!1,messages:[]},Qs=Fe({name:"superAdmin",initialState:Oa,reducers:{signInSuccess:(s,t)=>{s.currentSuperAdmin=t.payload,s.loading=!1,s.error=null},setMessages:(s,t)=>{s.messages=Array.isArray(t.payload)?t.payload:[]},signoutSuccess:s=>{s.currentSuperAdmin=null,s.error=null,s.loading=!1,s.messages=[]}}}),{signInSuccess:Ra,setMessages:il,signoutSuccess:$a}=Qs.actions,La=Qs.reducer,Va=()=>{const[s,t]=a.useState(""),[n,r]=a.useState(""),[x,h]=a.useState(!0),[c,g]=a.useState(!0),[i,y]=a.useState(""),[_,N]=a.useState(!1),{currentSuperAdmin:k}=K(f=>f.superAdmin),[w,S]=a.useState([]),m=xe(),p=ae(),C=async()=>{try{const f=await q.get("/superAdmin/get_posters");S(f.data)}catch(f){console.log(f),P("Failed to fetch posters.")}},l=f=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(f),A=f=>f.length>=8;a.useEffect(()=>{C(),h(l(s)),g(A(n)),k&&p("/super_admin_dashboard")},[s,n]);const d=async()=>{if(!x||!c){y("Please enter valid email and password.");return}const f=await q.post("/superAdmin/super_admin_login",{email:s,password:n});f.data!=="Invalid"?(m(Ra(f.data)),P("Logged in sucessfully"),p("/super_admin_dashboard")):P("Error logging in")};return e.jsxs("div",{className:"flex justify-center h-[700px] w-full",children:[e.jsx("div",{className:"hidden sm:flex sm:flex-1 sm:h-full",children:e.jsx("img",{src:w.length>0?w[9].imageUrl:"https://firebasestorage.googleapis.com/v0/b/elite-mediator.appspot.com/o/login.jpg?alt=media&token=23fd7400-7426-40c8-87c3-dc4c1eabc8c9",alt:"Dummy",className:"h-full object-cover w-full"})}),e.jsx("div",{className:"w-full lg:flex-1 h-full bg-sky-100 p-5",children:e.jsxs("div",{className:"bg-white h-full flex flex-col justify-center items-center",children:[e.jsx("h1",{className:"text-2xl lg:text-3xl",children:"Login (Super Admin)"}),e.jsxs("div",{className:"flex flex-col pt-5",children:[e.jsxs("div",{className:"flex justify-between px-5 py-1",children:[e.jsx("span",{className:"text-xs text-zinc-500",children:"Email"}),e.jsxs("div",{className:"flex justify-between gap-1",children:[s&&(x?e.jsx(V,{className:"text-green-600 text-xs"}):e.jsx(_e,{className:"text-red-600 text-xs"})),e.jsx("span",{className:`text-xs text-center ${x?"text-green-500":"text-red-500"}`,children:s.length>0&&(x?"Valid":"Invalid")})]})]}),e.jsx("input",{type:"text",className:`w-[300px] border rounded py-1 px-5 ${x?"":"border-red-500"}`,placeholder:"Enter your email",value:s,onChange:f=>t(f.target.value)})]}),e.jsxs("div",{className:"flex flex-col pt-5",children:[e.jsxs("div",{className:"flex justify-between px-5 py-1",children:[e.jsx("span",{className:"text-xs text-zinc-500",children:"Password"}),e.jsxs("div",{className:"flex justify-between gap-1",children:[n&&(c?e.jsx(V,{className:"text-green-600 text-xs"}):e.jsx(_e,{className:"text-red-600 text-xs"})),e.jsx("span",{className:`text-xs text-center ${c?"text-green-500":"text-red-500"}`,children:n.length>0&&(c?"Valid":"Invalid")})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:_?"text":"password",className:`w-[300px] border rounded py-1 px-5 ${c?"":"border-red-500"}`,placeholder:"Enter your password",value:n,onChange:f=>r(f.target.value)}),_?e.jsx(ze,{className:"absolute top-2 right-3 cursor-pointer",onClick:()=>N(!1)}):e.jsx(Be,{className:"absolute top-2 right-3 cursor-pointer",onClick:()=>N(!0)})]})]}),i&&e.jsx("div",{className:"text-red-500 text-sm mt-2",children:i}),e.jsx("div",{className:"w-[300px] mt-6",children:e.jsx("button",{onClick:d,className:"bg-sky-500 w-full rounded py-1 px-5 text-white hover:bg-sky-600",children:"Login"})})]})})]})},De=({navShowSet:s})=>{const[t,n]=a.useState(!0),r=xe();a.useEffect(()=>{s(t)},[s,t]),a.useEffect(()=>{const h=()=>{n(window.innerWidth>=768)};return h(),window.addEventListener("resize",h),()=>{window.removeEventListener("resize",h)}},[]);const x=()=>{r($a())};return e.jsxs("div",{className:"fixed z-20",children:[e.jsxs("div",{className:`flex p-1 gap-1 transition-all duration-300 ${t?"bg-sky-50 w-[250px]":"w-[60px]"}`,children:[e.jsx("img",{className:" rounded bg-sky-500 font-sans w-14 text-center",src:"https://firebasestorage.googleapis.com/v0/b/elite-mediator.appspot.com/o/logo.png?alt=media&token=d632f87d-5330-4f8d-bf5c-67780c74798d",alt:""}),e.jsx("span",{className:`flex justify-center items-center text-2xl transition-all duration-300 whitespace-nowrap ${t?"opacity-100":"opacity-0"}`,children:"ELITE MEDIATOR"})]}),e.jsxs("div",{className:`transition-all duration-300 ${t?"h-screen w-[250px] bg-sky-50":"h-screen w-[60px] bg-sky-50"}`,children:[e.jsx("span",{className:"hidden md:flex justify-center items-center bg-sky-500 rounded-full w-7 h-7 absolute -right-2 cursor-pointer",onClick:()=>n(!t),children:t?e.jsx(us,{className:"text-3xl"}):e.jsx(Rt,{className:"text-xs"})}),e.jsx("br",{}),e.jsx("br",{}),e.jsxs("div",{className:`  transition-all duration-300 ${t?"h-screen w-[250px] bg-sky-50":"h-screen w-[60px] bg-sky-50"} flex flex-col gap-10 relative`,children:[e.jsxs(W,{to:"/super_admin_dashboard",className:`flex gap-5 self-start ${location.pathname==="/super_admin_dashboard"?"text-black":"text-sky-500"} px-5 hover:text-black cursor-pointer items-center text-xl`,children:[e.jsx("span",{children:e.jsx(ps,{})}),e.jsx("span",{className:`text-sm transition-opacity duration-300 ${t?"opacity-100":"opacity-0 hidden"}`,children:"DASHBOARD"})]}),e.jsxs(W,{to:"/super_admin_registered_admin_list",className:`flex gap-5 self-start ${location.pathname==="/super_admin_registered_admin_list"?"text-black":"text-sky-500"} px-5 hover:text-black cursor-pointer items-center text-xl`,children:[e.jsx("span",{children:e.jsx($t,{})}),e.jsx("span",{className:`text-sm transition-opacity duration-300 ${t?"opacity-100":"opacity-0 hidden"}`,children:"ALL USERS"})]}),e.jsxs(W,{to:"/super_admin_poster_page",className:`flex gap-5 self-start ${location.pathname==="/super_admin_poster_page"?"text-black":"text-sky-500"} px-5 hover:text-black cursor-pointer items-center text-xl`,children:[e.jsx("span",{children:e.jsx(Lt,{})}),e.jsx("span",{className:`text-sm transition-opacity duration-300 ${t?"opacity-100":"opacity-0 hidden"}`,children:"POSTERS"})]}),e.jsxs("div",{onClick:x,className:`flex gap-5 self-start ${location.pathname==="/super_admin"?"text-black":"text-sky-500"} px-5 hover:text-black cursor-pointer items-center text-xl`,children:[e.jsx("span",{children:e.jsx(Vt,{})}),e.jsxs("span",{className:`text-sm transition-opacity duration-300 ${t?"opacity-100":"opacity-0 hidden"}`,children:["LOGOUT"," "]})]})]})]})]})};We.register(He,Ge,Dt,Qe,Je,Ke);const Da=()=>{const s={labels:["All Users","Verified Users","Unverified Users","Unknown Users"],datasets:[{label:"User Statistics",data:[10,20,30,60],borderColor:"rgb(14 165 233)",backgroundColor:"rgba(75, 192, 192, 0.2)",fill:!1}]},t={responsive:!0,scales:{x:{beginAtZero:!0}},plugins:{legend:{display:!0,position:"top"},title:{display:!0,text:"User Statistics Chart"}}};return e.jsx("div",{className:"p-6 w-[500px] relative z-20 md:w-[900px]  mx-auto lg:w-[1200px]",children:e.jsx(Mt,{className:"w-full",data:s,options:t})})};We.register(He,Ge,ys,Ns,Qe,Je,Ke);const Ma=()=>{const s={labels:["All Users","Verified Users","Unverified Users","Unknown Users"],datasets:[{label:"User Statistics",data:[10,20,30,60,2],borderColor:"rgb(14 165 233)",backgroundColor:"rgba(75, 192, 192, 0.2)",fill:!1,tension:.1}]},t={responsive:!0,scales:{x:{beginAtZero:!0}},plugins:{legend:{display:!0,position:"top"},title:{display:!0,text:"User Statistics Chart"}}};return e.jsx("div",{className:"p-6 w-[500px] relative z-20 md:w-[900px]  mx-auto lg:w-[1200px]",children:e.jsx(bs,{className:"w-full",data:s,options:t})})},Fa=()=>{const[s,t]=a.useState(),[n,r]=a.useState(""),x=async()=>{try{const c=await q.get("/superAdmin/get_all_admins_data");console.log(c),t(c.data)}catch(c){console.log(c)}},h=s==null?void 0:s.filter(c=>c.username.toLowerCase().includes(n==null?void 0:n.toLocaleLowerCase()));return a.useEffect(()=>{x()},[]),console.log(s),e.jsxs("div",{className:"container mx-auto",children:[e.jsx("div",{className:"absolute z-0 rounded-2xl -top-14 sm:ml-30 md:ml-28 lg:left-20 transform translate-x-1/2 -translate-y-1/2 bg-zinc-300 w-40 h-40 lg:w-72 lg:h-72 rotate-45"}),e.jsxs("div",{className:"flex  mt-16 pl-8 flex-col w-full relative",children:[e.jsx("div",{className:"bg-white",children:e.jsx(Ma,{})}),e.jsx("div",{className:"flex",children:e.jsx(Da,{})}),e.jsx("div",{className:"flex justify-center rounded",children:e.jsxs("div",{className:"flex flex-col border-2 rounded w-[400px] mx-6 md:mx-12 md:w-full ",children:[e.jsx("div",{className:"flex justify-center bg-sky-500",children:e.jsx("h1",{className:"text-white p-3",children:"RECENT REGISTERED ADMINS"})}),e.jsx("div",{className:"flex justify-start px-5 h-10 md:h-14",children:e.jsxs("div",{className:"flex rounded justify-between items-center mt-2 border-2 h-8 p-2 md:w-[900px] md:h-12",children:[e.jsx("input",{type:"text",className:"mx-4 w-full h-full",onChange:c=>r(c.target.value),placeholder:"Search..."}),e.jsx(Vs,{className:"cursor-pointer mr-1 rounded text-zinc-500 md:text-2xl"})]})}),e.jsxs("table",{className:"w-full text-left p-5 mt-4 text-xs md:text-sm lg:text-lg ",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-2 border-b",children:"ID"}),e.jsx("th",{className:"p-2 border-b",children:"NAME"}),e.jsx("th",{className:"p-2 border-b",children:"EMAIL"}),e.jsx("th",{className:"p-2 border-b",children:"DETAILS"})]})}),e.jsx("tbody",{children:h&&h.length>0?h.map(c=>{var g;return e.jsxs("tr",{children:[e.jsxs("td",{className:"p-2 border-b",children:["#",(g=c==null?void 0:c._id)==null?void 0:g.substring(0,5)]}),e.jsx("td",{className:"p-2 border-b",children:c==null?void 0:c.username}),e.jsx("td",{className:"p-2 border-b",children:c==null?void 0:c.email}),e.jsx("td",{className:"p-2 border-b hover:text-sky-500 cursor-pointer",children:e.jsx(W,{to:`/super_admin_registered_admin_profile?adminId=${c._id}`,children:e.jsx(Ds,{className:"text-lg md:text-2xl "})})})]},c==null?void 0:c._id)}):e.jsx("div",{className:"flex justify-center text-4xl p-6 font-bold",children:"No Data available"})})]})]})})]})]})},za=()=>{const[s,t]=a.useState(!0);return e.jsxs("div",{className:"flex w-screen",children:[e.jsx(De,{navShowSet:t}),e.jsx("div",{className:`transition-all duration-300 ${s?"w-[250px]":"w-[60px]"}`}),e.jsx("div",{className:"flex-1",children:e.jsx(Fa,{})})]})},Ba=()=>{const[s,t]=a.useState(),[n,r]=a.useState(""),x=async()=>{try{const c=await q.get("/superAdmin/get_all_admins_data");console.log(c),t(c.data)}catch(c){console.log(c)}},h=s==null?void 0:s.filter(c=>c.username.toLowerCase().includes(n==null?void 0:n.toLocaleLowerCase()));return a.useEffect(()=>{x()},[]),console.log(s),e.jsxs("div",{className:"container mx-auto",children:[e.jsx("div",{className:"absolute z-0 rounded-2xl -top-14 sm:ml-30 md:ml-28 lg:left-20 transform translate-x-1/2 -translate-y-1/2 bg-zinc-300 w-40 h-40 lg:w-72 lg:h-72 rotate-45"}),e.jsxs("div",{className:"flex flex-col gap-5 p-6 mt-5 relative z-10",children:[e.jsx("h1",{className:"text-2xl font-bold text-center",children:"All Admins"}),e.jsx("div",{className:"relative z-30",children:e.jsxs("div",{className:"flex flex-col border-2 shadow-lg rounded-lg bg-white",children:[e.jsxs("div",{className:"flex gap-1 justify-between items-center bg-sky-500 p-4 rounded-t-lg",children:[e.jsx("div",{className:"cursor-pointer px-1 text-white hover:text-black",children:"(All)"}),e.jsxs("div",{className:"flex justify-between gap-2 items-center",children:[e.jsx("div",{className:"flex bg-sky-100 p-1 rounded-full md:px-5",children:e.jsx("input",{type:"date",className:"bg-sky-100 rounded-full outline-none"})}),e.jsx("div",{className:"flex bg-sky-100 p-1 rounded-full md:px-5",children:e.jsx("input",{type:"date",className:"bg-sky-100 rounded-full outline-none"})}),e.jsx("div",{className:"flex",children:e.jsx("button",{className:"text-white hover:text-black hover:bg-white hover:rounded-full hover:p-1 transition duration-300",children:"Apply"})})]})]}),e.jsx("div",{className:"flex my-2 px-5",children:e.jsxs("div",{className:"flex rounded justify-between items-center mt-2 border-2 p-2 w-full shadow-md",children:[e.jsx("input",{type:"text",className:"mx-4 w-full h-full outline-none",onChange:c=>r(c.target.value),placeholder:"Search..."}),e.jsx(Vs,{className:"cursor-pointer mr-1 rounded text-zinc-500 md:text-2xl"})]})}),e.jsxs("div",{className:"flex flex-col justify-between h-[450px] border-2 rounded-b-lg overflow-hidden shadow-lg",children:[e.jsxs("table",{className:"w-full text-left p-5 mt-4 text-xs md:text-sm lg:text-lg",children:[e.jsx("thead",{className:"bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-2 border-b",children:"ID"}),e.jsx("th",{className:"p-2 border-b",children:"NAME"}),e.jsx("th",{className:"p-2 border-b",children:"EMAIL"}),e.jsx("th",{className:"p-2 border-b",children:"PHONE"}),e.jsx("th",{className:"p-2 border-b",children:"DETAILS"})]})}),e.jsx("tbody",{children:h&&h.length>0?h.map(c=>{var g;return e.jsxs("tr",{className:"even:bg-gray-50",children:[e.jsxs("td",{className:"p-2 border-b",children:["#",(g=c._id)==null?void 0:g.substring(0,6)]}),e.jsx("td",{className:"p-2 border-b",children:c.username}),e.jsx("td",{className:"p-2 border-b",children:c.email}),e.jsx("td",{className:"p-2 border-b",children:c.phone}),e.jsx("td",{className:"p-2 border-b hover:text-sky-500 cursor-pointer",children:e.jsx(W,{to:`/super_admin_registered_admin_profile?adminId=${c._id}`,children:e.jsx(Ds,{className:"text-lg md:text-2xl"})})})]},c._id)}):e.jsx("div",{className:"flex justify-center text-4xl p-6 font-bold",children:"No Data available"})})]}),e.jsxs("div",{className:"flex justify-between items-center p-4 bg-gray-50",children:[e.jsx("button",{className:"p-2 bg-sky-500 text-white rounded hover:bg-sky-600 transition duration-300",children:e.jsx(ks,{})}),e.jsxs("span",{children:["Page ",1," of ",1]}),e.jsx("button",{className:"p-2 bg-sky-500 text-white rounded hover:bg-sky-600 transition duration-300",children:e.jsx(Ss,{})})]})]})]})})]})]})},qa=()=>{const[s,t]=a.useState(!0);return e.jsxs("div",{className:"flex w-screen",children:[e.jsx(De,{navShowSet:t}),e.jsx("div",{className:`transition-all duration-300 ${s?"w-[250px]":"w-[60px]"}`}),e.jsx("div",{className:"flex-1",children:e.jsx(Ba,{})})]})},Ya=()=>{const s=we(),n=new URLSearchParams(s.search).get("adminId"),[r,x]=a.useState(),[h,c]=a.useState("All"),[g,i]=a.useState(),y=async()=>{try{const p=await q.get(`/superAdmin/get_admin_profile/${n}`);x(p.data)}catch(p){console.log(p)}},_=async()=>{try{const p=await q.post("/superAdmin/get_admin_visitors",{adminId:n,userType:h});console.log(p),i(p.data)}catch(p){console.error("Error fetching admin visitors:",p)}},N=p=>{const C={year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!0};return new Date(p).toLocaleString([],C)},k=async p=>{(await q.get(`/superAdmin/unblock_an_admin/${p}`)).data.unblocked?(P("Admin was sucessfully unblocked"),y()):P("failed unblocking admin")},w=p=>{je.fire({title:"Are you sure?",text:"Do you want to block this Admin from accesing his account ?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(C=>{C.isConfirmed&&S(p)})},S=async p=>{(await q.get(`/superAdmin/block_an_admin/${p}`)).data.blocked?(je.fire("Admin was sucessfully blocked.."),y()):P("Failed blocking the admin")},m=p=>{je.fire({title:"Are you sure?",text:"Do you want to block this Admin from accesing his account ?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(C=>{C.isConfirmed&&k(p)})};return a.useEffect(()=>{y(),_()},[h]),console.log(h),console.log(n),console.log(g),e.jsxs("div",{className:"container mx-auto",children:[e.jsx("div",{className:"absolute z-0 rounded-2xl -top-14 sm:ml-30 md:ml-28 lg:left-20 transform translate-x-1/2 -translate-y-1/2 bg-zinc-300 w-40 h-40 lg:w-72 lg:h-72 rotate-45"}),e.jsxs("div",{className:"flex flex-col  p-3 ",children:[e.jsx("h1",{className:"p-5 text-3xl relative z-10 font-bold",children:"Profile Info"}),e.jsxs("div",{className:"flex flex-col border-2 rounded relative z-30",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center px-28 py-3",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("img",{src:r==null?void 0:r.image,className:"w-32 md:w-50 rounded ",alt:""})}),e.jsx("div",{className:"flex justify-end w-15 h-8 md:w-20 m-2",children:r&&r.blocked?e.jsx("button",{onClick:()=>m(r==null?void 0:r._id),className:"p-1 bg-red-500 w-full rounded text-white hover:bg-red-900 ",children:"Unblock"}):e.jsx("button",{onClick:()=>w(r==null?void 0:r._id),className:"p-1 bg-red-500 w-full rounded text-white hover:bg-red-900 ",children:"Block"})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-10",children:[e.jsxs("div",{className:"flex flex-col w-[350px] mx-auto",children:[e.jsxs("div",{className:"flex justify-between px-5",children:[e.jsx("span",{className:"text-zinc-500",children:"Name"}),e.jsxs("div",{className:"flex justify-center items-center gap-1",children:[e.jsx(V,{className:"text-green-600 text-sm"}),e.jsx("span",{className:" text-green-600",children:"Valid"})]})]}),e.jsxs("div",{className:"flex relative mx-auto w-full",children:[e.jsx(ie,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-lg md:text-xl"}),e.jsx("input",{disabled:!0,type:"text",className:"border-2 w-full rounded-md   placeholder-text-black placeholder-gray-900 py-2 px-4 md:py-3 md:px-5",placeholder:r==null?void 0:r.username})]})]}),e.jsxs("div",{className:"flex flex-col w-[350px] mx-auto",children:[e.jsxs("div",{className:"flex justify-between px-5",children:[e.jsx("span",{className:"text-zinc-500",children:"Email"}),e.jsxs("div",{className:"flex justify-center items-center gap-1",children:[e.jsx(V,{className:"text-green-600 text-sm"}),e.jsx("span",{className:" text-green-600",children:"Valid"})]})]}),e.jsxs("div",{className:"flex relative mx-auto w-full",children:[e.jsx(ie,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-lg md:text-xl"}),e.jsx("input",{disabled:!0,type:"text",className:"border-2 w-full rounded-md   placeholder-text-black placeholder-gray-900 py-2 px-4 md:py-3 md:px-5",placeholder:r==null?void 0:r.email})]})]}),e.jsxs("div",{className:"flex flex-col w-[350px] mx-auto",children:[e.jsxs("div",{className:"flex justify-between px-5",children:[e.jsx("span",{className:"text-zinc-500",children:"Address"}),e.jsxs("div",{className:"flex justify-center items-center gap-1",children:[e.jsx(V,{className:"text-green-600 text-sm"}),e.jsx("span",{className:" text-green-600",children:"Valid"})]})]}),e.jsxs("div",{className:"flex relative mx-auto w-full",children:[e.jsx(ie,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-lg md:text-xl"}),e.jsx("input",{disabled:!0,type:"text",className:"border-2 w-full rounded-md   placeholder-text-black placeholder-gray-900 py-2 px-4 md:py-3 md:px-5",placeholder:r&&(r==null?void 0:r.address)})]})]}),e.jsxs("div",{className:"flex flex-col w-[350px] mx-auto",children:[e.jsxs("div",{className:"flex justify-between px-5",children:[e.jsx("span",{className:"text-zinc-500",children:"Phone"}),e.jsxs("div",{className:"flex justify-center items-center gap-1",children:[e.jsx(V,{className:"text-green-600 text-sm"}),e.jsx("span",{className:" text-green-600",children:"Valid"})]})]}),e.jsxs("div",{className:"flex relative mx-auto w-full",children:[e.jsx(ie,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-lg md:text-xl"}),e.jsx("input",{disabled:!0,type:"text",className:"border-2 w-full rounded-md   placeholder-text-black placeholder-gray-900 py-2 px-4 md:py-3 md:px-5",placeholder:`${r==null?void 0:r.phone}`})]})]}),e.jsxs("div",{className:"flex flex-col w-[350px] mx-auto",children:[e.jsxs("div",{className:"flex justify-between px-5",children:[e.jsx("span",{className:"text-zinc-500",children:"State"}),e.jsxs("div",{className:"flex justify-center items-center gap-1",children:[e.jsx(V,{className:"text-green-600 text-sm"}),e.jsx("span",{className:" text-green-600",children:"Valid"})]})]}),e.jsxs("div",{className:"flex relative mx-auto w-full",children:[e.jsx(ie,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-lg md:text-xl"}),e.jsx("input",{disabled:!0,type:"text",className:"border-2 w-full rounded-md   placeholder-text-black placeholder-gray-900 py-2 px-4 md:py-3 md:px-5",placeholder:r==null?void 0:r.state})]})]}),e.jsxs("div",{className:"flex flex-col w-[350px] mx-auto",children:[e.jsxs("div",{className:"flex justify-between px-5",children:[e.jsx("span",{className:"text-zinc-500",children:"City"}),e.jsxs("div",{className:"flex justify-center items-center gap-1",children:[e.jsx(V,{className:"text-green-600 text-sm"}),e.jsx("span",{className:" text-green-600",children:"Valid"})]})]}),e.jsxs("div",{className:"flex relative mx-auto w-full",children:[e.jsx(ie,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-lg md:text-xl"}),e.jsx("input",{disabled:!0,type:"text",className:"border-2 w-full rounded-md   placeholder-text-black placeholder-gray-900 py-2 px-4 md:py-3 md:px-5",placeholder:r==null?void 0:r.city})]})]}),e.jsxs("div",{className:"flex flex-col w-[350px] mx-auto",children:[e.jsxs("div",{className:"flex justify-between px-5",children:[e.jsx("span",{className:"text-zinc-500",children:"Landmark"}),e.jsxs("div",{className:"flex justify-center items-center gap-1",children:[e.jsx(V,{className:"text-green-600 text-sm"}),e.jsx("span",{className:" text-green-600",children:"Valid"})]})]}),e.jsxs("div",{className:"flex relative mx-auto w-full",children:[e.jsx(ie,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-lg md:text-xl"}),e.jsx("input",{disabled:!0,type:"text",className:"border-2 w-full rounded-md   placeholder-text-black placeholder-gray-900 py-2 px-4 md:py-3 md:px-5",placeholder:r==null?void 0:r.landmark})]})]}),e.jsxs("div",{className:"flex flex-col w-[350px] mx-auto",children:[e.jsxs("div",{className:"flex justify-between px-5",children:[e.jsx("span",{className:"text-zinc-500",children:"Pincode"}),e.jsxs("div",{className:"flex justify-center items-center gap-1",children:[e.jsx(V,{className:"text-green-600 text-sm"}),e.jsx("span",{className:" text-green-600",children:"Valid"})]})]}),e.jsxs("div",{className:"flex relative mx-auto w-full",children:[e.jsx(ie,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-lg md:text-xl"}),e.jsx("input",{disabled:!0,type:"text",className:"border-2 w-full rounded-md   placeholder-text-black placeholder-gray-900 py-2 px-4 md:py-3 md:px-5",placeholder:r==null?void 0:r.pincode})]})]})]}),e.jsxs("div",{className:"flex flex-col p-5  px-5",children:[e.jsxs("div",{className:"flex justify-between border-2 rounded py-5 px-20",children:[e.jsx("h1",{className:"rounded-full py-1 font-bold text-lg md:text-xl",children:"All Visitors"}),e.jsxs("select",{value:h,id:"userTypeSelect",className:"bg-sky-500 text-white rounded-full md:py-1 md:px-5",onChange:p=>c(p.target.value),children:[e.jsx("option",{value:"All",children:"All Visitors"}),e.jsx("option",{value:"Verified",children:"Verified Visitors"}),e.jsx("option",{value:"Unverified",children:"Unverified Visitors"}),e.jsx("option",{value:"Unknown",children:"Unknown Visitors"})]})]}),e.jsxs("table",{className:"w-full text-left p-5 mt-4 text-xs md:text-sm lg:text-lg ",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-2 border-b",children:"ID"}),e.jsx("th",{className:"p-2 border-b",children:"Visited at"}),e.jsx("th",{className:"p-2 border-b",children:"NAME"}),e.jsx("th",{className:"p-2 border-b",children:"PURPOSE"}),e.jsx("th",{className:"p-2 border-b",children:"PHONE"})]})}),e.jsx("tbody",{children:g&&g.length>0?g.map(p=>{var C;return e.jsxs("tr",{children:[e.jsxs("td",{className:"p-2 border-b",children:["#",(C=p._id)==null?void 0:C.substring(0,5)]}),e.jsx("td",{className:"p-2 border-b",children:N(p.createdAt)}),e.jsx("td",{className:"p-2 border-b",children:p.username}),e.jsx("td",{className:"p-2 border-b",children:p.purpose}),e.jsx("td",{className:"p-2 border-b",children:p.phone!==0?p.phone:"Unknown"})]})}):e.jsx("div",{className:"flex justify-center text-4xl p-6 font-bold",children:"No users visited"})})]})]})]})]})]})},Wa=()=>{const[s,t]=a.useState(!0);return e.jsxs("div",{className:"flex w-screen",children:[e.jsx(De,{navShowSet:t}),e.jsx("div",{className:`transition-all duration-300 ${s?"w-[250px]":"w-[60px]"}`}),e.jsx("div",{className:"flex-1",children:e.jsx(Ya,{})})]})},Ha=()=>{const[s,t]=a.useState({}),[n,r]=a.useState({}),[x,h]=a.useState({}),[c,g]=a.useState({}),[i,y]=a.useState([]),_=a.useRef({}),N=(m,p)=>{m.target.files&&m.target.files[0]&&k(m.target.files[0],p)},k=async(m,p)=>{if(!m){P("No file available to upload.");return}try{const C=he(fe),l=new Date().getTime()+"_"+m.name,A=ye(C,l),d=Ne(A,m);h(f=>({...f,[p]:!0})),d.on("state_changed",f=>{const o=f.bytesTransferred/f.totalBytes*100;t(E=>({...E,[p]:o}))},f=>{console.log(f),t(o=>({...o,[p]:null})),h(o=>({...o,[p]:!1}))},()=>{be(d.snapshot.ref).then(f=>{t(o=>({...o,[p]:null})),r(o=>({...o,[p]:f})),h(o=>({...o,[p]:!1})),P("Image uploaded successfully.")})})}catch{t(l=>({...l,[p]:null})),h(l=>({...l,[p]:!1})),P("Failed to upload image.")}},w=async m=>{if(!n[m]){P("No new image available.");return}try{const p=await q.post("/superAdmin/add_new_poster",{id:m,imageUrl:n[m]});console.log(p),P("Poster saved successfully."),S(),g(C=>({...C,[m]:!1}))}catch(p){console.log(p),P("Failed to save poster.")}},S=async()=>{try{const m=await q.get("/superAdmin/get_posters");y(m.data)}catch(m){console.log(m),P("Failed to fetch posters.")}};return a.useEffect(()=>{S()},[]),e.jsx("div",{className:"container mx-auto",children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h1",{className:"text-4xl font-bold py-5",children:"Posters"}),e.jsxs("div",{className:"flex flex-col gap-2 border-2 rounded p-4",children:[e.jsx("div",{className:"flex justify-center border-2 rounded p-5",children:e.jsx("div",{className:"flex justify-center items-center h-4",children:e.jsx("h1",{className:"font-bold text-2xl",children:"CURRENT POSTERS"})})}),e.jsx("div",{className:"flex flex-col gap-5",children:i.map(m=>e.jsxs("div",{className:"flex justify-between items-center px-10 border-2 rounded",children:[e.jsxs("div",{className:"relative",children:[n[m._id]?e.jsx("img",{src:n[m._id],className:"w-36 md:w-96",alt:"Poster"}):e.jsx("img",{src:m.imageUrl,className:"w-36 md:w-96",alt:"Poster"}),e.jsx("input",{type:"file",onChange:p=>N(p,m._id),ref:p=>_.current[m._id]=p,className:"hidden"}),x[m._id]&&s[m._id]!==null&&e.jsxs("div",{className:"progress-bar",children:["Upload progress: ",s[m._id],"%"]})]}),e.jsx("div",{className:"flex flex-col justify-center items-center md:flex-row gap-3 my-auto",children:c[m._id]?e.jsxs(e.Fragment,{children:[e.jsx(Ft,{className:" text-3xl md:text-5xl text-gray-600 hover:text-gray-800",onClick:()=>{var p;return(p=_.current[m._id])==null?void 0:p.click()}}),e.jsx("button",{className:"text-white text-xs md:text-sm bg-green-500 px-3 py-1 rounded hover:bg-green-700",onClick:()=>w(m._id),children:"Save"}),e.jsx("button",{className:"text-white text-xs md:text-sm bg-green-500 px-3 py-1 rounded hover:bg-green-700",onClick:()=>g(p=>({...p,[m._id]:!1})),children:"Cancel"})]}):e.jsx("button",{className:"text-white text-xs md:text-sm bg-sky-500 px-3 py-1 rounded hover:bg-sky-700",onClick:()=>g(p=>({...p,[m._id]:!0})),children:"Edit"})})]},m._id))})]})]})})})},Ga=()=>{const[s,t]=a.useState(!0);return e.jsxs("div",{className:"flex w-screen",children:[e.jsx(De,{navShowSet:t}),e.jsx("div",{className:`transition-all duration-300 ${s?"w-[250px]":"w-[60px]"}`}),e.jsx("div",{className:"flex-1",children:e.jsx(Ha,{})})]})},Qa=()=>{const{currentSuperAdmin:s}=K(t=>t.superAdmin);return s?e.jsx(qe,{}):e.jsx(Ye,{to:"/super_admin_login"})},Ja="modulepreload",Ka=function(s){return"/"+s},os={},Za=function(t,n,r){let x=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const h=document.querySelector("meta[property=csp-nonce]"),c=(h==null?void 0:h.nonce)||(h==null?void 0:h.getAttribute("nonce"));x=Promise.all(n.map(g=>{if(g=Ka(g),g in os)return;os[g]=!0;const i=g.endsWith(".css"),y=i?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${g}"]${y}`))return;const _=document.createElement("link");if(_.rel=i?"stylesheet":Ja,i||(_.as="script",_.crossOrigin=""),_.href=g,c&&_.setAttribute("nonce",c),document.head.appendChild(_),i)return new Promise((N,k)=>{_.addEventListener("load",N),_.addEventListener("error",()=>k(new Error(`Unable to preload CSS for ${g}`)))})}))}return x.then(()=>t()).catch(h=>{const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=h,window.dispatchEvent(c),!c.defaultPrevented)throw h})},Xa=a.lazy(()=>Za(()=>import("./AdminAllCallListSection-CwKMfQg2.js"),__vite__mapDeps([0,1,2]))),el=()=>{const[s,t]=a.useState(!0);return e.jsxs("div",{className:"flex w-screen",children:[e.jsx(me,{navShowSet:t}),e.jsx("div",{className:`transition-all duration-300 ${s?"w-[250px]":"w-[60px]"}`}),e.jsx("div",{className:"flex-1",children:e.jsx(a.Suspense,{fallback:e.jsx("div",{className:"flex justify-center items-center h-full",children:e.jsx(ge,{type:"spin",color:"#000"})}),children:e.jsx(Xa,{})})})]})},sl=()=>(a.useEffect(()=>{Ve();const s=zs();return()=>{s.then(()=>{}).catch(t=>console.log("failed "+t))}},[]),e.jsxs("div",{className:"",children:[e.jsx(Ls,{}),e.jsx(Zt,{children:e.jsx(zt,{children:e.jsxs(Bt,{children:[e.jsx(Y,{path:"/",element:e.jsx(Xt,{})}),e.jsx(Y,{path:"/service",element:e.jsx(la,{})}),e.jsx(Y,{path:"/login",element:e.jsx(aa,{})}),e.jsx(Y,{path:"/signup",element:e.jsx(ra,{})}),e.jsx(Y,{path:"/verify_otp_page/:ph",element:e.jsx(na,{})}),e.jsxs(Y,{element:e.jsx(ma,{}),children:[e.jsx(Y,{path:"/admin-data",element:e.jsx(oa,{})}),e.jsx(Y,{path:"/profile",element:e.jsx(ia,{})}),e.jsx(Y,{path:"/editprofile",element:e.jsx(xa,{})}),e.jsx(Y,{path:"/dashboard",element:e.jsx(ha,{})}),e.jsx(Y,{path:"/qrcodes",element:e.jsx(Ua,{})}),e.jsx(Y,{path:"/visitors",element:e.jsx(Pa,{})}),e.jsx(Y,{path:"/generate_qr",element:e.jsx(ga,{})}),e.jsx(Y,{path:"/chat_list",element:e.jsx(ya,{})}),e.jsx(Y,{path:"/admin_chat",element:e.jsx(ba,{})}),e.jsx(Y,{path:"/admin_call_List",element:e.jsx(el,{})}),e.jsx(Y,{path:"/call_admin_page",element:e.jsx(_a,{})})]}),e.jsx(Y,{path:"/new_user",element:e.jsx(ka,{})}),e.jsx(Y,{path:"/user_verify_otp_page/:id",element:e.jsx(Sa,{})}),e.jsxs(Y,{element:e.jsx(Ca,{}),children:[e.jsx(Y,{path:"/chat_user",element:e.jsx(Ea,{})}),e.jsx(Y,{path:"/call_page_user",element:e.jsx(Ia,{})})]}),e.jsx(Y,{path:"/super_admin_login",element:e.jsx(Va,{})}),e.jsxs(Y,{element:e.jsx(Qa,{}),children:[e.jsx(Y,{path:"/super_admin_dashboard",element:e.jsx(za,{})}),e.jsx(Y,{path:"/super_admin_registered_admin_list",element:e.jsx(qa,{})}),e.jsx(Y,{path:"/super_admin_registered_admin_profile",element:e.jsx(Wa,{})}),e.jsx(Y,{path:"/super_admin_poster_page",element:e.jsx(Ga,{})})]})]})})})]})),es={key:"root",storage:Wt,version:1},tl=Xe(es,ta),al=Xe(es,va),ll=Xe(es,La),Js=qt({reducer:{admin:tl,user:al,superAdmin:ll},middleware:s=>s({serializableCheck:!1})}),rl=Yt(Js);"Notification"in window||(console.log("This browser does not support desktop notification"),alert("This browser does not support desktop notification"));"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/firebase-messaging-sw.js").then(s=>{console.log("Service Worker registered with scope:",s.scope)}).catch(s=>{console.error("Service Worker registration failed:",s)})});Ht.createRoot(document.getElementById("root")).render(e.jsx(Gt.StrictMode,{children:e.jsx(Qt,{persistor:rl,children:e.jsx(Jt,{store:Js,children:e.jsx(sl,{})})})}));export{de as u};
